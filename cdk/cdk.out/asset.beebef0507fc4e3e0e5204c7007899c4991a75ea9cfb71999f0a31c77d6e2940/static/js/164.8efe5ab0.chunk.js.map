{"version":3,"file":"static/js/164.8efe5ab0.chunk.js","mappings":"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","sources":["utils/clipboard.js","hooks/useChat.js","hooks/useOrchestration.js","hooks/useWebSocket.js","components/AnimatedChatMessage.js","components/ModelSelector.js","components/ChatInterface.js","components/PromptCardManager.js","components/AdminView.js","components/UserView.js","components/ProjectDetail.js","components/LoadingSpinner.js"],"sourcesContent":["import { toast } from \"react-hot-toast\";\n\n/**\n * 텍스트를 클립보드에 복사하는 유틸리티 함수\n * @param {string} text - 복사할 텍스트\n * @param {string} successMessage - 성공 시 표시할 메시지\n * @param {string} errorMessage - 실패 시 표시할 메시지\n * @returns {Promise<boolean>} - 성공 여부\n */\nexport const copyToClipboard = async (\n  text,\n  successMessage = \"클립보드에 복사되었습니다!\",\n  errorMessage = \"복사에 실패했습니다.\"\n) => {\n  try {\n    await navigator.clipboard.writeText(text);\n    toast.success(successMessage);\n    return true;\n  } catch (error) {\n    console.error(\"복사 실패:\", error);\n    toast.error(errorMessage);\n    return false;\n  }\n};\n\n/**\n * 제목만 추출하여 복사하는 함수\n * @param {string} text - 전체 텍스트\n * @returns {Promise<boolean>} - 성공 여부\n */\nexport const copyTitlesOnly = async (text) => {\n  const extractedTitles = extractTitles(text);\n  const textToCopy =\n    extractedTitles.length > 0 ? extractedTitles.join(\"\\n\") : text;\n  return copyToClipboard(textToCopy, \"제목이 클립보드에 복사되었습니다!\");\n};\n\n/**\n * 텍스트에서 제목을 추출하는 함수\n * @param {string} text - 원본 텍스트\n * @returns {Array<string>} - 추출된 제목 배열\n */\nexport const extractTitles = (text) => {\n  const titles = [];\n\n  // 1. 번호 형식: \"1. [제목]\"\n  const numberedMatches = text.match(/^\\d+\\.\\s+(.+?)(?=\\n\\s*-|$)/gm);\n  if (numberedMatches) {\n    numberedMatches.forEach((match) => {\n      const title = match.replace(/^\\d+\\.\\s+/, \"\").trim();\n      if (title && !title.includes(\"품질 평가\")) {\n        titles.push(title);\n      }\n    });\n  }\n\n  // 2. Bullet 형식: \"• [제목]\"\n  if (titles.length === 0) {\n    const bulletMatches = text.match(/• \"([^\"]+)\"/g);\n    if (bulletMatches) {\n      bulletMatches.forEach((match) => {\n        const title = match.replace(/• \"(.+)\"/, \"$1\").trim();\n        if (title) {\n          titles.push(title);\n        }\n      });\n    }\n  }\n\n  // 3. 일반 Bullet 형식\n  if (titles.length === 0) {\n    const simpleBulletMatches = text.match(/• ([^\\n]+)/g);\n    if (simpleBulletMatches) {\n      simpleBulletMatches.forEach((match) => {\n        const title = match.replace(\"• \", \"\").trim();\n        if (title && !title.includes(\"이유:\") && title.length < 100) {\n          titles.push(title);\n        }\n      });\n    }\n  }\n\n  return titles;\n};\n","import { useState, useEffect, useRef, useCallback } from \"react\";\nimport { toast } from \"react-hot-toast\";\nimport { copyToClipboard } from \"../utils/clipboard\";\nimport { useOrchestration } from \"./useOrchestration\";\nimport { useWebSocket } from \"./useWebSocket\";\nimport { crewAPI } from \"../services/api\";\n\n/**\n * 멀티-에이전트 AI 응답을 파싱하고 UI에 맞는 메시지 객체로 변환\n */\nconst processMultiAgentResponse = (result) => {\n  if (!result) {\n    console.error(\"멀티-에이전트 응답 오류: 결과가 없습니다\", result);\n    return {\n      id: \"error-\" + Date.now(),\n      type: \"assistant\",\n      content: \"처리 중 오류가 발생했습니다. 다시 시도해주세요.\",\n      timestamp: new Date(),\n      isError: true,\n    };\n  }\n\n  // 멀티-에이전트 결과 구성\n  const agentResults = result.agentResults || {};\n  const finalTitles = result.finalTitles || {};\n  const tokenUsage = result.tokenUsage || 0;\n\n  // 에이전트별 결과를 포맷팅\n  const agentSummary = Object.keys(agentResults).map(agentType => {\n    const agentResult = agentResults[agentType];\n    const titles = finalTitles[agentType] || [];\n    \n    return {\n      agentType,\n      agentName: getAgentName(agentType),\n      result: agentResult?.content || \"결과 없음\",\n      titles: titles,\n      tokenCount: agentResult?.tokenCount || 0\n    };\n  });\n\n  // 전체 제목 목록 생성\n  const allTitles = Object.values(finalTitles).flat();\n\n  return {\n    id: \"multi-agent-\" + Date.now(),\n    type: \"assistant\",\n    content: formatMultiAgentContent(agentSummary, allTitles),\n    timestamp: new Date(),\n    // 멀티-에이전트 특화 데이터\n    isMultiAgent: true,\n    agentResults: agentSummary,\n    allTitles: allTitles,\n    tokenUsage: tokenUsage,\n  };\n};\n\n/**\n * 에이전트 타입을 한국어 이름으로 변환\n */\nconst getAgentName = (agentType) => {\n  const agentNames = {\n    journalism: \"📰 저널리즘 충실형\",\n    balanced: \"⚖️ 균형잡힌 후킹형\", \n    click: \"🎯 클릭유도형\",\n    seo: \"🔍 SEO/AEO 최적화형\",\n    social: \"📱 소셜미디어 공유형\"\n  };\n  return agentNames[agentType] || `🤖 ${agentType}`;\n};\n\n/**\n * 멀티-에이전트 결과를 UI 표시용 텍스트로 포맷팅\n */\nconst formatMultiAgentContent = (agentSummary, allTitles) => {\n  let content = \"🚀 **멀티-에이전트 분석 완료**\\n\\n\";\n  \n  // 전체 제목 요약\n  if (allTitles.length > 0) {\n    content += \"📋 **생성된 제목 목록:**\\n\";\n    allTitles.forEach((title, index) => {\n      content += `${index + 1}. ${title}\\n`;\n    });\n    content += \"\\n\";\n  }\n\n  // 에이전트별 상세 결과\n  content += \"🔍 **에이전트별 분석 결과:**\\n\\n\";\n  agentSummary.forEach(agent => {\n    content += `### ${agent.agentName}\\n`;\n    if (agent.titles.length > 0) {\n      content += \"**생성 제목:**\\n\";\n      agent.titles.forEach(title => {\n        content += `• ${title}\\n`;\n      });\n    }\n    content += `**토큰 사용량:** ${agent.tokenCount}개\\n\\n`;\n  });\n\n  return content;\n};\n\n/**\n * 채팅 기능을 위한 커스텀 훅\n * @param {string} projectId - 프로젝트 ID\n * @param {string} projectName - 프로젝트 이름\n * @param {Array} promptCards - 프롬프트 카드 배열\n * @returns {Object} - 채팅 관련 상태와 함수들\n */\nexport const useChat = (projectId, projectName, promptCards = []) => {\n  const [messages, setMessages] = useState([]);\n  const [inputValue, setInputValue] = useState(\"\");\n  const [copiedMessage, setCopiedMessage] = useState(null);\n  const [canSendMessage, setCanSendMessage] = useState(true);\n  const [inputHeight, setInputHeight] = useState(24); // 동적 높이 관리\n  const [selectedModel, setSelectedModel] = useState(\"anthropic.claude-3-5-sonnet-20241022-v2:0\");\n  const streamingMessageIdRef = useRef(null);\n  const currentWebSocketRef = useRef(null);\n  const currentExecutionIdRef = useRef(null);\n  \n\n  const messagesEndRef = useRef(null);\n  const inputRef = useRef(null);\n\n  // 사용자 스크롤 상태 추적\n  const [isUserScrolling, setIsUserScrolling] = useState(false);\n  const scrollContainerRef = useRef(null);\n  const lastScrollTopRef = useRef(0);\n\n  const {\n    isExecuting: isGenerating,\n    isStreaming,\n    executeOrchestration,\n    pollOrchestrationResult,\n    resetOrchestration,\n  } = useOrchestration(projectId);\n\n  // WebSocket 훅 추가\n  const {\n    isConnected: wsConnected,\n    isConnecting: wsConnecting,\n    error: wsError,\n    startStreaming: wsStartStreaming,\n    addMessageListener,\n    removeMessageListener,\n  } = useWebSocket(projectId);\n\n  // 초기 환영 메시지 설정 - 제거됨 (빈 상태로 시작)\n  useEffect(() => {\n    setMessages([]); // 빈 배열로 시작\n  }, [projectName]);\n\n  // 사용자 스크롤 감지 함수\n  const handleScroll = useCallback(() => {\n    if (!scrollContainerRef.current) return;\n\n    const container = scrollContainerRef.current;\n    const currentScrollTop = container.scrollTop;\n    const maxScrollTop = container.scrollHeight - container.clientHeight;\n\n    // 사용자가 수동으로 스크롤했는지 감지\n    if (Math.abs(currentScrollTop - lastScrollTopRef.current) > 2) {\n      const isAtBottom = currentScrollTop >= maxScrollTop - 20;\n\n      // 하단에 있을 때만 자동 스크롤 허용, 그 외는 사용자 스크롤 모드\n      setIsUserScrolling(!isAtBottom);\n    }\n\n    lastScrollTopRef.current = currentScrollTop;\n  }, []);\n\n  const scrollToBottom = useCallback(() => {\n    // 사용자가 스크롤 중이 아닐 때만 자동 스크롤\n    if (!isUserScrolling && messagesEndRef.current) {\n      messagesEndRef.current.scrollIntoView({ behavior: \"smooth\" });\n    }\n  }, [isUserScrolling]);\n\n  // 메시지 추가 시 스크롤 하단으로 (사용자 스크롤 중이 아닐 때만)\n  useEffect(() => {\n    scrollToBottom();\n  }, [messages, scrollToBottom]);\n\n  // WebSocket 메시지 리스너 설정\n  useEffect(() => {\n    const handleWebSocketMessage = (event) => {\n      try {\n        const data = JSON.parse(event.data);\n        console.log(\"WebSocket 메시지 수신:\", data);\n\n        const currentStreamingId = streamingMessageIdRef.current;\n\n        switch (data.type) {\n          case \"stream_start\":\n            console.log(\"WebSocket 스트리밍 시작\");\n            break;\n\n          case \"progress\":\n            // 진행 상황 로그만 남기고 UI 업데이트는 제거\n            console.log(`진행 상황: ${data.step} (${data.progress}%)`);\n            break;\n\n          case \"stream_chunk\":\n            if (currentStreamingId) {\n              setMessages((prev) => {\n                const updatedMessages = [...prev];\n                const streamingMsgIndex = updatedMessages.findIndex(\n                  (msg) => msg.id === currentStreamingId\n                );\n\n                if (streamingMsgIndex !== -1) {\n                  // 기존 내용에 새 청크 추가\n                  const currentContent =\n                    updatedMessages[streamingMsgIndex].content || \"\";\n\n                  updatedMessages[streamingMsgIndex] = {\n                    ...updatedMessages[streamingMsgIndex],\n                    content: currentContent + data.content,\n                    isLoading: true,\n                    isStreaming: true,\n                  };\n                }\n\n                return updatedMessages;\n              });\n              // 스트리밍 중에는 사용자가 스크롤 중이 아닐 때만 자동 스크롤\n              if (!isUserScrolling) {\n                scrollToBottom();\n              }\n            }\n            break;\n\n          case \"stream_complete\":\n            if (currentStreamingId) {\n              setMessages((prev) => {\n                const updatedMessages = [...prev];\n                const streamingMsgIndex = updatedMessages.findIndex(\n                  (msg) => msg.id === currentStreamingId\n                );\n\n                if (streamingMsgIndex !== -1) {\n                  updatedMessages[streamingMsgIndex] = {\n                    ...updatedMessages[streamingMsgIndex],\n                    content: data.fullContent,\n                    isLoading: false,\n                    isStreaming: false,\n                    timestamp: new Date(),\n                  };\n                }\n\n                return updatedMessages;\n              });\n              streamingMessageIdRef.current = null;\n              scrollToBottom();\n            }\n            break;\n\n          case \"error\":\n            console.error(\"WebSocket 스트리밍 오류:\", data.message);\n            if (currentStreamingId) {\n              setMessages((prev) => {\n                const updatedMessages = [...prev];\n                const streamingMsgIndex = updatedMessages.findIndex(\n                  (msg) => msg.id === currentStreamingId\n                );\n\n                if (streamingMsgIndex !== -1) {\n                  updatedMessages[streamingMsgIndex] = {\n                    ...updatedMessages[streamingMsgIndex],\n                    content:\n                      \"메시지 처리 중 오류가 발생했습니다. 다시 시도해주세요.\",\n                    isLoading: false,\n                    isStreaming: false,\n                    isError: true,\n                    timestamp: new Date(),\n                  };\n                }\n\n                return updatedMessages;\n              });\n              streamingMessageIdRef.current = null;\n            }\n            toast.error(data.message);\n            break;\n\n          default:\n            console.log(\"알 수 없는 WebSocket 메시지 타입:\", data.type);\n        }\n      } catch (error) {\n        console.error(\"WebSocket 메시지 파싱 오류:\", error);\n      }\n    };\n\n    if (wsConnected) {\n      addMessageListener(handleWebSocketMessage);\n    }\n\n    return () => {\n      if (wsConnected) {\n        removeMessageListener(handleWebSocketMessage);\n      }\n    };\n  }, [wsConnected, addMessageListener, removeMessageListener, scrollToBottom]);\n\n  /**\n   * 스트리밍 응답 처리 함수\n   */\n  const handleStreamingResponse = useCallback(\n    (chunk, metadata) => {\n      const currentStreamingId = streamingMessageIdRef.current;\n\n      console.log(\"청크 수신:\", chunk, \"스트리밍 ID:\", currentStreamingId);\n\n      if (!currentStreamingId) {\n        console.error(\"스트리밍 ID가 없습니다!\");\n        return;\n      }\n\n      setMessages((prev) => {\n        const updatedMessages = [...prev];\n        const streamingMsgIndex = updatedMessages.findIndex(\n          (msg) => msg.id === currentStreamingId\n        );\n\n        if (streamingMsgIndex !== -1) {\n          // 기존 스트리밍 메시지 업데이트\n          updatedMessages[streamingMsgIndex] = {\n            ...updatedMessages[streamingMsgIndex],\n            content: updatedMessages[streamingMsgIndex].content + chunk,\n            isLoading: true,\n            isStreaming: true,\n          };\n          console.log(\n            \"스트리밍 메시지 업데이트 성공:\",\n            updatedMessages[streamingMsgIndex].content\n          );\n        } else {\n          console.error(\"스트리밍 메시지를 찾을 수 없음:\", currentStreamingId);\n        }\n\n        return updatedMessages;\n      });\n\n      // 스크롤 조정 (사용자가 스크롤 중이 아닐 때만)\n      if (!isUserScrolling) {\n        scrollToBottom();\n      }\n    },\n    [scrollToBottom, isUserScrolling]\n  );\n\n  /**\n   * 스트리밍 완료 처리 함수\n   */\n  const handleStreamingComplete = useCallback(\n    (result) => {\n      const currentStreamingId = streamingMessageIdRef.current;\n\n      console.log(\"스트리밍 완료:\", result, \"스트리밍 ID:\", currentStreamingId);\n\n      if (!currentStreamingId) {\n        console.error(\"스트리밍 완료 처리 중 ID가 없습니다!\");\n        return;\n      }\n\n      setMessages((prev) => {\n        const updatedMessages = [...prev];\n        const streamingMsgIndex = updatedMessages.findIndex(\n          (msg) => msg.id === currentStreamingId\n        );\n\n        if (streamingMsgIndex !== -1) {\n          // 스트리밍 메시지 완료 처리\n          updatedMessages[streamingMsgIndex] = {\n            ...updatedMessages[streamingMsgIndex],\n            content: result.result,\n            isLoading: false,\n            isStreaming: false,\n            performance_metrics: result.performance_metrics,\n            model_info: result.model_info,\n            timestamp: new Date(),\n          };\n          console.log(\n            \"스트리밍 완료 처리 성공:\",\n            updatedMessages[streamingMsgIndex].content\n          );\n        } else {\n          console.error(\n            \"스트리밍 완료 처리 중 메시지를 찾을 수 없음:\",\n            currentStreamingId\n          );\n        }\n\n        return updatedMessages;\n      });\n\n      // 스트리밍 ID 초기화\n      streamingMessageIdRef.current = null;\n\n      // 입력 활성화\n      console.log(\"WebSocket 스트리밍 완료 - 입력 활성화\");\n      setCanSendMessage(true);\n\n      // 스크롤 조정 (스트리밍 완료 시에는 항상 하단으로)\n      scrollToBottom();\n    },\n    [scrollToBottom]\n  );\n\n  /**\n   * 스트리밍 중단 함수\n   */\n  const handleStopGeneration = useCallback(() => {\n    console.log(\"생성 중단 요청\");\n\n    // WebSocket 연결 종료\n    if (currentWebSocketRef.current) {\n      currentWebSocketRef.current.close();\n      currentWebSocketRef.current = null;\n    }\n\n    // 현재 실행 중인 작업 중단\n    if (currentExecutionIdRef.current) {\n      // 여기서 실제 API 호출 중단 로직을 추가할 수 있습니다\n      currentExecutionIdRef.current = null;\n    }\n\n    // 스트리밍 메시지 상태 업데이트\n    const currentStreamingId = streamingMessageIdRef.current;\n    if (currentStreamingId) {\n      setMessages((prev) => {\n        const updatedMessages = [...prev];\n        const streamingMsgIndex = updatedMessages.findIndex(\n          (msg) => msg.id === currentStreamingId\n        );\n\n        if (streamingMsgIndex !== -1) {\n          updatedMessages[streamingMsgIndex] = {\n            ...updatedMessages[streamingMsgIndex],\n            content:\n              updatedMessages[streamingMsgIndex].content +\n              \"\\n\\n[생성이 중단되었습니다]\",\n            isLoading: false,\n            isStreaming: false,\n            timestamp: new Date(),\n          };\n        }\n\n        return updatedMessages;\n      });\n\n      streamingMessageIdRef.current = null;\n    }\n\n    // 입력 가능 상태로 복원\n    setCanSendMessage(true);\n\n    // orchestration 상태 리셋\n    resetOrchestration();\n\n    toast.success(\"생성이 중단되었습니다\");\n  }, [resetOrchestration]);\n\n  /**\n   * 입력창 높이 자동 조절\n   */\n  const adjustInputHeight = useCallback((value) => {\n    if (!value.trim()) {\n      setInputHeight(24); // 기본 높이\n      return;\n    }\n    \n    // 줄 수 계산 (대략적)\n    const lines = value.split('\\n').length;\n    const charBasedLines = Math.ceil(value.length / 80); // 80자당 1줄로 추정\n    const estimatedLines = Math.max(lines, charBasedLines);\n    \n    // 높이 계산 (lineHeight: 1.4, fontSize: 16px)\n    let calculatedHeight;\n    if (estimatedLines <= 3) {\n      calculatedHeight = 24 + (estimatedLines - 1) * 22; // 기본 + 추가 줄\n    } else if (estimatedLines <= 10) {\n      calculatedHeight = 150 + (estimatedLines - 6) * 15; // 중간 범위\n    } else {\n      calculatedHeight = Math.min(400, 150 + (estimatedLines - 6) * 12); // 최대 400px\n    }\n    \n    setInputHeight(Math.max(24, calculatedHeight));\n  }, []);\n  \n  /**\n   * 입력값 변경 처리\n   */\n  const handleInputChange = useCallback((value) => {\n    setInputValue(value);\n    adjustInputHeight(value);\n  }, [adjustInputHeight]);\n\n  /**\n   * 메시지 전송\n   */\n  const handleSendMessage = useCallback(async () => {\n    console.log(\"해들 전송 호출:\", {\n      inputValue: inputValue.trim(),\n      isGenerating,\n      canSendMessage,\n    });\n\n    if (!inputValue.trim() || isGenerating) {\n      console.log(\"전송 중단: 조건 부족\");\n      return;\n    }\n\n    // 입력 비활성화\n    console.log(\"입력 비활성화\");\n    setCanSendMessage(false);\n\n    const userMessage = {\n      id: \"user-\" + Date.now(),\n      type: \"user\",\n      content: inputValue.trim(),\n      timestamp: new Date(),\n    };\n\n    // 스트리밍 메시지 ID 생성\n    const streamMsgId = \"streaming-\" + Date.now();\n    streamingMessageIdRef.current = streamMsgId;\n\n    console.log(\"새 스트리밍 메시지 ID 생성:\", streamMsgId);\n\n    // 스트리밍 응답을 위한 초기 메시지\n    const streamingMessage = {\n      id: streamMsgId,\n      type: \"assistant\",\n      content: \"\",\n      timestamp: new Date(),\n      isLoading: true,\n      isStreaming: true,\n    };\n\n    setMessages((prev) => [...prev, userMessage, streamingMessage]);\n    setInputValue(\"\");\n    setInputHeight(24); // 입력창 높이 초기화\n\n    // 기존 메시지 + 현재 사용자 메시지를 포함한 대화 히스토리 생성\n    const allMessages = [...messages, userMessage];\n    const chatHistory = allMessages\n      .filter((msg) => !msg.isLoading && !msg.isError && !msg.isStreaming)\n      .map((msg) => ({\n        role: msg.type === \"user\" ? \"user\" : \"assistant\",\n        content: msg.content,\n      }));\n\n    // 최대 대화 기억 설정 (최근 50개 메시지로 최대 메모리 유지)\n    const maxHistoryLength = 50;\n    const trimmedChatHistory = chatHistory.slice(-maxHistoryLength);\n\n    console.log(\"대화 히스토리 생성:\", {\n      totalMessages: allMessages.length,\n      fullHistoryLength: chatHistory.length,\n      trimmedHistoryLength: trimmedChatHistory.length,\n      maxHistoryLength: maxHistoryLength,\n      recentHistory: trimmedChatHistory.slice(-6), // 최근 6개만 로그에 표시\n    });\n\n    try {\n      // 프롬프트 카드 정보 추가 - 활성화된 카드만 필터링하고 백엔드 형식에 맞게 변환\n      const safePromptCards = Array.isArray(promptCards) ? promptCards : [];\n      const activePromptCards = safePromptCards\n        .filter((card) => card.isActive !== false && card.enabled !== false)\n        .map((card) => ({\n          promptId: card.promptId || card.prompt_id,\n          title: card.title || \"Untitled\",\n          prompt_text: card.prompt_text || card.content || \"\",\n          tags: card.tags || [],\n          isActive: card.isActive !== false,\n          stepOrder: card.stepOrder || 0,\n        }))\n        .filter((card) => card.prompt_text.trim()) // 프롬프트 내용이 있는 것만\n        .sort((a, b) => (a.stepOrder || 0) - (b.stepOrder || 0)); // stepOrder로 정렬\n\n      console.log(\"대화 전송 데이터 확인:\", {\n        messageContent: userMessage.content,\n        chatHistoryLength: trimmedChatHistory.length,\n        promptCardsCount: activePromptCards.length,\n        chatHistory: trimmedChatHistory,\n        promptCards: activePromptCards.map((card) => ({\n          id: card.promptId,\n          title: card.title,\n          contentLength: card.prompt_text.length,\n          stepOrder: card.stepOrder,\n          hasContent: !!card.prompt_text.trim(),\n        })),\n      });\n\n      // WebSocket 연결 확인 및 실시간 스트리밍 시도\n      if (wsConnected) {\n        console.log(\"WebSocket을 통한 실시간 스트리밍 시작\");\n\n        const success = wsStartStreaming(\n          userMessage.content,\n          trimmedChatHistory,\n          activePromptCards,\n          selectedModel\n        );\n\n        if (success) {\n          // WebSocket 스트리밍 성공, 나머지는 리스너에서 처리\n          return;\n        } else {\n          console.log(\"WebSocket 전송 실패, SSE 폴백 모드로 전환\");\n        }\n      } else {\n        console.log(\"WebSocket 미연결, SSE 모드 사용\");\n      }\n\n      // 🌟 멀티-에이전트 시스템 실행\n      console.log(\"멀티-에이전트 시스템 실행 시작\");\n\n      // 1. 먼저 프롬프트 카드들을 crew 인스턴스로 생성\n      if (activePromptCards.length > 0) {\n        try {\n          console.log(\"프롬프트 카드 → 크루 인스턴스 변환 시도\");\n          await crewAPI.createCrewInstance(projectId, activePromptCards);\n          console.log(\"크루 인스턴스 생성 완료\");\n        } catch (instanceError) {\n          console.log(\"크루 인스턴스 생성 실패 (이미 존재하거나 기타 이유):\", instanceError.message);\n          // 이미 생성되어 있을 수 있으므로 계속 진행\n        }\n      }\n\n      // 2. 멀티-에이전트 병렬 실행\n      const multiAgentResult = await crewAPI.executeMultiAgent(\n        projectId, \n        userMessage.content,\n        (progress) => {\n          // 진행상황 업데이트 (옵션)\n          console.log(\"멀티-에이전트 진행상황:\", progress);\n        }\n      );\n\n      console.log(\"멀티-에이전트 실행 완료:\", multiAgentResult);\n\n      // 3. 결과를 UI 메시지로 변환\n      const assistantMessage = processMultiAgentResponse(multiAgentResult);\n      \n      // 4. 스트리밍 메시지를 최종 결과로 교체\n      setMessages((prev) => {\n        const updatedMessages = [...prev];\n        const streamingMsgIndex = updatedMessages.findIndex(\n          (msg) => msg.id === streamingMessageIdRef.current\n        );\n\n        if (streamingMsgIndex !== -1) {\n          updatedMessages[streamingMsgIndex] = assistantMessage;\n        } else {\n          updatedMessages.push(assistantMessage);\n        }\n\n        return updatedMessages;\n      });\n\n      streamingMessageIdRef.current = null;\n      setCanSendMessage(true);\n      \n      // 성공 토스트\n      toast.success(`${Object.keys(multiAgentResult.agentResults || {}).length}개 에이전트 분석 완료!`);\n    } catch (error) {\n      console.error(\"메시지 전송 실패:\", error);\n\n      // 개선된 오류 메시지\n      const errorType = error.code === \"ECONNABORTED\" ? \"timeout\" : \"general\";\n      const errorMessage = {\n        id: \"error-\" + Date.now(),\n        type: \"assistant\",\n        content:\n          errorType === \"timeout\"\n            ? \"처리 시간이 초과되었습니다. 요청이 복잡하거나 서버가 바쁜 상태일 수 있습니다. 잠시 후 다시 시도해주세요.\"\n            : \"메시지 처리 중 오류가 발생했습니다. 네트워크 연결을 확인하고 다시 시도해주세요.\",\n        timestamp: new Date(),\n        isError: true,\n        errorDetails: {\n          type: errorType,\n          message: error.message,\n          status: error.response?.status,\n        },\n      };\n\n      setMessages((prev) => {\n        // 스트리밍 메시지를 찾아 제거\n        const currentStreamingId = streamingMessageIdRef.current;\n        const filteredMessages = prev.filter(\n          (msg) => msg.id !== currentStreamingId\n        );\n        return [...filteredMessages, errorMessage];\n      });\n\n      streamingMessageIdRef.current = null;\n\n      // 오류 발생 시도 입력 활성화\n      setCanSendMessage(true);\n    }\n\n    // 전체 전송 과정 완료 후 입력 활성화 (보험용)\n    setCanSendMessage(true);\n  }, [\n    inputValue,\n    isGenerating,\n    executeOrchestration,\n    handleStreamingResponse,\n    handleStreamingComplete,\n    messages,\n  ]);\n\n  /**\n   * Enter 키로 전송\n   */\n  const handleKeyPress = useCallback(\n    (e) => {\n      if (e.key === \"Enter\" && !e.shiftKey) {\n        e.preventDefault();\n        handleSendMessage();\n      }\n    },\n    [handleSendMessage]\n  );\n\n  /**\n   * 메시지 복사\n   */\n  const handleCopyMessage = useCallback(async (content, messageId) => {\n    const success = await copyToClipboard(content);\n    if (success) {\n      setCopiedMessage(messageId);\n      setTimeout(() => setCopiedMessage(null), 2000);\n    }\n  }, []);\n\n  /**\n   * 개별 제목 복사\n   */\n  const handleCopyTitle = useCallback(async (title, messageId, index) => {\n    const success = await copyToClipboard(title, \"복사되었습니다!\");\n    if (success) {\n      setCopiedMessage(`${messageId}_title_${index}`);\n      setTimeout(() => setCopiedMessage(null), 2000);\n    }\n  }, []);\n\n  /**\n   * 채팅 초기화\n   */\n  const resetChat = useCallback(() => {\n    setMessages([]);\n    setInputValue(\"\");\n    setCopiedMessage(null);\n    setCanSendMessage(true);\n    streamingMessageIdRef.current = null;\n    currentWebSocketRef.current = null;\n    currentExecutionIdRef.current = null;\n    resetOrchestration();\n  }, [resetOrchestration]);\n\n  return {\n    messages,\n    inputValue,\n    setInputValue,\n    handleInputChange, // 새로운 입력 핸들러\n    copiedMessage,\n    isGenerating,\n    isStreaming,\n    canSendMessage,\n    streamingMessageId: streamingMessageIdRef.current,\n    messagesEndRef,\n    inputRef,\n    inputHeight, // 동적 높이\n    handleSendMessage,\n    handleStopGeneration,\n    handleKeyPress,\n    handleCopyMessage,\n    handleCopyTitle,\n    resetChat,\n    scrollToBottom,\n    // WebSocket 상태 추가\n    wsConnected,\n    wsConnecting,\n    wsError,\n    // 스크롤 관련 추가\n    scrollContainerRef,\n    handleScroll,\n    isUserScrolling,\n    // 모델 선택 관련 추가\n    selectedModel,\n    setSelectedModel,\n  };\n};\n","import { useState, useCallback } from \"react\";\nimport { toast } from \"react-hot-toast\";\nimport { generateAPI } from \"../services/api\";\n\n/**\n * 제목 생성 실행 및 결과 폴링을 위한 커스텀 훅\n * @param {string} projectId - 프로젝트 ID\n * @returns {Object} - 제목 생성 관련 상태와 함수들\n */\nexport const useOrchestration = (projectId) => {\n  const [isExecuting, setIsExecuting] = useState(false);\n  const [currentExecution, setCurrentExecution] = useState(null);\n  const [executionStatus, setExecutionStatus] = useState(null);\n  const [isStreaming, setIsStreaming] = useState(false);\n\n  /**\n   * 제목 생성 실행\n   * @param {string} userInput - 사용자 입력\n   * @param {Object} options - 추가 옵션 (예: chat_history, useStreaming)\n   * @returns {Promise<Object>} - 생성 결과\n   */\n  const executeOrchestration = useCallback(\n    async (userInput, options = {}) => {\n      if (!userInput.trim()) {\n        toast.error(\"메시지를 입력해주세요.\");\n        return null;\n      }\n\n      try {\n        setIsExecuting(true);\n        setExecutionStatus(\"STARTING\");\n\n        // chat_history, prompt_cards, userInput, modelId를 포함하는 data 객체 생성\n        const data = {\n          userInput: userInput,\n          chat_history: options.chat_history || [],\n          prompt_cards: options.prompt_cards || [],\n          modelId: options.modelId || null,\n        };\n\n        console.log(\"🚀 대화 생성 요청 시작:\", {\n          projectId,\n          inputLength: userInput.length,\n          historyLength: data.chat_history.length,\n          promptCardsCount: data.prompt_cards.length,\n          useStreaming: options.useStreaming === true,\n          modelId: data.modelId,\n          timestamp: new Date().toISOString(),\n        });\n\n        // 🔧 스트리밍 사용 여부 확인 - 더 안전한 로직\n        if (options.useStreaming === true) {\n          setIsStreaming(true);\n\n          // 스트리밍 콜백 함수 설정\n          const onChunk = options.onChunk || (() => {});\n          const onError = (error) => {\n            console.error(\"🔧 스트리밍 오류 처리:\", error);\n            setIsExecuting(false);\n            setIsStreaming(false);\n            setExecutionStatus(\"FAILED\");\n\n            // 🔧 개선: 오류 타입에 따른 적절한 메시지\n            if (\n              error.message?.includes(\"Gateway Timeout\") ||\n              error.message?.includes(\"504\") ||\n              error.code === \"ECONNABORTED\"\n            ) {\n              toast.error(\n                \"서버 응답 시간이 초과되었습니다. 요청을 간단히 하거나 잠시 후 다시 시도해주세요.\"\n              );\n            } else if (\n              error.message?.includes(\"CORS\") ||\n              error.message?.includes(\"Network Error\")\n            ) {\n              toast.error(\n                \"서버 연결에 문제가 있습니다. 새로고침 후 다시 시도해주세요.\"\n              );\n            } else {\n              toast.error(\n                \"처리 중 오류가 발생했습니다. 잠시 후 다시 시도해주세요.\"\n              );\n            }\n\n            if (options.onError) options.onError(error);\n          };\n\n          const onComplete = (response) => {\n            console.log(\"✅ 스트리밍 완료:\", {\n              resultLength: response.result?.length || 0,\n              timestamp: new Date().toISOString(),\n            });\n            setIsExecuting(false);\n            setIsStreaming(false);\n            setExecutionStatus(\"COMPLETED\");\n            if (options.onComplete) options.onComplete(response);\n          };\n\n          try {\n            // 🔧 개선: 스트리밍 API 호출 (내부에서 폴백 처리됨)\n            return await generateAPI.generateTitleStream(\n              projectId,\n              data,\n              onChunk,\n              onError,\n              onComplete\n            );\n          } catch (streamError) {\n            console.error(\"🔧 스트리밍 최종 실패:\", streamError);\n\n            // 🔧 스트리밍 완전 실패 시에도 폴백이 내부에서 처리되므로\n            // 여기서는 사용자에게 알림만\n            setIsStreaming(false);\n            setIsExecuting(false);\n            setExecutionStatus(\"FAILED\");\n\n            // 최종 실패 메시지\n            toast.error(\n              \"서비스에 일시적인 문제가 있습니다. 잠시 후 다시 시도해주세요.\"\n            );\n            throw streamError;\n          }\n        }\n\n        // 🔧 일반 API 호출 (스트리밍 미사용)\n        console.log(\"📄 일반 API 호출 시작...\");\n        const response = await generateAPI.generateTitle(projectId, data);\n\n        console.log(\"✅ 대화 생성 완료:\", {\n          mode: response.mode,\n          message: response.message,\n          timestamp: new Date().toISOString(),\n        });\n\n        setIsExecuting(false);\n        setExecutionStatus(\"COMPLETED\");\n\n        return response;\n      } catch (error) {\n        console.error(\"❌ 제목 생성 실패:\", {\n          error: error.message,\n          code: error.code,\n          status: error.response?.status,\n          timestamp: new Date().toISOString(),\n        });\n\n        setIsExecuting(false);\n        setIsStreaming(false);\n        setExecutionStatus(\"FAILED\");\n\n        // 🔧 개선: 상세한 오류 처리\n        if (error.response?.status === 504) {\n          toast.error(\n            \"서버 응답 시간이 초과되었습니다. 입력을 간소화하거나 잠시 후 다시 시도해주세요.\"\n          );\n        } else if (\n          error.message?.includes(\"CORS\") ||\n          error.code === \"ERR_NETWORK\"\n        ) {\n          toast.error(\n            \"서버 연결에 문제가 있습니다. 페이지를 새로고침하고 다시 시도해주세요.\"\n          );\n        } else if (\n          error.response?.status === 400 &&\n          error.response?.data?.setup_required\n        ) {\n          toast.error(\"프롬프트 카드를 먼저 설정해주세요!\");\n        } else if (error.code === \"ECONNABORTED\") {\n          toast.error(\n            \"요청 처리 시간이 초과되었습니다. 입력을 줄이거나 잠시 후 다시 시도해주세요.\"\n          );\n        } else if (error.response?.status === 500) {\n          toast.error(\n            \"서버에 일시적인 문제가 있습니다. 잠시 후 다시 시도해주세요.\"\n          );\n        } else if (error.response?.status === 403) {\n          toast.error(\"권한이 없습니다. 로그인 상태를 확인해주세요.\");\n        } else if (error.response?.status === 429) {\n          toast.error(\"요청이 너무 많습니다. 잠시 후 다시 시도해주세요.\");\n        } else {\n          toast.error(\n            \"처리 중 오류가 발생했습니다. 네트워크 연결을 확인하고 다시 시도해주세요.\"\n          );\n        }\n\n        throw error;\n      }\n    },\n    [projectId]\n  );\n\n  /**\n   * 실행 상태 조회 (Step Functions 사용 시)\n   * @param {string} executionArn - 실행 ARN\n   * @param {Function} onComplete - 완료 시 콜백\n   * @param {Function} onError - 에러 시 콜백\n   */\n  const pollOrchestrationResult = useCallback(\n    async (executionArn, onComplete, onError) => {\n      // 스트리밍 모드에서는 폴링이 필요 없음\n      if (isStreaming) {\n        return;\n      }\n\n      const poll = async () => {\n        try {\n          const result = await generateAPI.getExecutionStatus(executionArn);\n\n          setExecutionStatus(result.status);\n\n          if (result.status === \"SUCCEEDED\") {\n            setIsExecuting(false);\n            setExecutionStatus(\"COMPLETED\");\n\n            if (onComplete) {\n              onComplete(result);\n            }\n          } else if (result.status === \"FAILED\") {\n            setIsExecuting(false);\n            setExecutionStatus(\"FAILED\");\n\n            if (onError) {\n              onError(new Error(\"처리 실패\"));\n            }\n          } else if (result.status === \"RUNNING\") {\n            // 3초 후 다시 폴링\n            setTimeout(poll, 3000);\n          }\n        } catch (error) {\n          console.error(\"실행 상태 조회 실패:\", error);\n          setIsExecuting(false);\n          setExecutionStatus(\"FAILED\");\n\n          if (onError) {\n            onError(error);\n          }\n        }\n      };\n\n      poll();\n    },\n    [projectId, isStreaming]\n  );\n\n  /**\n   * 오케스트레이션 상태 초기화\n   */\n  const resetOrchestration = useCallback(() => {\n    setIsExecuting(false);\n    setIsStreaming(false);\n    setCurrentExecution(null);\n    setExecutionStatus(null);\n  }, []);\n\n  return {\n    isExecuting,\n    isStreaming,\n    currentExecution,\n    executionStatus,\n    executeOrchestration,\n    pollOrchestrationResult,\n    resetOrchestration,\n  };\n};\n","import { useState, useEffect, useRef, useCallback } from \"react\";\n\n/**\n * WebSocket 실시간 스트리밍을 위한 커스텀 훅\n */\nexport const useWebSocket = (projectId) => {\n  const [isConnected, setIsConnected] = useState(false);\n  const [isConnecting, setIsConnecting] = useState(false);\n  const [error, setError] = useState(null);\n  const wsRef = useRef(null);\n  const reconnectTimeoutRef = useRef(null);\n  const reconnectAttempts = useRef(0);\n  const maxReconnectAttempts = 5;\n\n  // WebSocket URL (환경변수나 실제 배포된 URL로 설정)\n  const getWebSocketUrl = useCallback(() => {\n    const wsUrl =\n      process.env.REACT_APP_WS_URL ||\n      \"wss://na17isxiri.execute-api.us-east-1.amazonaws.com/prod\";\n    \n    // URL 형식 검증 및 정규화\n    if (!wsUrl.startsWith(\"wss://\") && !wsUrl.startsWith(\"ws://\")) {\n      console.error(\"잘못된 WebSocket URL 형식:\", wsUrl);\n      return null;\n    }\n    \n    // 끝에 슬래시 제거\n    const normalizedUrl = wsUrl.replace(/\\/$/, \"\");\n    console.log(\"WebSocket URL 확인:\", normalizedUrl);\n    console.log(\"환경변수 REACT_APP_WS_URL:\", process.env.REACT_APP_WS_URL);\n    \n    return normalizedUrl;\n  }, []);\n\n  // WebSocket 연결\n  const connect = useCallback(() => {\n    // 이미 연결 중이거나 연결된 경우 중복 연결 방지\n    if (wsRef.current?.readyState === WebSocket.OPEN || \n        wsRef.current?.readyState === WebSocket.CONNECTING) {\n      console.log(\"이미 연결된 WebSocket이 있습니다 (readyState:\", wsRef.current.readyState, \")\");\n      return;\n    }\n\n    // 이전 연결이 있다면 정리\n    if (wsRef.current) {\n      wsRef.current.close();\n      wsRef.current = null;\n    }\n\n    setIsConnecting(true);\n    setError(null);\n\n    try {\n      const wsUrl = getWebSocketUrl();\n      \n      if (!wsUrl) {\n        setError(\"유효하지 않은 WebSocket URL\");\n        setIsConnecting(false);\n        return;\n      }\n\n      console.log(\"WebSocket 연결 시도:\", wsUrl);\n      console.log(\"브라우저 WebSocket 지원:\", !!window.WebSocket);\n\n      // 연결 시도 시간 기록\n      window.wsConnectStart = Date.now();\n\n      wsRef.current = new WebSocket(wsUrl);\n\n      // 연결 상태 모니터링\n      const connectionTimeout = setTimeout(() => {\n        if (wsRef.current?.readyState === WebSocket.CONNECTING) {\n          console.error(\"WebSocket 연결 시간 초과\");\n          wsRef.current.close();\n          setError(\"연결 시간이 초과되었습니다\");\n          setIsConnecting(false);\n        }\n      }, 10000); // 10초 타임아웃\n\n      wsRef.current.onopen = (event) => {\n        clearTimeout(connectionTimeout);\n        console.log(\"🟢 WebSocket 연결 성공!\");\n        console.log(\"- Event:\", event);\n        console.log(\"- URL:\", wsRef.current?.url);\n        console.log(\"- Protocol:\", wsRef.current?.protocol);\n        console.log(\"- Extensions:\", wsRef.current?.extensions);\n        setIsConnected(true);\n        setIsConnecting(false);\n        setError(null);\n        reconnectAttempts.current = 0;\n      };\n\n      wsRef.current.onclose = (event) => {\n        clearTimeout(connectionTimeout);\n        const connectionDuration = Date.now() - (window.wsConnectStart || 0);\n        \n        console.log(\"🔴 WebSocket 연결 종료:\");\n        console.log(\"- Code:\", event.code);\n        console.log(\"- Reason:\", event.reason || \"(no reason provided)\");\n        console.log(\"- WasClean:\", event.wasClean);\n        console.log(\"- Connection duration:\", connectionDuration + \"ms\");\n        \n        setIsConnected(false);\n        setIsConnecting(false);\n\n        // 즉시 종료된 경우 (500ms 이내) - 서버 문제\n        if (connectionDuration < 500) {\n          console.error(\"⚠️ WebSocket이 즉시 종료됨 - 서버 문제 가능성\");\n          \n          // 특정 에러 코드에 따른 세분화된 에러 메시지\n          let errorMessage = \"서버 연결에 실패했습니다.\";\n          switch(event.code) {\n            case 1006:\n              errorMessage = \"비정상적인 연결 종료 (네트워크 문제 가능성)\";\n              break;\n            case 1002:\n              errorMessage = \"프로토콜 오류\";\n              break;\n            case 1003:\n              errorMessage = \"지원하지 않는 데이터 타입\";\n              break;\n            case 1011:\n              errorMessage = \"서버 내부 오류\";\n              break;\n          }\n          \n          setError(errorMessage);\n          return;\n        }\n\n        // 자동 재연결 (정상 종료가 아닌 경우)\n        if (\n          event.code !== 1000 &&\n          reconnectAttempts.current < maxReconnectAttempts\n        ) {\n          const delay = Math.min(\n            1000 * Math.pow(2, reconnectAttempts.current),\n            30000\n          );\n          console.log(\n            `🔄 ${delay}ms 후 재연결 시도 (${\n              reconnectAttempts.current + 1\n            }/${maxReconnectAttempts})`\n          );\n\n          reconnectTimeoutRef.current = setTimeout(() => {\n            reconnectAttempts.current++;\n            connect();\n          }, delay);\n        } else if (reconnectAttempts.current >= maxReconnectAttempts) {\n          setError(\"최대 재연결 시도 횟수에 도달했습니다.\");\n        }\n      };\n\n      wsRef.current.onerror = (error) => {\n        clearTimeout(connectionTimeout);\n        console.error(\"💥 WebSocket 오류:\", error);\n        console.log(\"- ReadyState:\", wsRef.current?.readyState);\n        console.log(\"- URL:\", wsRef.current?.url);\n        setError(\"WebSocket 연결 오류가 발생했습니다\");\n        setIsConnecting(false);\n      };\n\n    } catch (err) {\n      console.error(\"💥 WebSocket 생성 실패:\", err);\n      setError(\"WebSocket 연결에 실패했습니다: \" + err.message);\n      setIsConnecting(false);\n    }\n  }, [getWebSocketUrl]);\n\n  // WebSocket 연결 해제\n  const disconnect = useCallback(() => {\n    if (reconnectTimeoutRef.current) {\n      clearTimeout(reconnectTimeoutRef.current);\n      reconnectTimeoutRef.current = null;\n    }\n\n    if (wsRef.current) {\n      wsRef.current.close(1000, \"Manual disconnect\");\n      wsRef.current = null;\n    }\n\n    setIsConnected(false);\n    setIsConnecting(false);\n    reconnectAttempts.current = 0;\n  }, []);\n\n  // 메시지 전송\n  const sendMessage = useCallback((message) => {\n    if (wsRef.current?.readyState === WebSocket.OPEN) {\n      wsRef.current.send(JSON.stringify(message));\n      return true;\n    } else {\n      console.error(\"WebSocket이 연결되지 않았습니다\");\n      setError(\"WebSocket 연결이 필요합니다\");\n      return false;\n    }\n  }, []);\n\n  // 스트리밍 요청\n  const startStreaming = useCallback(\n    (userInput, chatHistory = [], promptCards = [], modelId = null) => {\n      if (!isConnected) {\n        setError(\"WebSocket 연결이 필요합니다\");\n        return false;\n      }\n\n      const message = {\n        action: \"stream\",\n        projectId,\n        userInput,\n        chat_history: chatHistory,\n        prompt_cards: promptCards,\n        modelId: modelId,\n      };\n\n      console.log('WebSocket 메시지 전송:', {\n        action: message.action,\n        projectId: message.projectId,\n        inputLength: userInput.length,\n        historyLength: chatHistory.length,\n        promptCardsCount: promptCards.length\n      });\n\n      return sendMessage(message);\n    },\n    [isConnected, projectId, sendMessage]\n  );\n\n  // 메시지 리스너 등록\n  const addMessageListener = useCallback((listener) => {\n    if (wsRef.current) {\n      wsRef.current.addEventListener(\"message\", listener);\n    }\n  }, []);\n\n  // 메시지 리스너 제거\n  const removeMessageListener = useCallback((listener) => {\n    if (wsRef.current) {\n      wsRef.current.removeEventListener(\"message\", listener);\n    }\n  }, []);\n\n  // 컴포넌트 마운트 시 연결, 언마운트 시 해제\n  useEffect(() => {\n    // 초기 연결 지연을 통해 React strict mode 이슈 회피\n    const timer = setTimeout(() => {\n      connect();\n    }, 100);\n    \n    return () => {\n      clearTimeout(timer);\n      disconnect();\n    };\n  }, []); // 의존성 배열을 빈 배열로 변경\n\n  // projectId 변경 시 재연결\n  useEffect(() => {\n    if (isConnected && projectId) {\n      console.log('ProjectId 변경됨, 재연결 중:', projectId);\n      disconnect();\n      setTimeout(connect, 200);\n    }\n  }, [projectId]); // connect, disconnect 의존성 제거\n\n  return {\n    isConnected,\n    isConnecting,\n    error,\n    connect,\n    disconnect,\n    sendMessage,\n    startStreaming,\n    addMessageListener,\n    removeMessageListener,\n  };\n};\n","import React from \"react\";\nimport { motion, AnimatePresence } from \"framer-motion\";\nimport ReactMarkdown from \"react-markdown\";\nimport {\n  ClipboardDocumentIcon,\n  CheckCircleIcon,\n  DocumentDuplicateIcon,\n  ExclamationTriangleIcon,\n} from \"@heroicons/react/24/outline\";\nimport { ChatMessageSkeleton } from \"./skeleton/SkeletonComponents\";\n\n// 스트리밍 표시 컴포넌트\nconst AnimatedStreamingIndicator = () => {\n  return (\n    <motion.div\n      className=\"inline-flex items-center mt-2 px-2 py-1 bg-blue-50 dark:bg-blue-900 rounded-lg text-blue-600 dark:text-blue-400 text-xs font-medium\"\n      initial={{ opacity: 0, scale: 0.8 }}\n      animate={{ opacity: 1, scale: 1 }}\n      transition={{ duration: 0.3 }}\n    >\n      <motion.div\n        className=\"relative h-2 w-2 mr-2\"\n        animate={{ scale: [1, 1.2, 1] }}\n        transition={{ repeat: Infinity, duration: 1.5 }}\n      >\n        <div className=\"absolute animate-ping h-2 w-2 rounded-full bg-blue-400 opacity-75\"></div>\n        <div className=\"absolute h-2 w-2 rounded-full bg-blue-600 dark:bg-blue-400\"></div>\n      </motion.div>\n      <motion.span\n        animate={{ opacity: [0.5, 1, 0.5] }}\n        transition={{ repeat: Infinity, duration: 2 }}\n      >\n        스트리밍 중...\n      </motion.span>\n    </motion.div>\n  );\n};\n\n// 간단한 로딩 표시\nconst AnimatedLoadingIndicator = () => {\n  return (\n    <motion.div\n      className=\"flex items-center text-blue-600 dark:text-blue-400 text-sm\"\n      initial={{ opacity: 0, x: -20 }}\n      animate={{ opacity: 1, x: 0 }}\n      transition={{ duration: 0.4 }}\n    >\n      <motion.div\n        className=\"animate-spin rounded-full h-4 w-4 border-b-2 border-blue-600 dark:border-blue-400 mr-2\"\n        animate={{ rotate: 360 }}\n        transition={{ repeat: Infinity, duration: 1 }}\n      />\n      <span>답변 생성 중...</span>\n    </motion.div>\n  );\n};\n\n// 오류 상세 정보 표시 컴포넌트\nconst AnimatedErrorDetails = ({ errorDetails }) => {\n  if (!errorDetails) return null;\n\n  return (\n    <motion.div\n      className=\"mt-3 p-3 bg-red-50 dark:bg-red-900/20 rounded-lg border border-red-200 dark:border-red-800\"\n      initial={{ opacity: 0, height: 0 }}\n      animate={{ opacity: 1, height: \"auto\" }}\n      transition={{ duration: 0.3 }}\n    >\n      <div className=\"flex items-center text-sm text-red-700 dark:text-red-400 mb-2\">\n        <ExclamationTriangleIcon className=\"h-4 w-4 mr-2\" />\n        <span className=\"font-medium\">오류 상세 정보</span>\n      </div>\n      <div className=\"text-xs text-red-600 dark:text-red-400 space-y-1\">\n        <div>\n          <span className=\"font-medium\">유형:</span> {errorDetails.type}\n        </div>\n        {errorDetails.status && (\n          <div>\n            <span className=\"font-medium\">상태:</span> {errorDetails.status}\n          </div>\n        )}\n        {errorDetails.message && (\n          <div>\n            <span className=\"font-medium\">메시지:</span> {errorDetails.message}\n          </div>\n        )}\n      </div>\n    </motion.div>\n  );\n};\n\nconst AnimatedChatMessage = ({\n  message,\n  onCopyMessage,\n  onCopyTitle,\n  copiedMessage,\n}) => {\n  const isUser = message.type === \"user\";\n\n  const messageVariants = {\n    initial: {\n      opacity: 0,\n      y: 20,\n      scale: 0.95,\n    },\n    animate: {\n      opacity: 1,\n      y: 0,\n      scale: 1,\n      transition: {\n        type: \"spring\",\n        stiffness: 300,\n        damping: 25,\n        staggerChildren: 0.1,\n      },\n    },\n  };\n\n  const contentVariants = {\n    initial: { opacity: 0, y: 10 },\n    animate: {\n      opacity: 1,\n      y: 0,\n      transition: {\n        type: \"spring\",\n        stiffness: 300,\n        damping: 25,\n      },\n    },\n  };\n\n  const buttonVariants = {\n    initial: { opacity: 0, scale: 0.8 },\n    animate: {\n      opacity: 1,\n      scale: 1,\n      transition: {\n        type: \"spring\",\n        stiffness: 400,\n        damping: 20,\n      },\n    },\n    hover: {\n      scale: 1.05,\n      transition: {\n        type: \"spring\",\n        stiffness: 400,\n        damping: 20,\n      },\n    },\n    tap: {\n      scale: 0.95,\n      transition: {\n        type: \"spring\",\n        stiffness: 600,\n        damping: 30,\n      },\n    },\n  };\n\n  return (\n    <motion.div\n      className={`group relative ${isUser ? \"ml-8\" : \"mr-8\"} mb-6`}\n      variants={messageVariants}\n      initial=\"initial\"\n      animate=\"animate\"\n    >\n      <div className={`flex ${isUser ? \"justify-end\" : \"justify-start\"}`}>\n        {isUser ? (\n          // 사용자 메시지 - 디자인된 박스\n          <motion.div\n            className=\"max-w-[85%] rounded-lg px-6 py-4 bg-blue-600 dark:bg-blue-700 text-white\"\n            variants={contentVariants}\n            whileHover={{ scale: 1.01 }}\n            transition={{ type: \"spring\", stiffness: 300, damping: 25 }}\n          >\n            <motion.div\n              className=\"text-base font-medium whitespace-pre-wrap leading-relaxed\"\n              variants={contentVariants}\n            >\n              {message.content}\n            </motion.div>\n            <motion.div\n              className=\"text-xs mt-3 font-medium text-blue-100 dark:text-blue-200\"\n              variants={contentVariants}\n            >\n              {message.timestamp?.toLocaleTimeString() || \"\"}\n            </motion.div>\n          </motion.div>\n        ) : (\n          // AI 메시지 - 박스 없이 깔끔하게\n          <motion.div className=\"max-w-[85%] w-full\" variants={contentVariants}>\n            {/* AI 응답 내용 */}\n            <motion.div\n              className=\"whitespace-pre-wrap leading-relaxed text-gray-800 dark:text-gray-200\"\n              variants={contentVariants}\n            >\n              {message.isError ? (\n                <motion.div\n                  initial={{ opacity: 0, x: -20 }}\n                  animate={{ opacity: 1, x: 0 }}\n                  transition={{ duration: 0.4 }}\n                >\n                  <div className=\"text-red-600 dark:text-red-400 text-base\">\n                    {message.content}\n                  </div>\n                  <AnimatedErrorDetails errorDetails={message.errorDetails} />\n                </motion.div>\n              ) : message.isLoading ? (\n                <div>\n                  {message.isStreaming ? (\n                    // 스트리밍 메시지 표시\n                    <div>\n                      {message.content ? (\n                        <div className=\"prose prose-base max-w-none prose-p:text-gray-800 dark:prose-p:text-white prose-headings:text-gray-900 dark:prose-headings:text-white prose-strong:text-gray-900 dark:prose-strong:text-white prose-ul:text-gray-800 dark:prose-ul:text-white prose-li:text-gray-800 dark:prose-li:text-white prose-code:text-gray-800 dark:prose-code:text-white prose-pre:bg-transparent dark:prose-pre:bg-transparent\">\n                          <ReactMarkdown>{message.content}</ReactMarkdown>\n                        </div>\n                      ) : (\n                        <div className=\"text-blue-600 dark:text-blue-400 text-base font-medium\">\n                          응답을 생성하는 중...\n                        </div>\n                      )}\n                      <AnimatedStreamingIndicator />\n                    </div>\n                  ) : (\n                    // 스켈레톤 UI 표시\n                    <ChatMessageSkeleton isUser={false} />\n                  )}\n                </div>\n              ) : (\n                <div className=\"prose prose-base max-w-none prose-p:text-gray-800 dark:prose-p:text-white prose-headings:text-gray-900 dark:prose-headings:text-white prose-strong:text-gray-900 dark:prose-strong:text-white prose-ul:text-gray-800 dark:prose-ul:text-white prose-li:text-gray-800 dark:prose-li:text-white prose-code:text-gray-800 dark:prose-code:text-white prose-pre:bg-transparent dark:prose-pre:bg-transparent\">\n                  <ReactMarkdown>{message.content}</ReactMarkdown>\n                </div>\n              )}\n            </motion.div>\n\n            {/* 제목 복사 버튼들 */}\n            <AnimatePresence>\n              {message.titles && (\n                <motion.div\n                  className=\"mt-4 pt-3\"\n                  initial={{ opacity: 0, height: 0 }}\n                  animate={{ opacity: 1, height: \"auto\" }}\n                  transition={{ duration: 0.3 }}\n                >\n                  <div className=\"flex flex-wrap gap-2\">\n                    {message.titles.map((title, index) => (\n                      <motion.button\n                        key={index}\n                        onClick={() => onCopyTitle(title, message.id, index)}\n                        className={`flex items-center px-3 py-1.5 bg-gray-50 dark:bg-dark-tertiary border-0 text-gray-800 dark:text-white rounded-lg hover:bg-gray-100 dark:hover:bg-dark-secondary transition-colors text-sm font-medium ${\n                          copiedMessage === `${message.id}_title_${index}`\n                            ? \"bg-green-100 dark:bg-green-900 text-green-700 dark:text-green-400 border border-green-200 dark:border-green-700\"\n                            : \"bg-gray-100 dark:bg-gray-700 hover:bg-gray-200 dark:hover:bg-gray-600 text-gray-700 dark:text-gray-300 border border-gray-200 dark:border-gray-600\"\n                        }`}\n                        variants={buttonVariants}\n                        initial=\"initial\"\n                        animate=\"animate\"\n                        whileHover=\"hover\"\n                        whileTap=\"tap\"\n                        custom={index}\n                      >\n                        <motion.div\n                          animate={\n                            copiedMessage === `${message.id}_title_${index}`\n                              ? { scale: [1, 1.2, 1] }\n                              : {}\n                          }\n                          transition={{ duration: 0.3 }}\n                        >\n                          {copiedMessage === `${message.id}_title_${index}` ? (\n                            <CheckCircleIcon className=\"h-3 w-3 mr-1\" />\n                          ) : (\n                            <DocumentDuplicateIcon className=\"h-3 w-3 mr-1\" />\n                          )}\n                        </motion.div>\n                        제목 {index + 1} 복사\n                      </motion.button>\n                    ))}\n                  </div>\n                </motion.div>\n              )}\n            </AnimatePresence>\n\n            {/* 전체 메시지 복사 버튼 및 타임스탬프 */}\n            {!message.isLoading && !message.isError && (\n              <motion.div\n                className=\"flex items-center justify-between mt-3\"\n                variants={contentVariants}\n              >\n                <motion.button\n                  onClick={() => onCopyMessage(message.content)}\n                  className=\"flex items-center gap-2 text-xs text-gray-500 dark:text-gray-400 hover:text-blue-600 dark:hover:text-blue-400 transition-colors\"\n                  variants={buttonVariants}\n                  initial=\"initial\"\n                  animate=\"animate\"\n                  whileHover=\"hover\"\n                  whileTap=\"tap\"\n                >\n                  {copiedMessage === message.content ? (\n                    <>\n                      <CheckCircleIcon className=\"h-4 w-4 text-green-500\" />\n                      <span className=\"text-green-600 dark:text-green-400\">\n                        복사 완료\n                      </span>\n                    </>\n                  ) : (\n                    <>\n                      <ClipboardDocumentIcon className=\"h-4 w-4\" />\n                      <span>답변 복사</span>\n                    </>\n                  )}\n                </motion.button>\n                <div className=\"text-xs text-gray-400 dark:text-gray-500\">\n                  {message.timestamp?.toLocaleTimeString() || \"\"}\n                </div>\n              </motion.div>\n            )}\n          </motion.div>\n        )}\n      </div>\n    </motion.div>\n  );\n};\n\nexport default AnimatedChatMessage;\n","import React, { useState } from \"react\";\nimport { ChevronDownIcon, SparklesIcon } from \"@heroicons/react/24/outline\";\n\nconst MODELS = [\n  // Anthropic Claude 모델들 (추천)\n  {\n    id: \"anthropic.claude-3-5-sonnet-20241022-v2:0\",\n    name: \"Claude 3.5 Sonnet v2\",\n    provider: \"Anthropic\",\n    category: \"premium\",\n    speed: \"빠름\",\n    quality: \"최고\",\n    description: \"텍스트 생성, 다국어 지원, 복잡한 추론에 최적\",\n    recommended: true,\n  },\n  {\n    id: \"anthropic.claude-3-5-haiku-20241022-v1:0\",\n    name: \"Claude 3.5 Haiku\",\n    provider: \"Anthropic\",\n    category: \"fast\",\n    speed: \"매우 빠름\",\n    quality: \"좋음\",\n    description: \"빠른 응답, 텍스트 생성에 최적화\",\n    recommended: true,\n  },\n  {\n    id: \"anthropic.claude-sonnet-4-v1:0\",\n    name: \"Claude Sonnet 4\",\n    provider: \"Anthropic\",\n    category: \"premium\",\n    speed: \"보통\",\n    quality: \"최고\",\n    description: \"최신 모델로 향상된 텍스트 생성, 실시간 지원\",\n    new: true,\n  },\n  {\n    id: \"anthropic.claude-opus-4-v1:0\",\n    name: \"Claude Opus 4\",\n    provider: \"Anthropic\",\n    category: \"premium\",\n    speed: \"느림\",\n    quality: \"최고\",\n    description: \"최고 성능이 필요한 복잡한 제목 생성\",\n    new: true,\n  },\n  {\n    id: \"anthropic.claude-3-opus-20240229-v1:0\",\n    name: \"Claude 3 Opus\",\n    provider: \"Anthropic\",\n    category: \"premium\",\n    speed: \"느림\",\n    quality: \"최고\",\n    description: \"이미지를 텍스트 및 코드로 변환, 복잡한 추론\",\n  },\n  {\n    id: \"anthropic.claude-3-sonnet-20240229-v1:0\",\n    name: \"Claude 3 Sonnet\",\n    provider: \"Anthropic\",\n    category: \"balanced\",\n    speed: \"보통\",\n    quality: \"좋음\",\n    description: \"균형잡힌 성능과 속도\",\n  },\n  {\n    id: \"anthropic.claude-3-haiku-20240307-v1:0\",\n    name: \"Claude 3 Haiku\",\n    provider: \"Anthropic\",\n    category: \"fast\",\n    speed: \"빠름\",\n    quality: \"보통\",\n    description: \"대화, 채팅 최적화\",\n  },\n\n  // Amazon Nova 모델들\n  {\n    id: \"amazon.nova-pro-v1:0\",\n    name: \"Nova Pro\",\n    provider: \"Amazon\",\n    category: \"balanced\",\n    speed: \"빠름\",\n    quality: \"좋음\",\n    description: \"텍스트 생성, 코드 생성, 복잡한 추론\",\n    recommended: true,\n  },\n  {\n    id: \"amazon.nova-lite-v1:0\",\n    name: \"Nova Lite\",\n    provider: \"Amazon\",\n    category: \"fast\",\n    speed: \"매우 빠름\",\n    quality: \"보통\",\n    description: \"가벼운 모델로 빠른 응답, 다국어 지원\",\n  },\n  {\n    id: \"amazon.nova-micro-v1:0\",\n    name: \"Nova Micro\",\n    provider: \"Amazon\",\n    category: \"fast\",\n    speed: \"초고속\",\n    quality: \"기본\",\n    description: \"초경량 모델로 매우 빠른 응답\",\n  },\n\n  // Meta Llama 모델들\n  {\n    id: \"meta.llama3-3-70b-instruct-v1:0\",\n    name: \"Llama 3.3 70B\",\n    provider: \"Meta\",\n    category: \"balanced\",\n    speed: \"보통\",\n    quality: \"좋음\",\n    description: \"툴 사용, 코드 생성, 고급 추론\",\n  },\n  {\n    id: \"meta.llama3-2-3b-instruct-v1:0\",\n    name: \"Llama 3.2 3B\",\n    provider: \"Meta\",\n    category: \"fast\",\n    speed: \"빠름\",\n    quality: \"보통\",\n    description: \"경량 모델로 빠른 처리\",\n  },\n];\n\nconst ModelSelector = ({ selectedModel, onModelChange }) => {\n  const [isOpen, setIsOpen] = useState(false);\n  const [filter, setFilter] = useState(\"all\");\n\n  console.log(\"🤖 ModelSelector 렌더링됨:\", { selectedModel, isOpen });\n\n  const currentModel =\n    MODELS.find((model) => model.id === selectedModel) || MODELS[0];\n\n  const filteredModels = MODELS.filter((model) => {\n    if (filter === \"all\") return true;\n    return model.provider.toLowerCase() === filter;\n  });\n\n  const handleModelSelect = (modelId) => {\n    onModelChange(modelId);\n    setIsOpen(false);\n  };\n\n  return (\n    <div className=\"relative\">\n      {/* 모델 선택 버튼 - 컴팩트 버전 */}\n      <button\n        onClick={() => setIsOpen(!isOpen)}\n        className=\"flex items-center gap-2 px-2 py-1 bg-gray-50 dark:bg-gray-700 rounded-md hover:bg-gray-100 dark:hover:bg-gray-600 shadow-sm dark:shadow-none transition-colors text-xs\"\n        title={`${currentModel.name} (${currentModel.provider})`}\n      >\n        <span className=\"text-gray-700 dark:text-gray-300 font-medium\">\n          {currentModel.name.replace(/Claude |Llama |Nova /, \"\")}\n        </span>\n        <ChevronDownIcon\n          className={`h-3 w-3 text-gray-500 transition-transform ${\n            isOpen ? \"rotate-180\" : \"\"\n          }`}\n        />\n      </button>\n\n      {/* 드롭다운 메뉴 */}\n      {isOpen && (\n        <div className=\"absolute bottom-full left-0 mb-2 bg-white dark:bg-dark-secondary  rounded-lg shadow-lg z-50 max-h-[400px] overflow-hidden min-w-[300px]\">\n          {/* 필터 버튼들 */}\n          <div className=\"p-3 \">\n            <div className=\"flex gap-1 text-xs\">\n              {[\n                { key: \"all\", label: \"전체\" },\n                { key: \"anthropic\", label: \"Anthropic\" },\n                { key: \"amazon\", label: \"Amazon\" },\n                { key: \"meta\", label: \"Meta\" },\n              ].map((filterOption) => (\n                <button\n                  key={filterOption.key}\n                  onClick={() => setFilter(filterOption.key)}\n                  className={`px-2 py-1 rounded transition-colors ${\n                    filter === filterOption.key\n                      ? \"bg-blue-100 text-blue-800 dark:bg-blue-900 dark:text-blue-200\"\n                      : \"text-gray-600 dark:text-gray-400 hover:bg-gray-100 dark:hover:bg-dark-tertiary\"\n                  }`}\n                >\n                  {filterOption.label}\n                </button>\n              ))}\n            </div>\n          </div>\n\n          {/* 모델 목록 */}\n          <div className=\"max-h-[300px] overflow-y-auto\">\n            {filteredModels.map((model) => (\n              <button\n                key={model.id}\n                onClick={() => handleModelSelect(model.id)}\n                className={`w-full p-3 text-left hover:bg-gray-50 dark:hover:bg-gray-700 last:border-b-0 transition-colors ${\n                  model.id === selectedModel\n                    ? \"bg-blue-50 dark:bg-blue-900/20\"\n                    : \"\"\n                }`}\n              >\n                <div className=\"flex-1 min-w-0\">\n                  <div className=\"mb-1\">\n                    <span className=\"font-medium text-gray-900 dark:text-white\">\n                      {model.name}\n                    </span>\n                  </div>\n                  <div className=\"text-xs text-gray-500 dark:text-gray-400 mb-1\">\n                    {model.provider} • 속도: {model.speed} • 품질:{\" \"}\n                    {model.quality}\n                  </div>\n                  <div className=\"text-xs text-gray-600 dark:text-gray-400\">\n                    {model.description}\n                  </div>\n                </div>\n              </button>\n            ))}\n          </div>\n        </div>\n      )}\n\n      {/* 배경 클릭 시 닫기 */}\n      {isOpen && (\n        <div className=\"fixed inset-0 z-40\" onClick={() => setIsOpen(false)} />\n      )}\n    </div>\n  );\n};\n\nexport default ModelSelector;\n","import React, { useState } from \"react\";\nimport { useNavigate } from \"react-router-dom\";\nimport {\n  PaperAirplaneIcon,\n  DocumentPlusIcon,\n  XMarkIcon,\n  ChatBubbleLeftRightIcon,\n  SparklesIcon,\n  StopIcon,\n} from \"@heroicons/react/24/outline\";\nimport { useChat } from \"../hooks/useChat\";\nimport AnimatedChatMessage from \"./AnimatedChatMessage\";\nimport ModelSelector from \"./ModelSelector\";\n\nconst ChatInterface = ({ projectId, projectName, promptCards = [] }) => {\n  const navigate = useNavigate();\n  const [uploadedFile, setUploadedFile] = useState(null);\n  const [dragOver, setDragOver] = useState(false);\n\n  const {\n    messages,\n    inputValue,\n    setInputValue,\n    handleInputChange,\n    copiedMessage,\n    isGenerating,\n    canSendMessage,\n    messagesEndRef,\n    inputRef,\n    inputHeight,\n    handleSendMessage,\n    handleStopGeneration,\n    handleKeyPress,\n    handleCopyMessage,\n    handleCopyTitle,\n    wsConnected,\n    wsConnecting,\n    wsError,\n    // 스크롤 관련 추가\n    scrollContainerRef,\n    handleScroll,\n    isUserScrolling,\n    // 모델 선택 관련 추가\n    selectedModel,\n    setSelectedModel,\n  } = useChat(projectId, projectName, promptCards);\n\n  const handleFileUpload = (event) => {\n    const file = event.target.files?.[0];\n    if (file && file.type === \"text/plain\") {\n      const reader = new FileReader();\n      reader.onload = (e) => {\n        const content = e.target?.result || \"\";\n        handleInputChange(content); // 높이 자동 조절\n        setUploadedFile(file);\n      };\n      reader.readAsText(file);\n    }\n  };\n\n  const handleDrop = (event) => {\n    event.preventDefault();\n    setDragOver(false);\n    const files = event.dataTransfer.files;\n    if (files.length > 0) {\n      const file = files[0];\n      if (file.type === \"text/plain\") {\n        const reader = new FileReader();\n        reader.onload = (e) => {\n          const content = e.target?.result || \"\";\n          handleInputChange(content); // 높이 자동 조절\n          setUploadedFile(file);\n        };\n        reader.readAsText(file);\n      }\n    }\n  };\n\n  const handleDragOver = (event) => {\n    event.preventDefault();\n    setDragOver(true);\n  };\n\n  const handleDragLeave = () => {\n    setDragOver(false);\n  };\n\n  const removeFile = () => {\n    setUploadedFile(null);\n    handleInputChange(\"\"); // 높이 초기화\n  };\n\n  return (\n    <div className=\"flex flex-col h-full bg-gray-50 dark:bg-dark-primary transition-colors duration-300\">\n      {/* 메시지 영역 */}\n      <div\n        ref={scrollContainerRef}\n        onScroll={handleScroll}\n        className=\"flex-1 overflow-y-auto px-6 py-6 min-h-0 bg-gray-50 dark:bg-dark-primary\"\n      >\n        <div className=\"max-w-4xl mx-auto space-y-6\">\n          {messages.length === 0 ? (\n            <div className=\"flex flex-col items-center justify-center py-24 mt-12\">\n              <div className=\"bg-white dark:bg-dark-secondary card-dark rounded-2xl shadow-md p-8 max-w-2xl w-full transition-colors duration-300\">\n                <div className=\"flex justify-center mb-6\">\n                  <div className=\"bg-blue-100 dark:bg-dark-tertiary p-3 rounded-full\">\n                    <ChatBubbleLeftRightIcon className=\"h-8 w-8 text-blue-600 dark:text-blue-400\" />\n                  </div>\n                </div>\n                <h2 className=\"text-xl font-semibold text-center text-gray-800 dark:text-white mb-4\">\n                  AI 헤드라인 어시스턴트\n                </h2>\n                <p className=\"text-gray-600 dark:text-gray-300 text-center mb-6\">\n                  본문을 입력하면 AI가 최적의 헤드라인을 제안해 드립니다.\n                </p>\n\n                <div className=\"space-y-4\">\n                  <div className=\"flex items-start p-3 bg-gray-50 dark:bg-dark-tertiary rounded-lg\">\n                    <div className=\"mr-3 mt-1\">\n                      <SparklesIcon className=\"h-5 w-5 text-blue-500 dark:text-blue-400\" />\n                    </div>\n                    <div>\n                      <p className=\"text-sm text-gray-700 dark:text-gray-300\">\n                        <span className=\"font-medium\">시작하는 방법:</span> 아래\n                        입력창에 본문을 붙여넣고 전송 버튼을 클릭하세요\n                      </p>\n                    </div>\n                  </div>\n\n                  <div className=\"flex items-start p-3 bg-gray-50 dark:bg-dark-tertiary rounded-lg\">\n                    <div className=\"mr-3 mt-1\">\n                      <SparklesIcon className=\"h-5 w-5 text-blue-500 dark:text-blue-400\" />\n                    </div>\n                    <div>\n                      <p className=\"text-sm text-gray-700 dark:text-gray-300\">\n                        <span className=\"font-medium\">프롬프트 카드:</span>{\" \"}\n                        관리자 모드에서 프롬프트 카드를 작성하여 제목을\n                        생성하세요\n                      </p>\n                    </div>\n                  </div>\n                </div>\n              </div>\n            </div>\n          ) : (\n            messages.map((message) => (\n              <AnimatedChatMessage\n                key={message.id}\n                message={message}\n                onCopyMessage={handleCopyMessage}\n                onCopyTitle={handleCopyTitle}\n                copiedMessage={copiedMessage}\n              />\n            ))\n          )}\n          <div ref={messagesEndRef} />\n        </div>\n      </div>\n\n      {/* 입력 영역 */}\n      <div className=\"flex-shrink-0 px-6 py-4\">\n        <div className=\"max-w-4xl mx-auto\">\n          {/* 업로드된 파일 표시 */}\n          {uploadedFile && (\n            <div className=\"mb-3 p-3 bg-blue-50 dark:bg-dark-tertiary rounded-lg flex items-center justify-between\">\n              <div className=\"flex items-center gap-2\">\n                <DocumentPlusIcon className=\"h-4 w-4 text-blue-600 dark:text-blue-400\" />\n                <span className=\"text-sm text-blue-700 dark:text-white\">\n                  {uploadedFile.name}\n                </span>\n              </div>\n              <button\n                onClick={removeFile}\n                className=\"text-blue-600 dark:text-blue-400 hover:text-blue-800 dark:hover:text-blue-300 p-1\"\n              >\n                <XMarkIcon className=\"h-4 w-4\" />\n              </button>\n            </div>\n          )}\n\n          <div\n            className=\"bg-white dark:bg-dark-secondary rounded-[20px] p-4 relative transition-colors duration-300 flex flex-col gap-6\"\n            style={{\n              minHeight: Math.max(128, inputHeight + 80),\n              transition: \"min-height 0.2s ease-in-out\",\n              boxShadow: \"none\",\n            }}\n            onDrop={handleDrop}\n            onDragOver={handleDragOver}\n            onDragLeave={handleDragLeave}\n          >\n            <div className=\"flex-1 relative focus:outline-none\">\n              <textarea\n                ref={inputRef}\n                value={inputValue}\n                onChange={(e) => handleInputChange(e.target.value)}\n                onKeyPress={handleKeyPress}\n                placeholder={\n                  isGenerating\n                    ? \"생성 중입니다...\"\n                    : \"기사 본문을 입력하세요...\"\n                }\n                className={`w-full pr-14 pl-2 border-0 focus:outline-none resize-none transition-all duration-300 ${\n                  dragOver\n                    ? \"bg-blue-50 dark:bg-dark-tertiary\"\n                    : isGenerating\n                    ? \"bg-gray-50 dark:bg-dark-primary\"\n                    : \"bg-white dark:bg-dark-secondary text-gray-900 dark:text-white\"\n                }`}\n                rows={1}\n                style={{\n                  height: `${inputHeight}px`,\n                  minHeight: \"24px\",\n                  maxHeight: \"400px\",\n                  lineHeight: \"1.4\",\n                  paddingTop: \"0px\",\n                  paddingBottom: \"6px\",\n                  overflowY: inputHeight > 200 ? \"auto\" : \"hidden\",\n                  whiteSpace: \"pre-wrap\",\n                  fontSize: \"16px\",\n                  fontWeight: \"400\",\n                  color: isGenerating ? \"var(--text-muted)\" : \"inherit\",\n                  outline: \"none\",\n                  boxShadow: \"none\",\n                }}\n                disabled={isGenerating}\n              />\n\n              {/* 전송/중단 버튼 - 입력창 내부에 위치 */}\n              <div\n                className=\"absolute right-3 bottom-0 flex items-center gap-2\"\n                style={{ bottom: \"2px\" }}\n              >\n                {isGenerating && (\n                  <button\n                    onClick={handleStopGeneration}\n                    className=\"flex-shrink-0 bg-red-600 hover:bg-red-700 text-white p-2 rounded-full transition-colors flex items-center justify-center\"\n                    style={{ width: \"32px\", height: \"32px\" }}\n                    title=\"생성 중단\"\n                  >\n                    <StopIcon className=\"h-4 w-4\" />\n                  </button>\n                )}\n                <button\n                  onClick={handleSendMessage}\n                  disabled={!inputValue.trim() || isGenerating}\n                  className=\"flex-shrink-0 bg-blue-600 dark:bg-blue-600 hover:bg-blue-700 dark:hover:bg-blue-700 text-white p-2 rounded-full disabled:opacity-70 disabled:cursor-not-allowed transition-colors flex items-center justify-center\"\n                  style={{ width: \"32px\", height: \"32px\" }}\n                  title={\n                    isGenerating\n                      ? \"생성 중...\"\n                      : wsConnected\n                      ? \"실시간 스트리밍 사용 가능\"\n                      : \"일반 모드 (WebSocket 연결 안됨)\"\n                  }\n                >\n                  {isGenerating ? (\n                    <div className=\"animate-spin rounded-full h-5 w-5 border-b-2 border-white\"></div>\n                  ) : (\n                    <PaperAirplaneIcon className=\"h-5 w-5\" />\n                  )}\n                </button>\n              </div>\n            </div>\n\n            <div className=\"flex items-center justify-between\">\n              <div className=\"flex items-center gap-4\">\n                {/* 글자 수 표시 */}\n                <div className=\"flex items-center gap-2 text-xs text-gray-400 dark:text-dark-muted\">\n                  <span>{inputValue.length}자</span>\n                </div>\n\n                {/* 모델 선택기 */}\n                <div className=\"flex items-center gap-2\">\n                  <ModelSelector\n                    selectedModel={selectedModel}\n                    onModelChange={setSelectedModel}\n                  />\n                </div>\n              </div>\n\n              {/* WebSocket 연결 상태 및 스크롤 상태 표시 */}\n              <div className=\"flex items-center gap-3 text-xs\">\n                {/* 스크롤 상태 표시 */}\n                {isUserScrolling && (\n                  <div className=\"flex items-center gap-1 text-blue-600 dark:text-blue-400\">\n                    <span>📜</span>\n                    <span>자유 스크롤</span>\n                  </div>\n                )}\n\n                {/* WebSocket 연결 상태 */}\n                {wsConnecting ? (\n                  <div className=\"flex items-center gap-1 text-yellow-600 dark:text-yellow-400\">\n                    <div className=\"animate-spin rounded-full h-3 w-3 border-b-2 border-yellow-600\"></div>\n                    <span>연결 중...</span>\n                  </div>\n                ) : wsConnected ? (\n                  <div className=\"flex items-center gap-1 text-green-600 dark:text-green-400\">\n                    <div className=\"w-2 h-2 bg-green-600 rounded-full\"></div>\n                    <span>실시간 스트리밍</span>\n                  </div>\n                ) : (\n                  <div className=\"flex items-center gap-1 text-gray-500 dark:text-dark-muted\">\n                    <div className=\"w-2 h-2 bg-gray-400 dark:bg-gray-500 rounded-full\"></div>\n                    <span>일반 모드</span>\n                  </div>\n                )}\n                {wsError && (\n                  <div\n                    className=\"text-red-500 dark:text-red-400 text-xs\"\n                    title={wsError}\n                  >\n                    ⚠️\n                  </div>\n                )}\n              </div>\n            </div>\n          </div>\n        </div>\n      </div>\n    </div>\n  );\n};\n\nexport default ChatInterface;\n","import React, { useState, useEffect } from \"react\";\nimport { toast } from \"react-hot-toast\";\nimport {\n  PlusIcon,\n  PencilIcon,\n  TrashIcon,\n  XMarkIcon,\n  SparklesIcon,\n  DocumentTextIcon,\n  HashtagIcon,\n} from \"@heroicons/react/24/outline\";\nimport { promptCardAPI, handleAPIError } from \"../services/api\";\nimport ChatInterface from \"./ChatInterface\";\n\nconst PromptCardManager = ({ projectId, projectName }) => {\n  const [promptCards, setPromptCards] = useState([]);\n  const [loading, setLoading] = useState(true);\n  const [editingCard, setEditingCard] = useState(null);\n  const [showForm, setShowForm] = useState(false);\n\n  useEffect(() => {\n    loadPromptCards();\n  }, [projectId]);\n\n  const loadPromptCards = async () => {\n    try {\n      setLoading(true);\n      const response = await promptCardAPI.getPromptCards(projectId, true);\n      setPromptCards(response.promptCards || []);\n    } catch (error) {\n      console.error(\"프롬프트 카드 로드 실패:\", error);\n      const errorInfo = handleAPIError(error);\n      toast.error(errorInfo.message);\n    } finally {\n      setLoading(false);\n    }\n  };\n\n  const handleSaveCard = async (cardData) => {\n    try {\n      // 백엔드에 맞는 형식으로 데이터 변환\n      const backendData = {\n        title: cardData.title,\n        prompt_text: cardData.prompt_text,\n        tags: cardData.tags || [],\n        isActive: cardData.enabled !== false, // enabled를 isActive로 변환\n      };\n\n      if (editingCard) {\n        // 수정\n        await promptCardAPI.updatePromptCard(\n          projectId,\n          editingCard.promptId || editingCard.prompt_id,\n          backendData\n        );\n        toast.success(\"프롬프트가 수정되었습니다\");\n      } else {\n        // 새로 생성\n        await promptCardAPI.createPromptCard(projectId, backendData);\n        toast.success(\"프롬프트가 생성되었습니다\");\n      }\n\n      setShowForm(false);\n      setEditingCard(null);\n\n      // 백엔드 저장 성공 후 전체 데이터 다시 로드 (페이지 새로고침 없이)\n      await loadPromptCards();\n    } catch (error) {\n      console.error(\"프롬프트 저장 실패:\", error);\n      const errorInfo = handleAPIError(error);\n      toast.error(errorInfo.message);\n    }\n  };\n\n  const handleDeleteCard = async (promptId) => {\n    if (!window.confirm(\"정말로 이 프롬프트를 삭제하시겠습니까?\")) {\n      return;\n    }\n\n    try {\n      // 백엔드에서 삭제 먼저 실행\n      await promptCardAPI.deletePromptCard(projectId, promptId);\n      toast.success(\"프롬프트가 삭제되었습니다\");\n\n      // 삭제 성공 후 UI에서 제거\n      setPromptCards((prev) =>\n        prev.filter((card) => (card.promptId || card.prompt_id) !== promptId)\n      );\n\n      // 추가로 전체 데이터 다시 로드\n      await loadPromptCards();\n    } catch (error) {\n      console.error(\"프롬프트 삭제 실패:\", error);\n      const errorInfo = handleAPIError(error);\n      toast.error(errorInfo.message);\n    }\n  };\n\n  const handleEditCard = async (card) => {\n    console.log(\"프롬프트 수정 버튼 클릭:\", card);\n\n    // 프롬프트 텍스트 내용이 없으면 S3에서 가져오기\n    let cardWithContent = { ...card };\n\n    if (!card.prompt_text && !card.content) {\n      try {\n        console.log(\"S3에서 프롬프트 내용 로드 중...\");\n        const contentResponse = await promptCardAPI.getPromptContent(\n          projectId,\n          card.promptId || card.prompt_id\n        );\n        cardWithContent.prompt_text = contentResponse.content;\n        console.log(\n          \"S3에서 프롬프트 내용 로드 완료:\",\n          contentResponse.content?.length,\n          \"문자\"\n        );\n      } catch (error) {\n        console.error(\"프롬프트 내용 로드 실패:\", error);\n        toast.error(\"프롬프트 내용을 불러올 수 없습니다\");\n        return;\n      }\n    }\n\n    setEditingCard(cardWithContent);\n    setShowForm(true);\n  };\n\n  const handleNewCard = () => {\n    console.log(\"새 프롬프트 추가 버튼 클릭\");\n    setEditingCard(null);\n    setShowForm(true);\n  };\n\n  const handleCancelForm = () => {\n    console.log(\"모달 취소 버튼 클릭\");\n    setShowForm(false);\n    setEditingCard(null);\n  };\n\n  if (loading) {\n    return (\n      <div className=\"flex items-center justify-center h-64\">\n        <div className=\"animate-spin rounded-full h-8 w-8 border-b-2 border-blue-600\"></div>\n      </div>\n    );\n  }\n\n  return (\n    <div className=\"flex h-full w-full bg-gray-50 dark:bg-dark-primary\">\n      {/* 채팅 인터페이스 */}\n      <div className=\"flex-1 min-w-0 overflow-hidden\">\n        <ChatInterface\n          projectId={projectId}\n          projectName={projectName}\n          promptCards={promptCards}\n        />\n      </div>\n\n      {/* 프롬프트 관리 사이드바 (우측) */}\n      <div className=\"w-80 bg-white dark:bg-dark-primary flex flex-col shadow-lg border-l border-gray-200 dark:border-gray-700 flex-shrink-0\">\n        <div className=\"flex-shrink-0 p-4 bg-gray-50 dark:bg-dark-primary\">\n          <div className=\"flex items-center justify-between\">\n            <h2 className=\"text-lg font-semibold text-gray-800 dark:text-white\">\n              프롬프트 카드\n            </h2>\n            <button\n              onClick={handleNewCard}\n              className=\"inline-flex items-center px-4 py-2 text-sm bg-blue-600 dark:bg-blue-500 text-white rounded-lg hover:bg-blue-700 dark:hover:bg-blue-600 transition-colors shadow-md hover:shadow-lg font-medium\"\n            >\n              <PlusIcon className=\"h-4 w-4 mr-1.5\" />새 추가\n            </button>\n          </div>\n        </div>\n\n        <div className=\"flex-1 overflow-y-auto p-4 space-y-3 min-h-0 bg-gray-50 dark:bg-dark-secondary\">\n          {promptCards.length === 0 ? (\n            <div className=\"text-center py-8\">\n              <SparklesIcon className=\"h-12 w-12 text-gray-300 dark:text-gray-600 mx-auto mb-4\" />\n              <p className=\"text-gray-500 dark:text-gray-400 mb-4\">\n                프롬프트 카드가 없습니다\n              </p>\n              <button\n                onClick={handleNewCard}\n                className=\"inline-flex items-center px-4 py-2 bg-blue-600 dark:bg-blue-500 text-white rounded-lg hover:bg-blue-700 dark:hover:bg-blue-600 transition-colors shadow-sm font-medium\"\n              >\n                <PlusIcon className=\"h-4 w-4 mr-1.5\" />첫 번째 카드 만들기\n              </button>\n            </div>\n          ) : (\n            promptCards.map((card) => (\n              <PromptCard\n                key={card.promptId || card.prompt_id}\n                card={card}\n                onEdit={() => handleEditCard(card)}\n                onDelete={() =>\n                  handleDeleteCard(card.promptId || card.prompt_id)\n                }\n              />\n            ))\n          )}\n        </div>\n      </div>\n\n      {/* 프롬프트 편집 폼 모달 */}\n      {showForm && (\n        <PromptFormModal\n          isOpen={showForm}\n          onSubmit={handleSaveCard}\n          onCancel={handleCancelForm}\n          initialData={editingCard}\n        />\n      )}\n    </div>\n  );\n};\n\n// 간단한 프롬프트 카드 컴포넌트\nconst PromptCard = ({ card, onEdit, onDelete }) => {\n  return (\n    <div className=\"bg-white dark:bg-gray-600 rounded-xl p-4 flex flex-col space-y-3 shadow-md dark:shadow-lg hover:shadow-lg dark:hover:shadow-xl transition-all duration-200 hover:bg-blue-50 dark:hover:bg-gray-500\">\n      {/* Header: Title and Actions */}\n      <div className=\"flex items-start justify-between\">\n        <h3 className=\"font-semibold text-sm text-gray-800 dark:text-white leading-tight pr-2 flex-1\">\n          {card.title || `프롬프트 ${card.promptId || card.prompt_id}`}\n        </h3>\n        <div className=\"flex items-center flex-shrink-0\">\n          <button\n            onClick={async (e) => {\n              e.preventDefault();\n              e.stopPropagation();\n              await onEdit();\n            }}\n            className=\"p-1 text-gray-500 dark:text-gray-400 rounded-full hover:bg-gray-100 dark:hover:bg-dark-secondary hover:text-blue-600 dark:hover:text-blue-400 transition-colors\"\n          >\n            <PencilIcon className=\"h-4 w-4\" />\n          </button>\n          <button\n            onClick={onDelete}\n            className=\"p-1 text-gray-500 dark:text-gray-400 rounded-full hover:bg-gray-100 dark:hover:bg-dark-secondary hover:text-red-600 dark:hover:text-red-400 transition-colors\"\n          >\n            <TrashIcon className=\"h-4 w-4\" />\n          </button>\n        </div>\n      </div>\n\n      {/* Tags */}\n      {card.tags && card.tags.length > 0 && (\n        <div className=\"flex flex-wrap gap-1.5\">\n          {card.tags.slice(0, 3).map((tag) => (\n            <span\n              key={tag}\n              className=\"px-2 py-0.5 text-xs bg-gray-100 dark:bg-dark-secondary text-gray-700 dark:text-gray-300 rounded-full\"\n            >\n              #{tag}\n            </span>\n          ))}\n          {card.tags.length > 3 && (\n            <span className=\"text-xs text-gray-500 dark:text-gray-400\">\n              +{card.tags.length - 3}\n            </span>\n          )}\n        </div>\n      )}\n\n      {/* Content Snippet */}\n      {(card.content || card.prompt_text) && (\n        <p className=\"text-xs text-gray-600 dark:text-gray-300 leading-relaxed line-clamp-2\">\n          {card.content || card.prompt_text}\n        </p>\n      )}\n\n      {/* Date */}\n      <div className=\"flex items-end justify-between pt-2 text-xs text-gray-400 dark:text-gray-500\">\n        <span className=\"flex-shrink-0\">\n          생성:{\" \"}\n          {new Date(card.createdAt || new Date()).toLocaleDateString(\"ko-KR\", {\n            year: \"2-digit\",\n            month: \"2-digit\",\n            day: \"2-digit\",\n          })}\n        </span>\n        {card.updatedAt &&\n          new Date(card.updatedAt) > new Date(card.createdAt) && (\n            <span className=\"flex-shrink-0 ml-2\">\n              수정:{\" \"}\n              {new Date(card.updatedAt).toLocaleDateString(\"ko-KR\", {\n                year: \"2-digit\",\n                month: \"2-digit\",\n                day: \"2-digit\",\n              })}\n            </span>\n          )}\n      </div>\n    </div>\n  );\n};\n\n// 간단한 프롬프트 편집 폼 모달\nconst PromptFormModal = ({ isOpen, onSubmit, onCancel, initialData }) => {\n  const [formData, setFormData] = useState({\n    title: \"\",\n    prompt_text: \"\",\n    tags: [],\n    enabled: true,\n  });\n  const [tagInput, setTagInput] = useState(\"\");\n\n  useEffect(() => {\n    if (initialData) {\n      setFormData({\n        title: initialData.title || \"\",\n        prompt_text: initialData.prompt_text || initialData.content || \"\",\n        tags: Array.isArray(initialData.tags) ? [...initialData.tags] : [],\n        enabled:\n          initialData.enabled !== false && initialData.isActive !== false, // isActive도 체크\n      });\n    }\n  }, [initialData]);\n\n  const handleSubmit = (e) => {\n    e.preventDefault();\n    if (!formData.prompt_text.trim()) {\n      toast.error(\"프롬프트 내용을 입력해주세요\");\n      return;\n    }\n    onSubmit(formData);\n  };\n\n  const handleChange = (field, value) => {\n    setFormData((prev) => ({ ...prev, [field]: value }));\n  };\n\n  const handleTagAdd = (e) => {\n    if (e.key === \"Enter\" && tagInput.trim()) {\n      e.preventDefault();\n      const newTag = tagInput.trim();\n      if (!formData.tags.includes(newTag) && formData.tags.length < 5) {\n        setFormData((prev) => ({\n          ...prev,\n          tags: [...prev.tags, newTag],\n        }));\n      }\n      setTagInput(\"\");\n    }\n  };\n\n  const handleTagRemove = (tagToRemove) => {\n    setFormData((prev) => ({\n      ...prev,\n      tags: prev.tags.filter((tag) => tag !== tagToRemove),\n    }));\n  };\n\n  if (!isOpen) {\n    return null;\n  }\n\n  return (\n    <div className=\"fixed inset-0 bg-black/50 backdrop-blur-sm z-50 flex items-center justify-center p-4\">\n      <div className=\"bg-white dark:bg-dark-secondary rounded-2xl max-w-3xl w-full max-h-[90vh] overflow-hidden shadow-xl dark:shadow-none transition-colors duration-300 \">\n        {/* 헤더 */}\n        <div className=\" p-6 bg-white dark:bg-dark-secondary\">\n          <div className=\"flex items-center justify-between\">\n            <div className=\"flex items-center space-x-3\">\n              <div className=\"w-10 h-10 bg-gray-100 dark:bg-dark-tertiary rounded-lg flex items-center justify-center\">\n                {initialData ? (\n                  <PencilIcon className=\"h-6 w-6 text-gray-600 dark:text-gray-300\" />\n                ) : (\n                  <PencilIcon className=\"h-6 w-6 text-gray-600 dark:text-gray-300\" />\n                )}\n              </div>\n              <div>\n                <h3 className=\"text-lg font-semibold text-gray-900 dark:text-white\">\n                  {initialData ? \"프롬프트 편집\" : \"새 프롬프트\"}\n                </h3>\n                <p className=\"text-sm text-gray-500 dark:text-gray-400\">\n                  {initialData\n                    ? \"프롬프트 내용을 수정하세요\"\n                    : \"새로운 프롬프트를 작성하세요\"}\n                </p>\n              </div>\n            </div>\n            <button\n              type=\"button\"\n              onClick={onCancel}\n              className=\"p-2 text-gray-400 dark:text-gray-500 hover:text-gray-600 dark:hover:text-gray-300 rounded-lg hover:bg-gray-100 dark:hover:bg-dark-tertiary transition-colors\"\n            >\n              <XMarkIcon className=\"h-5 w-5\" />\n            </button>\n          </div>\n        </div>\n\n        <form\n          onSubmit={handleSubmit}\n          className=\"p-6 space-y-6 overflow-y-auto max-h-[calc(90vh-120px)]\"\n        >\n          {/* 제목 필드 */}\n          <div className=\"space-y-2\">\n            <label className=\"flex items-center text-sm font-semibold text-gray-800 dark:text-gray-200\">\n              프롬프트 제목\n            </label>\n            <input\n              type=\"text\"\n              value={formData.title}\n              onChange={(e) => handleChange(\"title\", e.target.value)}\n              className=\"w-full px-4 py-3  rounded-xl bg-gray-50 dark:bg-dark-tertiary text-gray-900 dark:text-white placeholder-gray-500 dark:placeholder-gray-400 focus:outline-none focus:border-blue-500 focus:ring-2 focus:ring-blue-500/20 dark:focus:ring-blue-500/30 transition-all duration-200\"\n              placeholder=\"프롬프트 제목을 입력하세요\"\n            />\n          </div>\n\n          {/* 해시태그 */}\n          <div className=\"space-y-2\">\n            <label className=\"flex items-center text-sm font-semibold text-gray-800 dark:text-gray-200\">\n              <HashtagIcon className=\"h-4 w-4 mr-2 text-gray-500 dark:text-gray-400\" />\n              태그\n            </label>\n            <div className=\"space-y-3\">\n              {/* 태그 입력 */}\n              <input\n                type=\"text\"\n                value={tagInput}\n                onChange={(e) => setTagInput(e.target.value)}\n                onKeyPress={handleTagAdd}\n                className=\"w-full px-4 py-3  rounded-xl bg-gray-50 dark:bg-dark-tertiary text-gray-900 dark:text-white placeholder-gray-500 dark:placeholder-gray-400 focus:outline-none focus:border-blue-500 focus:ring-2 focus:ring-blue-500/20 dark:focus:ring-blue-500/30 transition-all duration-200\"\n                placeholder=\"태그를 입력하고 Enter를 누르세요 (최대 5개)\"\n                maxLength={20}\n                disabled={formData.tags.length >= 5}\n              />\n\n              {/* 태그 목록 */}\n              {formData.tags.length > 0 && (\n                <div className=\"flex flex-wrap gap-2\">\n                  {formData.tags.map((tag, index) => (\n                    <span\n                      key={index}\n                      className=\"inline-flex items-center px-3 py-1 bg-blue-100 dark:bg-blue-900 text-blue-800 dark:text-blue-200 text-sm rounded-full\"\n                    >\n                      #{tag}\n                      <button\n                        type=\"button\"\n                        onClick={() => handleTagRemove(tag)}\n                        className=\"ml-2 text-blue-600 dark:text-blue-400 hover:text-blue-800 dark:hover:text-blue-200\"\n                      >\n                        <XMarkIcon className=\"h-3 w-3\" />\n                      </button>\n                    </span>\n                  ))}\n                </div>\n              )}\n\n              {/* 도움말 텍스트 */}\n              <p className=\"text-xs text-gray-500 dark:text-gray-400\">\n                태그는 프롬프트를 분류하고 검색하는 데 도움이 됩니다. 각 태그는\n                20자 이내로 입력하세요.\n              </p>\n            </div>\n          </div>\n\n          {/* 프롬프트 내용 */}\n          <div className=\"space-y-2\">\n            <label className=\"flex items-center text-sm font-semibold text-gray-800 dark:text-gray-200\">\n              프롬프트 내용 <span className=\"text-red-500 ml-1\">*</span>\n            </label>\n            <div className=\"relative\">\n              <textarea\n                value={formData.prompt_text}\n                onChange={(e) => handleChange(\"prompt_text\", e.target.value)}\n                rows={12}\n                className=\"w-full px-4 py-3  rounded-xl bg-gray-50 dark:bg-dark-tertiary text-gray-900 dark:text-white placeholder-gray-500 dark:placeholder-gray-400 focus:outline-none focus:border-green-500 focus:ring-2 focus:ring-green-500/20 dark:focus:ring-green-500/30 transition-all duration-200 resize-none\"\n                placeholder=\"프롬프트 내용을 입력하세요\"\n                required\n              />\n              <div className=\"absolute bottom-3 right-3 text-xs text-gray-500 dark:text-gray-400 flex items-center space-x-2\">\n                <span>{formData.prompt_text.length} 자</span>\n                <span className=\"text-gray-400 dark:text-gray-500\">\n                  / 📝 50자 이상 권장\n                </span>\n              </div>\n            </div>\n          </div>\n\n          {/* 활성화 옵션 */}\n          <div className=\"flex items-center\">\n            <input\n              type=\"checkbox\"\n              id=\"enabled\"\n              checked={formData.enabled}\n              onChange={(e) => handleChange(\"enabled\", e.target.checked)}\n              className=\"h-4 w-4 text-blue-600 focus:ring-blue-500 rounded\"\n            />\n            <label\n              htmlFor=\"enabled\"\n              className=\"ml-2 text-sm text-gray-700 dark:text-gray-300\"\n            >\n              활성화\n            </label>\n          </div>\n\n          {/* 버튼 영역 */}\n          <div className=\"flex justify-end space-x-3 pt-6 \">\n            <button\n              type=\"button\"\n              onClick={onCancel}\n              className=\"px-6 py-2.5 text-gray-700 dark:text-gray-300 bg-gray-100 dark:bg-gray-700  rounded-lg hover:bg-gray-200 dark:hover:bg-gray-600 transition-colors font-medium\"\n            >\n              취소\n            </button>\n            <button\n              type=\"submit\"\n              disabled={!formData.prompt_text.trim()}\n              className=\"px-6 py-2.5 bg-gradient-to-r from-blue-600 to-blue-700 hover:from-blue-700 hover:to-blue-800 text-white rounded-lg disabled:opacity-50 disabled:cursor-not-allowed transition-all duration-200 font-medium shadow-lg hover:shadow-xl\"\n            >\n              {initialData ? \"수정\" : \"생성\"}\n            </button>\n          </div>\n        </form>\n      </div>\n    </div>\n  );\n};\n\nexport default PromptCardManager;\n","import React from \"react\";\nimport { useParams } from \"react-router-dom\";\nimport PromptCardManager from \"./PromptCardManager\";\n\nconst AdminView = ({ projectId, projectName }) => {\n  return (\n    <div className=\"h-[calc(100vh-4rem)] w-full bg-white dark:bg-dark-primary transition-colors duration-300\">\n      <PromptCardManager projectId={projectId} projectName={projectName} />\n    </div>\n  );\n};\n\nexport default AdminView;\n","import React, { useState, useEffect } from \"react\";\nimport { promptCardAPI } from \"../services/api\";\nimport ChatInterface from \"./ChatInterface\";\nimport LoadingSpinner from \"./LoadingSpinner\";\nimport { ChatInterfaceSkeleton } from \"./skeleton/SkeletonComponents\";\n\nconst UserView = ({ projectId, projectName }) => {\n  const [promptCards, setPromptCards] = useState([]);\n  const [loading, setLoading] = useState(true);\n\n  useEffect(() => {\n    const loadPromptCards = async () => {\n      try {\n        setLoading(true);\n        // AdminView와 동일하게 includeContent=true로 설정하여 프롬프트 내용을 포함하여 로드\n        const response = await promptCardAPI.getPromptCards(projectId, true);\n        // 응답 구조가 AdminView와 동일하게 처리\n        setPromptCards(response.promptCards || []);\n      } catch (error) {\n        console.warn(\"프롬프트 카드 로드 실패:\", error);\n        setPromptCards([]);\n      } finally {\n        setLoading(false);\n      }\n    };\n\n    loadPromptCards();\n  }, [projectId]);\n\n  if (loading) {\n    return <ChatInterfaceSkeleton />;\n  }\n\n  return (\n    <div className=\"h-[calc(100vh-4rem)] bg-white dark:bg-dark-primary transition-colors duration-300\">\n      <ChatInterface\n        projectId={projectId}\n        projectName={projectName}\n        promptCards={promptCards}\n      />\n    </div>\n  );\n};\n\nexport default UserView;\n","import React, { useState, useEffect } from \"react\";\nimport { useParams, useNavigate } from \"react-router-dom\";\nimport { toast } from \"react-hot-toast\";\nimport { projectAPI, handleAPIError } from \"../services/api\";\nimport AdminView from \"./AdminView\";\nimport UserView from \"./UserView\";\nimport { useAuth } from \"../contexts/AuthContext\";\nimport { ChatInterfaceSkeleton } from \"./skeleton/SkeletonComponents\";\n\nconst ProjectDetail = () => {\n  const { projectId } = useParams();\n  const navigate = useNavigate();\n  const { user } = useAuth();\n  const [project, setProject] = useState(null);\n  const [loading, setLoading] = useState(true);\n\n  useEffect(() => {\n    loadProjectData();\n  }, [projectId, navigate]);\n\n  const loadProjectData = async () => {\n    try {\n      setLoading(true);\n\n      // 일반 사용자인 경우 고정된 프로젝트나 기본 프로젝트를 사용\n      let projectData;\n      if (user?.role === \"user\") {\n        // 일반 사용자용 기본 프로젝트 사용 (실제로는 관리자가 설정한 기본 프로젝트)\n        try {\n          projectData = await projectAPI.getProject(projectId || \"default\");\n        } catch (error) {\n          // 기본 프로젝트가 없으면 빈 프로젝트 생성\n          projectData = {\n            projectId: \"chat\",\n            name: \"AI 채팅\",\n            description: \"AI와 자유롭게 대화하세요\",\n            promptCards: [],\n            createdAt: new Date().toISOString(),\n            updatedAt: new Date().toISOString(),\n          };\n        }\n      } else {\n        projectData = await projectAPI.getProject(projectId);\n      }\n\n      setProject(projectData);\n    } catch (error) {\n      console.error(\"프로젝트 로드 실패:\", error);\n      const errorInfo = handleAPIError(error);\n      toast.error(errorInfo.message);\n\n      // 권한에 따른 리다이렉트\n      if (user?.role === \"admin\") {\n        navigate(\"/projects\");\n      } else {\n        navigate(\"/dashboard\");\n      }\n    } finally {\n      setLoading(false);\n    }\n  };\n\n\n  if (loading) {\n    return <ChatInterfaceSkeleton />;\n  }\n\n  if (!project) {\n    return (\n      <div className=\"min-h-screen bg-gray-50 dark:bg-gray-900 flex items-center justify-center transition-colors duration-200\">\n        <div className=\"text-center\">\n          <h2 className=\"text-xl font-semibold text-gray-900 dark:text-white mb-4\">\n            프로젝트를 찾을 수 없습니다\n          </h2>\n          <button\n            onClick={() => {\n              if (user?.role === \"admin\") {\n                navigate(\"/projects\");\n              } else {\n                navigate(\"/dashboard\");\n              }\n            }}\n            className=\"inline-flex items-center px-4 py-2 text-sm font-medium rounded-md text-blue-700 dark:text-blue-300 bg-blue-100 dark:bg-blue-900 hover:bg-blue-200 dark:hover:bg-blue-800 focus:outline-none transition-colors duration-200\"\n          >\n            {user?.role === \"admin\" ? \"프로젝트 목록으로\" : \"대시보드로\"}\n          </button>\n        </div>\n      </div>\n    );\n  }\n\n  return (\n    <div className=\"min-h-screen w-full bg-gray-50 dark:bg-dark-primary transition-all duration-500\">\n      {user?.role === \"admin\" ? (\n        // 관리자 모드: 프롬프트 카드 관리 + 채팅\n        <AdminView projectId={projectId} projectName={project.name} />\n      ) : (\n        // 사용자 모드: 채팅만\n        <UserView projectId={projectId} projectName={project.name} />\n      )}\n    </div>\n  );\n};\n\nexport default ProjectDetail;\n","import React from \"react\";\n\nconst LoadingSpinner = ({ message = \"로딩 중...\" }) => {\n  return (\n    <div className=\"min-h-screen bg-gray-50 dark:bg-dark-primary flex items-center justify-center transition-colors duration-300\">\n      <div className=\"text-center\">\n        <div className=\"animate-spin rounded-full h-12 w-12 border-b-2 border-blue-600 mx-auto mb-4\"></div>\n        <p className=\"text-gray-600 dark:text-gray-300\">{message}</p>\n      </div>\n    </div>\n  );\n};\n\nexport default LoadingSpinner;\n"],"names":["copyToClipboard","async","text","successMessage","arguments","length","undefined","errorMessage","navigator","clipboard","writeText","toast","success","error","console","getAgentName","agentType","journalism","balanced","click","seo","social","formatMultiAgentContent","agentSummary","allTitles","content","forEach","title","index","agent","agentName","titles","tokenCount","useChat","projectId","projectName","promptCards","messages","setMessages","useState","inputValue","setInputValue","copiedMessage","setCopiedMessage","canSendMessage","setCanSendMessage","inputHeight","setInputHeight","selectedModel","setSelectedModel","streamingMessageIdRef","useRef","currentWebSocketRef","currentExecutionIdRef","messagesEndRef","inputRef","isUserScrolling","setIsUserScrolling","scrollContainerRef","lastScrollTopRef","isExecuting","isGenerating","isStreaming","executeOrchestration","pollOrchestrationResult","resetOrchestration","setIsExecuting","currentExecution","setCurrentExecution","executionStatus","setExecutionStatus","setIsStreaming","useCallback","userInput","options","trim","data","chat_history","prompt_cards","modelId","log","inputLength","historyLength","promptCardsCount","useStreaming","timestamp","Date","toISOString","onChunk","onError","_error$message","_error$message2","_error$message3","_error$message4","message","includes","code","onComplete","response","_response$result","resultLength","result","generateAPI","generateTitleStream","streamError","generateTitle","mode","_error$response","_error$response2","_error$message5","_error$response3","_error$response4","_error$response4$data","_error$response5","_error$response6","_error$response7","status","setup_required","executionArn","poll","getExecutionStatus","Error","setTimeout","useOrchestration","isConnected","wsConnected","isConnecting","wsConnecting","wsError","startStreaming","wsStartStreaming","addMessageListener","removeMessageListener","setIsConnected","setIsConnecting","setError","wsRef","reconnectTimeoutRef","reconnectAttempts","getWebSocketUrl","wsUrl","process","REACT_APP_WS_URL","startsWith","normalizedUrl","replace","connect","_wsRef$current","_wsRef$current2","current","readyState","WebSocket","OPEN","CONNECTING","close","window","wsConnectStart","now","connectionTimeout","_wsRef$current3","onopen","event","_wsRef$current4","_wsRef$current5","_wsRef$current6","clearTimeout","url","protocol","extensions","onclose","connectionDuration","reason","wasClean","delay","Math","min","pow","onerror","_wsRef$current7","_wsRef$current8","err","disconnect","sendMessage","_wsRef$current9","send","JSON","stringify","chatHistory","action","listener","addEventListener","removeEventListener","useEffect","timer","useWebSocket","handleScroll","container","currentScrollTop","scrollTop","maxScrollTop","scrollHeight","clientHeight","abs","scrollToBottom","scrollIntoView","behavior","handleWebSocketMessage","parse","currentStreamingId","type","step","progress","prev","updatedMessages","streamingMsgIndex","findIndex","msg","id","currentContent","isLoading","fullContent","isError","handleStreamingResponse","chunk","metadata","handleStreamingComplete","performance_metrics","model_info","handleStopGeneration","adjustInputHeight","value","lines","split","charBasedLines","ceil","estimatedLines","max","calculatedHeight","handleInputChange","handleSendMessage","userMessage","streamMsgId","streamingMessage","allMessages","filter","map","role","trimmedChatHistory","slice","totalMessages","fullHistoryLength","trimmedHistoryLength","maxHistoryLength","recentHistory","activePromptCards","Array","isArray","card","isActive","enabled","promptId","prompt_id","prompt_text","tags","stepOrder","sort","a","b","messageContent","chatHistoryLength","contentLength","hasContent","crewAPI","createCrewInstance","instanceError","multiAgentResult","executeMultiAgent","assistantMessage","agentResults","finalTitles","tokenUsage","Object","keys","agentResult","values","flat","isMultiAgent","processMultiAgentResponse","push","errorType","errorDetails","handleKeyPress","e","key","shiftKey","preventDefault","handleCopyMessage","messageId","handleCopyTitle","resetChat","streamingMessageId","AnimatedStreamingIndicator","_jsxs","motion","div","className","initial","opacity","scale","animate","transition","duration","children","repeat","Infinity","_jsx","span","AnimatedErrorDetails","_ref","height","ExclamationTriangleIcon","_ref2","_message$timestamp","_message$timestamp2","onCopyMessage","onCopyTitle","isUser","contentVariants","y","stiffness","damping","buttonVariants","hover","tap","variants","staggerChildren","whileHover","toLocaleTimeString","x","ReactMarkdown","ChatMessageSkeleton","AnimatePresence","button","onClick","whileTap","custom","CheckCircleIcon","DocumentDuplicateIcon","_Fragment","ClipboardDocumentIcon","MODELS","name","provider","category","speed","quality","description","recommended","new","onModelChange","isOpen","setIsOpen","setFilter","currentModel","find","model","filteredModels","toLowerCase","ChevronDownIcon","label","filterOption","handleModelSelect","useNavigate","uploadedFile","setUploadedFile","dragOver","setDragOver","ref","onScroll","ChatBubbleLeftRightIcon","SparklesIcon","AnimatedChatMessage","DocumentPlusIcon","removeFile","XMarkIcon","style","minHeight","boxShadow","onDrop","files","dataTransfer","file","reader","FileReader","onload","_e$target2","target","readAsText","onDragOver","onDragLeave","handleDragLeave","onChange","onKeyPress","placeholder","rows","maxHeight","lineHeight","paddingTop","paddingBottom","overflowY","whiteSpace","fontSize","fontWeight","color","outline","disabled","bottom","width","StopIcon","PaperAirplaneIcon","ModelSelector","PromptCard","onEdit","onDelete","stopPropagation","PencilIcon","TrashIcon","tag","createdAt","toLocaleDateString","year","month","day","updatedAt","PromptFormModal","_ref3","onSubmit","onCancel","initialData","formData","setFormData","tagInput","setTagInput","handleChange","field","HashtagIcon","newTag","maxLength","handleTagRemove","tagToRemove","required","checked","htmlFor","setPromptCards","loading","setLoading","editingCard","setEditingCard","showForm","setShowForm","loadPromptCards","promptCardAPI","getPromptCards","errorInfo","handleAPIError","handleNewCard","ChatInterface","PlusIcon","cardWithContent","_contentResponse$cont","contentResponse","getPromptContent","handleEditCard","confirm","deletePromptCard","handleDeleteCard","backendData","cardData","updatePromptCard","createPromptCard","handleCancelForm","PromptCardManager","warn","ChatInterfaceSkeleton","ProjectDetail","useParams","navigate","user","useAuth","project","setProject","loadProjectData","projectData","projectAPI","getProject","AdminView","UserView"],"sourceRoot":""}