{"version":3,"file":"static/js/451.fac87311.chunk.js","mappings":"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","sources":["components/chat/ConversationDrawer.js","hooks/useConversations.js","components/ModelSelector.js","utils/clipboard.js","hooks/useChat.js","hooks/useOrchestration.js","hooks/useWebSocket.js","components/SimpleChatMessage.js","components/chat/ChatWindow.js","hooks/useMessages.js","components/PromptCardManager.js","components/AdminView.js","components/UserView.js","components/ProjectDetail.js"],"sourcesContent":["import React, { useState, useRef, useEffect } from \"react\";\nimport { useConversations } from \"../../hooks/useConversations\";\nimport { useConversationContext } from \"../../contexts/ConversationContext\";\n\nconst ConversationDrawer = ({ isOpen, onClose, className = \"\", onCollapsedChange }) => {\n  const {\n    conversations,\n    loading,\n    error,\n    hasMore,\n    loadMore,\n    createConversation,\n    deleteConversation,\n  } = useConversations();\n\n  const { currentConversationId, setCurrentConversation } =\n    useConversationContext();\n\n  const [isCreating, setIsCreating] = useState(false);\n  const [isCollapsed, setIsCollapsed] = useState(false);\n  const [createError, setCreateError] = useState(null);\n  const [deletingId, setDeletingId] = useState(null);\n  const [deleteError, setDeleteError] = useState(null);\n  const [activeMenuId, setActiveMenuId] = useState(null);\n  const [editingId, setEditingId] = useState(null);\n  const [editingTitle, setEditingTitle] = useState(\"\");\n\n  // 대화 목록 스크롤을 위한 ref\n  const conversationListRef = useRef(null);\n\n  // 새 대화가 추가될 때마다 맨 아래로 스크롤\n  useEffect(() => {\n    if (conversationListRef.current && conversations.length > 0 && !isCollapsed) {\n      conversationListRef.current.scrollTop = conversationListRef.current.scrollHeight;\n    }\n  }, [conversations.length, isCollapsed]);\n\n  // 외부 클릭 시 메뉴 닫기\n  useEffect(() => {\n    const handleClickOutside = (event) => {\n      if (activeMenuId && !event.target.closest('.conversation-menu')) {\n        setActiveMenuId(null);\n      }\n    };\n\n    document.addEventListener('mousedown', handleClickOutside);\n    return () => {\n      document.removeEventListener('mousedown', handleClickOutside);\n    };\n  }, [activeMenuId]);\n\n  // 새 대화 생성\n  const handleNewChat = async () => {\n    if (isCreating) return;\n\n    setIsCreating(true);\n    setCreateError(null);\n\n    try {\n      const newConversation = await createConversation(\"새 대화\");\n      setCurrentConversation(newConversation.id);\n\n      if (window.innerWidth < 768) {\n        onClose();\n      }\n    } catch (error) {\n      console.error(\"새 대화 생성 실패:\", error);\n      setCreateError(\"새 대화를 생성할 수 없습니다. 다시 시도해주세요.\");\n      setTimeout(() => setCreateError(null), 3000);\n    } finally {\n      setIsCreating(false);\n    }\n  };\n\n  // 대화 선택\n  const handleSelectConversation = (conversationId) => {\n    setCurrentConversation(conversationId);\n\n    if (window.innerWidth < 768) {\n      onClose();\n    }\n  };\n\n  // 대화 삭제\n  const handleDeleteConversation = async (conversationId, event) => {\n    event.stopPropagation(); // 대화 선택을 방지\n    \n    if (!window.confirm('이 대화를 삭제하시겠습니까?')) {\n      return;\n    }\n\n    setDeletingId(conversationId);\n    setDeleteError(null);\n    setActiveMenuId(null); // 메뉴 닫기\n\n    try {\n      await deleteConversation(conversationId);\n      \n      // 현재 선택된 대화가 삭제된 경우 첫 번째 대화로 이동\n      if (currentConversationId === conversationId && conversations.length > 1) {\n        const remainingConversations = conversations.filter(conv => conv.id !== conversationId);\n        if (remainingConversations.length > 0) {\n          setCurrentConversation(remainingConversations[0].id);\n        }\n      }\n      \n      console.log('대화 삭제 완료:', conversationId);\n    } catch (error) {\n      console.error('대화 삭제 중 오류:', error);\n      // 일반적으로 API 오류가 발생해도 로컬에서는 삭제되므로 에러 표시하지 않음\n      // setDeleteError('대화를 삭제할 수 없습니다. 다시 시도해주세요.');\n      // setTimeout(() => setDeleteError(null), 3000);\n    } finally {\n      setDeletingId(null);\n    }\n  };\n\n  // 대화 수정 시작\n  const handleStartEdit = (conversationId, currentTitle, event) => {\n    event.stopPropagation();\n    setEditingId(conversationId);\n    setEditingTitle(currentTitle);\n    setActiveMenuId(null); // 메뉴 닫기\n  };\n\n  // 대화 수정 완료\n  const handleSaveEdit = async (conversationId) => {\n    if (!editingTitle.trim()) {\n      setEditingId(null);\n      setEditingTitle(\"\");\n      return;\n    }\n\n    try {\n      // TODO: API 호출로 대화 제목 업데이트\n      console.log('대화 제목 업데이트:', conversationId, editingTitle);\n      // await updateConversation(conversationId, { title: editingTitle });\n      \n      setEditingId(null);\n      setEditingTitle(\"\");\n    } catch (error) {\n      console.error('대화 제목 수정 중 오류:', error);\n    }\n  };\n\n  // 대화 수정 취소\n  const handleCancelEdit = () => {\n    setEditingId(null);\n    setEditingTitle(\"\");\n  };\n\n  // 메뉴 토글\n  const handleToggleMenu = (conversationId, event) => {\n    event.stopPropagation();\n    setActiveMenuId(activeMenuId === conversationId ? null : conversationId);\n  };\n\n\n  // 대화를 날짜별로 그룹화\n  const groupConversationsByDate = (conversations) => {\n    const groups = {};\n    const today = new Date();\n    const yesterday = new Date(today);\n    yesterday.setDate(yesterday.getDate() - 1);\n\n    conversations.forEach((conversation) => {\n      const date = new Date(conversation.lastActivityAt || conversation.createdAt);\n      const isToday = date.toDateString() === today.toDateString();\n      const isYesterday = date.toDateString() === yesterday.toDateString();\n\n      let key;\n      if (isToday) {\n        key = \"Today\";\n      } else if (isYesterday) {\n        key = \"Yesterday\";\n      } else {\n        const monthYear = date.toLocaleDateString(\"ko-KR\", {\n          year: \"numeric\",\n          month: \"2-digit\",\n        });\n        key = monthYear;\n      }\n\n      if (!groups[key]) {\n        groups[key] = [];\n      }\n      groups[key].push(conversation);\n    });\n\n    return groups;\n  };\n\n  const conversationGroups = groupConversationsByDate(conversations);\n\n  return (\n    <>\n      {/* 모바일 오버레이 */}\n      {isOpen && (\n        <div\n          className=\"fixed inset-0 bg-black/40 backdrop-blur-sm z-40 md:hidden transition-opacity duration-300\"\n          onClick={onClose}\n        />\n      )}\n\n      {/* 드로어 컨테이너 */}\n      <div\n        className={`\n        conversation-drawer\n        fixed top-0 left-0 h-full z-[9999]\n        bg-[#0d1117]\n        border-r border-[#21262d] shadow-[inset_0_0_16px_rgba(0,0,0,0.4)]\n        transform transition-all duration-500 ease-out\n        ${isOpen ? \"translate-x-0\" : \"-translate-x-full\"}\n        md:translate-x-0\n        ${isCollapsed ? \"w-14\" : \"w-full md:w-64\"}\n        ${className}\n      `}\n      style={{ overscrollBehavior: 'contain' }}\n      >\n        {/* 헤더 - 접힌 상태에서는 숨김 */}\n        {!isCollapsed && (\n          <div className=\"flex items-center justify-between p-5 border-b border-[#21262d] relative transition-opacity duration-300 ease-in-out\">\n            <h1 className=\"text-xl font-semibold tracking-tight text-[#e6edf3]\">\n              TITLE-NOMICS\n            </h1>\n            \n            {/* 미니멀 토글 버튼 */}\n            <button\n              onClick={() => {\n                const newCollapsed = !isCollapsed;\n                setIsCollapsed(newCollapsed);\n                if (onCollapsedChange) {\n                  onCollapsedChange(newCollapsed);\n                }\n              }}\n              className=\"w-10 h-10 py-2 rounded-full bg-transparent hover:bg-[#11161f] transition-colors duration-200 flex items-center justify-center group\"\n              title=\"사이드바 접기\"\n            >\n              <svg \n                xmlns=\"http://www.w3.org/2000/svg\" \n                fill=\"none\" \n                viewBox=\"0 0 24 24\" \n                strokeWidth=\"1.5\" \n                stroke=\"currentColor\" \n                className=\"w-6 h-6 text-[#88929d] group-hover:text-[#e6edf3] transition-colors duration-200\"\n              >\n                <path \n                  strokeLinecap=\"round\" \n                  strokeLinejoin=\"round\" \n                  d=\"M18.75 19.5l-7.5-7.5 7.5-7.5m-6 15L5.25 12l7.5-7.5\" \n                />\n              </svg>\n            </button>\n          </div>\n        )}\n\n        {/* 접힌 상태 전용 토글 버튼 */}\n        {isCollapsed && (\n          <div className=\"p-2 flex justify-center border-b border-[#21262d]\">\n            <button\n              onClick={() => {\n                const newCollapsed = !isCollapsed;\n                setIsCollapsed(newCollapsed);\n                if (onCollapsedChange) {\n                  onCollapsedChange(newCollapsed);\n                }\n              }}\n              className=\"w-10 h-10 py-2 rounded-full bg-transparent hover:bg-[#11161f] transition-colors duration-200 flex items-center justify-center group\"\n              title=\"사이드바 펼치기\"\n            >\n              <svg \n                xmlns=\"http://www.w3.org/2000/svg\" \n                fill=\"none\" \n                viewBox=\"0 0 24 24\" \n                strokeWidth=\"1.5\" \n                stroke=\"currentColor\" \n                className=\"w-6 h-6 text-[#88929d] group-hover:text-[#e6edf3] transition-colors duration-200 rotate-180\"\n              >\n                <path \n                  strokeLinecap=\"round\" \n                  strokeLinejoin=\"round\" \n                  d=\"M18.75 19.5l-7.5-7.5 7.5-7.5m-6 15L5.25 12l7.5-7.5\" \n                />\n              </svg>\n            </button>\n          </div>\n        )}\n\n        {/* 새 대화 버튼 */}\n        {!isCollapsed && (\n          <div className=\"p-4 border-b border-[#21262d] transition-opacity duration-300 ease-in-out\">\n            <button\n              onClick={handleNewChat}\n              disabled={isCreating}\n              className=\"group w-full flex items-center justify-start gap-3 px-3 py-2.5 text-[#e6edf3] hover:bg-[#21262d] disabled:bg-[#374151] rounded-lg text-sm transition-all duration-200 focus:outline-none border border-[#6e7681] hover:border-[#8b949e]\"\n              title=\"새 채팅\"\n            >\n              {isCreating ? (\n                <>\n                  <div className=\"flex-shrink-0 w-5 h-5 flex items-center justify-center\">\n                    <div className=\"animate-spin rounded-full h-4 w-4 border-b-2 border-[#e6edf3]\"></div>\n                  </div>\n                  <span className=\"font-medium\">생성 중...</span>\n                </>\n              ) : (\n                <>\n                  <div className=\"flex-shrink-0 w-5 h-5 flex items-center justify-center\">\n                    <svg xmlns=\"http://www.w3.org/2000/svg\" fill=\"none\" viewBox=\"0 0 24 24\" strokeWidth=\"2\" stroke=\"currentColor\" className=\"h-4 w-4 group-hover:scale-110 transition-transform duration-200\">\n                      <path strokeLinecap=\"round\" strokeLinejoin=\"round\" d=\"M12 4.5v15m7.5-7.5h-15\" />\n                    </svg>\n                  </div>\n                  <span className=\"font-medium\">새 채팅</span>\n                </>\n              )}\n            </button>\n\n            {(createError || deleteError) && (\n              <div className=\"mt-2 p-2 bg-red-500/10 border border-red-500/20 rounded text-center\">\n                <p className=\"text-xs text-red-400\">{createError || deleteError}</p>\n              </div>\n            )}\n          </div>\n        )}\n\n        {/* 대화 목록 */}\n        <div \n          ref={conversationListRef} \n          className=\"flex flex-col gap-0.5 overflow-y-auto h-[calc(100vh-210px)] custom-scrollbar\"\n          onScroll={(e) => e.stopPropagation()}\n        >\n          <style jsx>{`\n            /* CSS Custom Properties for Design System */\n            .conversation-drawer {\n              --color-bg-primary: #0d1117;\n              --color-bg-secondary: #11161f;\n              --color-bg-tertiary: #161b22;\n              --color-border: #21262d;\n              --color-text-primary: #e6edf3;\n              --color-text-secondary: #88929d;\n              --color-accent: #10b981;\n              --color-accent-hover: #059669;\n              --color-danger: #f85149;\n              --shadow-depth: inset 0 0 16px rgba(0,0,0,0.4);\n            }\n\n            .custom-scrollbar::-webkit-scrollbar {\n              width: 8px;\n            }\n            .custom-scrollbar::-webkit-scrollbar-track {\n              background: transparent;\n              border-radius: 4px;\n            }\n            .custom-scrollbar::-webkit-scrollbar-thumb {\n              background: var(--color-border);\n              border-radius: 4px;\n              border: 1px solid var(--color-bg-primary);\n            }\n            .custom-scrollbar::-webkit-scrollbar-thumb:hover {\n              background: #30363d;\n            }\n            .custom-scrollbar::-webkit-scrollbar-thumb:active {\n              background: #484f58;\n            }\n            .custom-scrollbar::-webkit-scrollbar-corner {\n              background: transparent;\n            }\n            \n            /* 사이드바 스크롤 격리 */\n            .custom-scrollbar {\n              overscroll-behavior: contain;\n              scroll-behavior: smooth;\n            }\n          `}</style>\n\n          {error && !isCollapsed && (\n            <div className=\"p-4 text-center bg-red-900/30 rounded-lg border border-red-700/50 mb-4\">\n              <div className=\"text-red-300 text-sm font-medium\">{error}</div>\n            </div>\n          )}\n\n          {conversations.length === 0 && !loading && !error && !isCollapsed && (\n            <div className=\"p-6 text-center\">\n              <div className=\"w-12 h-12 mx-auto mb-4 bg-gradient-to-br from-gray-800/50 to-gray-900/50 rounded-2xl flex items-center justify-center shadow-lg border border-gray-700/30\">\n                <svg xmlns=\"http://www.w3.org/2000/svg\" fill=\"none\" viewBox=\"0 0 24 24\" strokeWidth=\"1.5\" stroke=\"currentColor\" className=\"h-6 w-6 text-gray-400\">\n                  <path strokeLinecap=\"round\" strokeLinejoin=\"round\" d=\"M20.25 8.511c.884.284 1.5 1.128 1.5 2.097v4.286c0 1.136-.847 2.1-1.98 2.193-.34.027-.68.052-1.02.072v3.091l-3-3c-1.354 0-2.694-.055-4.02-.163a2.115 2.115 0 0 1-.825-.242m9.345-8.334a2.126 2.126 0 0 0-.476-.095 48.64 48.64 0 0 0-8.048 0c-1.131.094-1.976 1.057-1.976 2.192v4.286c0 .837.46 1.58 1.155 1.951m9.345-8.334V6.637c0-1.621-1.152-3.026-2.76-3.235A48.455 48.455 0 0 0 11.25 3c-2.115 0-4.198.137-6.24.402-1.608.209-2.76 1.614-2.76 3.235v6.226c0 1.621 1.152 3.026 2.76 3.235.577.075 1.157.14 1.74.194V21l4.155-4.155\" />\n                </svg>\n              </div>\n              <h3 className=\"text-sm font-medium text-white mb-2 drop-shadow\">\n                아직 대화가 없습니다\n              </h3>\n              <p className=\"text-xs text-gray-400 leading-snug opacity-80\">\n                새 대화를 시작해서 AI와 대화해보세요!\n              </p>\n            </div>\n          )}\n\n          {/* 로딩 상태 */}\n          {loading && conversations.length === 0 && !isCollapsed && (\n            <div className=\"flex flex-col gap-1\">\n              {[...Array(5)].map((_, i) => (\n                <div\n                  key={i}\n                  className=\"w-full h-10 px-3 bg-gray-900/40 animate-pulse flex items-center\"\n                >\n                  <div className=\"h-3 bg-gray-700/40 rounded w-3/4\"></div>\n                </div>\n              ))}\n            </div>\n          )}\n\n          {/* 딥시크 스타일 대화 목록 */}\n          {!isCollapsed && conversations.length > 0 && (\n            <div className=\"flex flex-col gap-1 transition-opacity duration-300 ease-in-out\">\n              {Object.entries(conversationGroups).map(([groupTitle, groupConversations]) => (\n                <div key={groupTitle}>\n                  {/* 날짜 그룹 헤더 */}\n                  <div className=\"text-xs text-white/40 uppercase tracking-wide py-2 px-3 font-medium\">\n                    {groupTitle}\n                  </div>\n                  \n                  {/* 그룹 내 대화들 */}\n                  {groupConversations.map((conversation) => (\n                    <div\n                      key={conversation.id}\n                      className={`\n                        flex items-center justify-between h-10 px-3 py-2 text-sm transition-colors duration-200 relative\n                        ${\n                          currentConversationId === conversation.id\n                            ? \"bg-[#161b22] text-[#e6edf3] relative before:absolute before:left-0 before:top-0 before:bottom-0 before:w-[2px] before:bg-[#10b981]\"\n                            : \"text-[#88929d] hover:bg-[#11161f] hover:text-[#e6edf3]\"\n                        }\n                      `}\n                    >\n                      {editingId === conversation.id ? (\n                        // 수정 모드\n                        <div className=\"flex-1 flex items-center gap-2\">\n                          <input\n                            type=\"text\"\n                            value={editingTitle}\n                            onChange={(e) => setEditingTitle(e.target.value)}\n                            onKeyPress={(e) => {\n                              if (e.key === 'Enter') {\n                                handleSaveEdit(conversation.id);\n                              } else if (e.key === 'Escape') {\n                                handleCancelEdit();\n                              }\n                            }}\n                            className=\"flex-1 bg-[#0d1117] border border-[#21262d] rounded px-2 py-1 text-sm text-[#e6edf3] focus:outline-none focus:border-[#10b981]\"\n                            autoFocus\n                          />\n                          <button\n                            onClick={() => handleSaveEdit(conversation.id)}\n                            className=\"p-1 text-[#10b981] hover:bg-[#161b22] rounded\"\n                            title=\"저장\"\n                          >\n                            <svg xmlns=\"http://www.w3.org/2000/svg\" fill=\"none\" viewBox=\"0 0 24 24\" strokeWidth=\"2\" stroke=\"currentColor\" className=\"h-4 w-4\">\n                              <path strokeLinecap=\"round\" strokeLinejoin=\"round\" d=\"m4.5 12.75 6 6 9-13.5\" />\n                            </svg>\n                          </button>\n                          <button\n                            onClick={handleCancelEdit}\n                            className=\"p-1 text-[#88929d] hover:text-[#f85149] hover:bg-[#161b22] rounded\"\n                            title=\"취소\"\n                          >\n                            <svg xmlns=\"http://www.w3.org/2000/svg\" fill=\"none\" viewBox=\"0 0 24 24\" strokeWidth=\"2\" stroke=\"currentColor\" className=\"h-4 w-4\">\n                              <path strokeLinecap=\"round\" strokeLinejoin=\"round\" d=\"M6 18L18 6M6 6l12 12\" />\n                            </svg>\n                          </button>\n                        </div>\n                      ) : (\n                        // 일반 모드\n                        <>\n                          <button\n                            onClick={() => handleSelectConversation(conversation.id)}\n                            className=\"flex-1 text-left truncate focus:outline-none py-2\"\n                            title={conversation.title}\n                          >\n                            <span className=\"truncate text-sm font-medium\">\n                              {conversation.title || '새 대화'}\n                            </span>\n                          </button>\n                          \n                          {/* 메뉴 버튼 */}\n                          <div className=\"conversation-menu relative\">\n                            <button\n                              onClick={(e) => handleToggleMenu(conversation.id, e)}\n                              className=\"ml-2 py-2 px-2 text-[#88929d] hover:text-[#e6edf3] transition-colors duration-200 flex-shrink-0 rounded-md hover:bg-[#161b22]\"\n                              title=\"메뉴\"\n                            >\n                              <svg xmlns=\"http://www.w3.org/2000/svg\" fill=\"none\" viewBox=\"0 0 24 24\" strokeWidth=\"1.5\" stroke=\"currentColor\" className=\"h-5 w-5\">\n                                <path strokeLinecap=\"round\" strokeLinejoin=\"round\" d=\"M6.75 12a.75.75 0 1 1-1.5 0 .75.75 0 0 1 1.5 0ZM12.75 12a.75.75 0 1 1-1.5 0 .75.75 0 0 1 1.5 0ZM18.75 12a.75.75 0 1 1-1.5 0 .75.75 0 0 1 1.5 0Z\" />\n                              </svg>\n                            </button>\n\n                            {/* 드롭다운 메뉴 */}\n                            {activeMenuId === conversation.id && (\n                              <div className=\"absolute right-0 top-full mt-1 bg-[#21262d] border border-[#30363d] rounded-md shadow-lg z-50 min-w-[120px]\">\n                                <button\n                                  onClick={(e) => handleStartEdit(conversation.id, conversation.title, e)}\n                                  className=\"w-full px-3 py-2 text-sm text-[#e6edf3] hover:bg-[#30363d] flex items-center gap-2 transition-colors duration-200\"\n                                >\n                                  <svg xmlns=\"http://www.w3.org/2000/svg\" fill=\"none\" viewBox=\"0 0 24 24\" strokeWidth=\"1.5\" stroke=\"currentColor\" className=\"h-4 w-4\">\n                                    <path strokeLinecap=\"round\" strokeLinejoin=\"round\" d=\"m16.862 4.487 1.687-1.688a1.875 1.875 0 1 1 2.652 2.652L10.582 16.07a4.5 4.5 0 0 1-1.897 1.13L6 18l.8-2.685a4.5 4.5 0 0 1 1.13-1.897l8.932-8.931Zm0 0L19.5 7.125M18 14v4.75A2.25 2.25 0 0 1 15.75 21H5.25A2.25 2.25 0 0 1 3 18.75V8.25A2.25 2.25 0 0 1 5.25 6H10\" />\n                                  </svg>\n                                  수정\n                                </button>\n                                <button\n                                  onClick={(e) => handleDeleteConversation(conversation.id, e)}\n                                  disabled={deletingId === conversation.id}\n                                  className=\"w-full px-3 py-2 text-sm text-[#f85149] hover:bg-[#30363d] flex items-center gap-2 transition-colors duration-200 disabled:opacity-50\"\n                                >\n                                  {deletingId === conversation.id ? (\n                                    <div className=\"animate-spin rounded-full h-4 w-4 border-b border-[#f85149]\"></div>\n                                  ) : (\n                                    <svg xmlns=\"http://www.w3.org/2000/svg\" fill=\"none\" viewBox=\"0 0 24 24\" strokeWidth=\"1.5\" stroke=\"currentColor\" className=\"h-4 w-4\">\n                                      <path strokeLinecap=\"round\" strokeLinejoin=\"round\" d=\"m14.74 9-.346 9m-4.788 0L9.26 9m9.968-3.21c.342.052.682.107 1.022.166m-1.022-.165L18.16 19.673a2.25 2.25 0 0 1-2.244 2.077H8.084a2.25 2.25 0 0 1-2.244-2.077L4.772 5.79m14.456 0a48.108 48.108 0 0 0-3.478-.397m-12 .562c.34-.059.68-.114 1.022-.165m0 0a48.11 48.11 0 0 1 3.478-.397m7.5 0v-.916c0-1.18-.91-2.164-2.09-2.201a51.964 51.964 0 0 0-3.32 0c-1.18.037-2.09 1.022-2.09 2.201v.916m7.5 0a48.667 48.667 0 0 0-7.5 0\" />\n                                    </svg>\n                                  )}\n                                  삭제\n                                </button>\n                              </div>\n                            )}\n                          </div>\n                        </>\n                      )}\n                    </div>\n                  ))}\n                </div>\n              ))}\n            </div>\n          )}\n\n          {/* 접힌 상태 새 대화 버튼만 표시 */}\n          {isCollapsed && (\n            <div className=\"flex flex-col items-center p-2 transition-opacity duration-300 ease-in-out\">\n              <button\n                onClick={handleNewChat}\n                disabled={isCreating}\n                className=\"w-10 h-10 bg-[#21262d] hover:bg-[#30363d] disabled:bg-[#374151] text-white rounded-full flex items-center justify-center transition-colors duration-200 focus:outline-none border border-[#30363d] hover:border-[#444c56]\"\n                title=\"새 대화\"\n              >\n                {isCreating ? (\n                  <div className=\"animate-spin rounded-full h-4 w-4 border-b-2 border-white\"></div>\n                ) : (\n                  <svg xmlns=\"http://www.w3.org/2000/svg\" fill=\"none\" viewBox=\"0 0 24 24\" strokeWidth=\"2\" stroke=\"currentColor\" className=\"h-6 w-6\">\n                    <path strokeLinecap=\"round\" strokeLinejoin=\"round\" d=\"M12 4.5v15m7.5-7.5h-15\" />\n                  </svg>\n                )}\n              </button>\n            </div>\n          )}\n        </div>\n\n          {/* 추가 로딩 인디케이터 - 더 많은 대화 로드 시 */}\n          {loading && conversations.length > 0 && (\n            <div className=\"p-4 text-center\">\n              <div className=\"animate-spin rounded-full h-4 w-4 border-b-2 border-blue-300 mx-auto\"></div>\n            </div>\n          )}\n\n          {/* 더 보기 버튼 */}\n          {hasMore && !loading && conversations.length > 0 && !isCollapsed && (\n            <div className=\"p-4 text-center\">\n              <button\n                onClick={loadMore}\n                className=\"text-xs text-white/60 hover:text-white/80 transition-colors duration-200 px-3 py-1.5 hover:bg-gray-800/40 rounded\"\n              >\n                더 보기\n              </button>\n            </div>\n          )}\n      </div>\n    </>\n  );\n};\n\nexport default ConversationDrawer;","import { useState, useEffect, useCallback } from 'react';\nimport { conversationAPI, mockConversations } from '../services/api';\n\n/**\n * 대화 목록 관리를 위한 커스텀 훅\n * 무한 스크롤과 실시간 업데이트 지원\n */\nexport const useConversations = () => {\n  const [conversations, setConversations] = useState([]);\n  const [loading, setLoading] = useState(false);\n  const [error, setError] = useState(null);\n  const [hasMore, setHasMore] = useState(true);\n  const [nextCursor, setNextCursor] = useState(null);\n\n  // 대화 목록 초기 로드\n  const loadConversations = useCallback(async (reset = false) => {\n    if (loading) return;\n    \n    setLoading(true);\n    setError(null);\n\n    try {\n      const cursor = reset ? null : nextCursor;\n      const response = await conversationAPI.getConversations(cursor);\n      \n      if (reset) {\n        setConversations(response.conversations);\n      } else {\n        setConversations(prev => [...prev, ...response.conversations]);\n      }\n      \n      setHasMore(response.hasMore);\n      setNextCursor(response.nextCursor);\n      \n    } catch (err) {\n      console.error('대화 목록 로드 실패:', err);\n      console.error('Error details:', {\n        message: err.message,\n        status: err.response?.status,\n        data: err.response?.data,\n        config: err.config\n      });\n      \n      // 상세한 에러 메시지 제공\n      let errorMessage = '대화 목록을 불러오는데 실패했습니다.';\n      if (err.code === 'ERR_NETWORK') {\n        errorMessage = '네트워크 연결을 확인해주세요.';\n      } else if (err.response?.status === 403) {\n        errorMessage = '접근 권한이 없습니다.';\n      } else if (err.response?.status >= 500) {\n        errorMessage = '서버 오류가 발생했습니다. 잠시 후 다시 시도해주세요.';\n      }\n      \n      setError(errorMessage);\n      \n      // API 실패시 mock 데이터로 fallback\n      if (reset) {\n        console.log('API 실패, mock 데이터 사용');\n        setConversations(mockConversations);\n        setHasMore(false);\n        setNextCursor(null);\n      }\n    } finally {\n      setLoading(false);\n    }\n  }, [loading, nextCursor]);\n\n  // 새 대화 생성\n  const createConversation = useCallback(async (title) => {\n    try {\n      const response = await conversationAPI.createConversation(title);\n      const newConversation = {\n        id: response.conversationId,\n        title: response.title,\n        startedAt: response.startedAt,\n        lastActivityAt: response.lastActivityAt,\n        tokenSum: 0\n      };\n      \n      // 새 대화를 목록 맨 앞에 추가\n      setConversations(prev => [newConversation, ...prev]);\n      \n      return newConversation;\n    } catch (err) {\n      console.error('대화 생성 실패:', err);\n      \n      // API 실패시 mock 데이터로 fallback\n      const mockConversation = {\n        id: Date.now().toString(),\n        title: title || 'New Conversation',\n        startedAt: new Date().toISOString(),\n        lastActivityAt: new Date().toISOString(),\n        tokenSum: 0\n      };\n      \n      setConversations(prev => [mockConversation, ...prev]);\n      return mockConversation;\n    }\n  }, []);\n\n  // 대화 업데이트 (마지막 활동 시간, 제목 등)\n  const updateConversation = useCallback((conversationId, updates) => {\n    setConversations(prev => \n      prev.map(conv => \n        conv.id === conversationId \n          ? { ...conv, ...updates, lastActivityAt: new Date().toISOString() }\n          : conv\n      )\n    );\n  }, []);\n\n  // 대화 삭제\n  const deleteConversation = useCallback(async (conversationId) => {\n    try {\n      // API 호출로 실제 삭제 시도\n      await conversationAPI.deleteConversation(conversationId);\n      console.log('API 삭제 성공:', conversationId);\n    } catch (err) {\n      console.warn('API 삭제 실패, 로컬에서만 삭제:', err);\n      // API 실패 시에도 로컬에서는 삭제 진행\n    }\n    \n    // API 성공/실패 관계없이 UI에서 제거\n    setConversations(prev => prev.filter(conv => conv.id !== conversationId));\n    \n    return true;\n  }, []);\n\n  // 대화 삭제 (UI에서만 제거, 실제 삭제는 별도 구현)\n  const removeConversation = useCallback((conversationId) => {\n    setConversations(prev => prev.filter(conv => conv.id !== conversationId));\n  }, []);\n\n  // 다음 페이지 로드 (무한 스크롤)\n  const loadMore = useCallback(() => {\n    if (hasMore && !loading) {\n      loadConversations(false);\n    }\n  }, [hasMore, loading, loadConversations]);\n\n  // 새로고침\n  const refresh = useCallback(() => {\n    loadConversations(true);\n  }, [loadConversations]);\n\n  // 초기 로드\n  useEffect(() => {\n    loadConversations(true);\n  }, []);\n\n  return {\n    conversations,\n    loading,\n    error,\n    hasMore,\n    loadMore,\n    refresh,\n    createConversation,\n    updateConversation,\n    deleteConversation,\n    removeConversation\n  };\n};","import React, { useState } from \"react\";\nimport { ChevronDownIcon, SparklesIcon } from \"@heroicons/react/24/outline\";\n\nconst MODELS = [\n  // Anthropic Claude 모델들 (추천)\n  {\n    id: \"anthropic.claude-3-5-sonnet-20241022-v2:0\",\n    name: \"Claude 3.5 Sonnet v2\",\n    provider: \"Anthropic\",\n    category: \"premium\",\n    speed: \"빠름\",\n    quality: \"최고\",\n    description: \"텍스트 생성, 다국어 지원, 복잡한 추론에 최적\",\n    recommended: true,\n  },\n  {\n    id: \"anthropic.claude-3-5-haiku-20241022-v1:0\",\n    name: \"Claude 3.5 Haiku\",\n    provider: \"Anthropic\",\n    category: \"fast\",\n    speed: \"매우 빠름\",\n    quality: \"좋음\",\n    description: \"빠른 응답, 텍스트 생성에 최적화\",\n    recommended: true,\n  },\n  {\n    id: \"anthropic.claude-sonnet-4-v1:0\",\n    name: \"Claude Sonnet 4\",\n    provider: \"Anthropic\",\n    category: \"premium\",\n    speed: \"보통\",\n    quality: \"최고\",\n    description: \"최신 모델로 향상된 텍스트 생성, 실시간 지원\",\n    new: true,\n  },\n  {\n    id: \"anthropic.claude-opus-4-v1:0\",\n    name: \"Claude Opus 4\",\n    provider: \"Anthropic\",\n    category: \"premium\",\n    speed: \"느림\",\n    quality: \"최고\",\n    description: \"최고 성능이 필요한 복잡한 제목 생성\",\n    new: true,\n  },\n  {\n    id: \"anthropic.claude-3-opus-20240229-v1:0\",\n    name: \"Claude 3 Opus\",\n    provider: \"Anthropic\",\n    category: \"premium\",\n    speed: \"느림\",\n    quality: \"최고\",\n    description: \"이미지를 텍스트 및 코드로 변환, 복잡한 추론\",\n  },\n  {\n    id: \"anthropic.claude-3-sonnet-20240229-v1:0\",\n    name: \"Claude 3 Sonnet\",\n    provider: \"Anthropic\",\n    category: \"balanced\",\n    speed: \"보통\",\n    quality: \"좋음\",\n    description: \"균형잡힌 성능과 속도\",\n  },\n  {\n    id: \"anthropic.claude-3-haiku-20240307-v1:0\",\n    name: \"Claude 3 Haiku\",\n    provider: \"Anthropic\",\n    category: \"fast\",\n    speed: \"빠름\",\n    quality: \"보통\",\n    description: \"대화, 채팅 최적화\",\n  },\n\n  // Amazon Nova 모델들\n  {\n    id: \"amazon.nova-pro-v1:0\",\n    name: \"Nova Pro\",\n    provider: \"Amazon\",\n    category: \"balanced\",\n    speed: \"빠름\",\n    quality: \"좋음\",\n    description: \"텍스트 생성, 코드 생성, 복잡한 추론\",\n    recommended: true,\n  },\n  {\n    id: \"amazon.nova-lite-v1:0\",\n    name: \"Nova Lite\",\n    provider: \"Amazon\",\n    category: \"fast\",\n    speed: \"매우 빠름\",\n    quality: \"보통\",\n    description: \"가벼운 모델로 빠른 응답, 다국어 지원\",\n  },\n  {\n    id: \"amazon.nova-micro-v1:0\",\n    name: \"Nova Micro\",\n    provider: \"Amazon\",\n    category: \"fast\",\n    speed: \"초고속\",\n    quality: \"기본\",\n    description: \"초경량 모델로 매우 빠른 응답\",\n  },\n\n  // Meta Llama 모델들\n  {\n    id: \"meta.llama3-3-70b-instruct-v1:0\",\n    name: \"Llama 3.3 70B\",\n    provider: \"Meta\",\n    category: \"balanced\",\n    speed: \"보통\",\n    quality: \"좋음\",\n    description: \"툴 사용, 코드 생성, 고급 추론\",\n  },\n  {\n    id: \"meta.llama3-2-3b-instruct-v1:0\",\n    name: \"Llama 3.2 3B\",\n    provider: \"Meta\",\n    category: \"fast\",\n    speed: \"빠름\",\n    quality: \"보통\",\n    description: \"경량 모델로 빠른 처리\",\n  },\n];\n\nconst ModelSelector = ({ selectedModel, onModelChange }) => {\n  const [isOpen, setIsOpen] = useState(false);\n  const [filter, setFilter] = useState(\"all\");\n\n  console.log(\"🤖 ModelSelector 렌더링됨:\", { selectedModel, isOpen });\n\n  const currentModel =\n    MODELS.find((model) => model.id === selectedModel) || MODELS[0];\n\n  const filteredModels = MODELS.filter((model) => {\n    if (filter === \"all\") return true;\n    return model.provider.toLowerCase() === filter;\n  });\n\n  const handleModelSelect = (modelId) => {\n    onModelChange(modelId);\n    setIsOpen(false);\n  };\n\n  return (\n    <div className=\"relative\">\n      {/* 모델 선택 버튼 - 컴팩트 버전 */}\n      <button\n        onClick={() => setIsOpen(!isOpen)}\n        className=\"flex items-center gap-2 px-3 py-1.5 bg-gray-100 dark:bg-gray-800 rounded-lg hover:bg-gray-200 dark:hover:bg-gray-700 border border-gray-300 dark:border-gray-600 shadow-sm transition-all duration-200 text-xs\"\n        title={`${currentModel.name} (${currentModel.provider})`}\n      >\n        <SparklesIcon className=\"h-3.5 w-3.5 text-blue-600 dark:text-blue-400\" />\n        <span className=\"text-gray-700 dark:text-gray-300 font-medium\">\n          {currentModel.name.replace(/Claude |Llama |Nova /, \"\")}\n        </span>\n        <ChevronDownIcon\n          className={`h-3 w-3 text-gray-500 transition-transform ${\n            isOpen ? \"rotate-180\" : \"\"\n          }`}\n        />\n      </button>\n\n      {/* 드롭다운 메뉴 */}\n      {isOpen && (\n        <div className=\"absolute bottom-full left-0 mb-2 bg-white dark:bg-dark-secondary  rounded-lg shadow-lg z-50 max-h-[400px] overflow-hidden min-w-[300px]\">\n          {/* 필터 버튼들 */}\n          <div className=\"p-3 \">\n            <div className=\"flex gap-1 text-xs\">\n              {[\n                { key: \"all\", label: \"전체\" },\n                { key: \"anthropic\", label: \"Anthropic\" },\n                { key: \"amazon\", label: \"Amazon\" },\n                { key: \"meta\", label: \"Meta\" },\n              ].map((filterOption) => (\n                <button\n                  key={filterOption.key}\n                  onClick={() => setFilter(filterOption.key)}\n                  className={`px-2 py-1 rounded transition-colors ${\n                    filter === filterOption.key\n                      ? \"bg-blue-100 text-blue-800 dark:bg-blue-900 dark:text-blue-200\"\n                      : \"text-gray-600 dark:text-gray-400 hover:bg-gray-100 dark:hover:bg-dark-tertiary\"\n                  }`}\n                >\n                  {filterOption.label}\n                </button>\n              ))}\n            </div>\n          </div>\n\n          {/* 모델 목록 */}\n          <div className=\"max-h-[300px] overflow-y-auto\">\n            {filteredModels.map((model) => (\n              <button\n                key={model.id}\n                onClick={() => handleModelSelect(model.id)}\n                className={`w-full p-3 text-left hover:bg-gray-50 dark:hover:bg-gray-700 last:border-b-0 transition-colors ${\n                  model.id === selectedModel\n                    ? \"bg-blue-50 dark:bg-blue-900/20\"\n                    : \"\"\n                }`}\n              >\n                <div className=\"flex-1 min-w-0\">\n                  <div className=\"mb-1\">\n                    <span className=\"font-medium text-gray-900 dark:text-white\">\n                      {model.name}\n                    </span>\n                  </div>\n                  <div className=\"text-xs text-gray-500 dark:text-gray-400 mb-1\">\n                    {model.provider} • 속도: {model.speed} • 품질:{\" \"}\n                    {model.quality}\n                  </div>\n                  <div className=\"text-xs text-gray-600 dark:text-gray-400\">\n                    {model.description}\n                  </div>\n                </div>\n              </button>\n            ))}\n          </div>\n        </div>\n      )}\n\n      {/* 배경 클릭 시 닫기 */}\n      {isOpen && (\n        <div className=\"fixed inset-0 z-40\" onClick={() => setIsOpen(false)} />\n      )}\n    </div>\n  );\n};\n\nexport default ModelSelector;\n","import { toast } from \"react-hot-toast\";\n\n/**\n * 텍스트를 클립보드에 복사하는 유틸리티 함수\n * @param {string} text - 복사할 텍스트\n * @param {string} successMessage - 성공 시 표시할 메시지\n * @param {string} errorMessage - 실패 시 표시할 메시지\n * @returns {Promise<boolean>} - 성공 여부\n */\nexport const copyToClipboard = async (\n  text,\n  successMessage = \"클립보드에 복사되었습니다!\",\n  errorMessage = \"복사에 실패했습니다.\"\n) => {\n  try {\n    await navigator.clipboard.writeText(text);\n    toast.success(successMessage);\n    return true;\n  } catch (error) {\n    console.error(\"복사 실패:\", error);\n    toast.error(errorMessage);\n    return false;\n  }\n};\n\n/**\n * 제목만 추출하여 복사하는 함수\n * @param {string} text - 전체 텍스트\n * @returns {Promise<boolean>} - 성공 여부\n */\nexport const copyTitlesOnly = async (text) => {\n  const extractedTitles = extractTitles(text);\n  const textToCopy =\n    extractedTitles.length > 0 ? extractedTitles.join(\"\\n\") : text;\n  return copyToClipboard(textToCopy, \"제목이 클립보드에 복사되었습니다!\");\n};\n\n/**\n * 텍스트에서 제목을 추출하는 함수\n * @param {string} text - 원본 텍스트\n * @returns {Array<string>} - 추출된 제목 배열\n */\nexport const extractTitles = (text) => {\n  const titles = [];\n\n  // 1. 번호 형식: \"1. [제목]\"\n  const numberedMatches = text.match(/^\\d+\\.\\s+(.+?)(?=\\n\\s*-|$)/gm);\n  if (numberedMatches) {\n    numberedMatches.forEach((match) => {\n      const title = match.replace(/^\\d+\\.\\s+/, \"\").trim();\n      if (title && !title.includes(\"품질 평가\")) {\n        titles.push(title);\n      }\n    });\n  }\n\n  // 2. Bullet 형식: \"• [제목]\"\n  if (titles.length === 0) {\n    const bulletMatches = text.match(/• \"([^\"]+)\"/g);\n    if (bulletMatches) {\n      bulletMatches.forEach((match) => {\n        const title = match.replace(/• \"(.+)\"/, \"$1\").trim();\n        if (title) {\n          titles.push(title);\n        }\n      });\n    }\n  }\n\n  // 3. 일반 Bullet 형식\n  if (titles.length === 0) {\n    const simpleBulletMatches = text.match(/• ([^\\n]+)/g);\n    if (simpleBulletMatches) {\n      simpleBulletMatches.forEach((match) => {\n        const title = match.replace(\"• \", \"\").trim();\n        if (title && !title.includes(\"이유:\") && title.length < 100) {\n          titles.push(title);\n        }\n      });\n    }\n  }\n\n  return titles;\n};\n","import { useState, useEffect, useRef, useCallback } from \"react\";\nimport { toast } from \"react-hot-toast\";\nimport { copyToClipboard } from \"../utils/clipboard\";\nimport { useOrchestration } from \"./useOrchestration\";\nimport { useWebSocket } from \"./useWebSocket\";\nimport { crewAPI, handleAPIError } from \"../services/api\";\nimport { useAuth } from \"../contexts/AuthContext\";\n\n/**\n * 멀티-에이전트 AI 응답을 파싱하고 UI에 맞는 메시지 객체로 변환\n */\nconst processMultiAgentResponse = (result) => {\n  if (!result) {\n    console.error(\"멀티-에이전트 응답 오류: 결과가 없습니다\", result);\n    return {\n      id: \"error-\" + Date.now(),\n      type: \"assistant\",\n      content: \"처리 중 오류가 발생했습니다. 다시 시도해주세요.\",\n      timestamp: new Date().toISOString(),\n      isError: true,\n    };\n  }\n\n  // 멀티-에이전트 결과 구성\n  const agentResults = result.agentResults || {};\n  const finalTitles = result.finalTitles || {};\n  const tokenUsage = result.tokenUsage || 0;\n\n  // 에이전트별 결과를 포맷팅\n  const agentSummary = Object.keys(agentResults).map(agentType => {\n    const agentResult = agentResults[agentType];\n    const titles = finalTitles[agentType] || [];\n    \n    return {\n      agentType,\n      agentName: getAgentName(agentType),\n      result: agentResult?.content || \"결과 없음\",\n      titles: titles,\n      tokenCount: agentResult?.tokenCount || 0\n    };\n  });\n\n  // 전체 제목 목록 생성\n  const allTitles = Object.values(finalTitles).flat();\n\n  return {\n    id: \"multi-agent-\" + Date.now(),\n    type: \"assistant\",\n    content: formatMultiAgentContent(agentSummary, allTitles),\n    timestamp: new Date(),\n    // 멀티-에이전트 특화 데이터\n    isMultiAgent: true,\n    agentResults: agentSummary,\n    allTitles: allTitles,\n    tokenUsage: tokenUsage,\n  };\n};\n\n/**\n * 에이전트 타입을 한국어 이름으로 변환\n */\nconst getAgentName = (agentType) => {\n  const agentNames = {\n    journalism: \"📰 저널리즘 충실형\",\n    balanced: \"⚖️ 균형잡힌 후킹형\", \n    click: \"🎯 클릭유도형\",\n    seo: \"🔍 SEO/AEO 최적화형\",\n    social: \"📱 소셜미디어 공유형\"\n  };\n  return agentNames[agentType] || `🤖 ${agentType}`;\n};\n\n/**\n * 멀티-에이전트 결과를 UI 표시용 텍스트로 포맷팅\n */\nconst formatMultiAgentContent = (agentSummary, allTitles) => {\n  let content = \"🚀 **멀티-에이전트 분석 완료**\\n\\n\";\n  \n  // 전체 제목 요약\n  if (allTitles.length > 0) {\n    content += \"📋 **생성된 제목 목록:**\\n\";\n    allTitles.forEach((title, index) => {\n      content += `${index + 1}. ${title}\\n`;\n    });\n    content += \"\\n\";\n  }\n\n  // 에이전트별 상세 결과\n  content += \"🔍 **에이전트별 분석 결과:**\\n\\n\";\n  agentSummary.forEach(agent => {\n    content += `### ${agent.agentName}\\n`;\n    if (agent.titles.length > 0) {\n      content += \"**생성 제목:**\\n\";\n      agent.titles.forEach(title => {\n        content += `• ${title}\\n`;\n      });\n    }\n    content += `**토큰 사용량:** ${agent.tokenCount}개\\n\\n`;\n  });\n\n  return content;\n};\n\n/**\n * 채팅 기능을 위한 커스텀 훅\n * @param {string} projectId - 프로젝트 ID\n * @param {string} projectName - 프로젝트 이름\n * @param {Array} promptCards - 프롬프트 카드 배열\n * @returns {Object} - 채팅 관련 상태와 함수들\n */\nexport const useChat = (projectId, projectName, promptCards = [], conversationId = null) => {\n  const { user } = useAuth(); // Add user from AuthContext\n  \n  // 디버깅 로그 (첫 번째 렌더링에만)\n  const isFirstRender = useRef(true);\n  if (isFirstRender.current) {\n    console.log('useChat 초기화:', {\n      projectId,\n      projectName,\n      promptCardsLength: promptCards?.length,\n      conversationId,\n      userId: user?.id\n    });\n    isFirstRender.current = false;\n  }\n  const [messages, setMessages] = useState([]);\n  const [inputValue, setInputValue] = useState(\"\");\n  const [copiedMessage, setCopiedMessage] = useState(null);\n  const [canSendMessage, setCanSendMessage] = useState(true);\n  const [inputHeight, setInputHeight] = useState(24); // 동적 높이 관리\n  const [selectedModel, setSelectedModel] = useState(\"anthropic.claude-3-5-sonnet-20241022-v2:0\");\n  const streamingMessageIdRef = useRef(null);\n  const currentWebSocketRef = useRef(null);\n  const currentExecutionIdRef = useRef(null);\n  \n\n  const messagesEndRef = useRef(null);\n  const inputRef = useRef(null);\n\n  // 사용자 스크롤 상태 추적\n  const [isUserScrolling, setIsUserScrolling] = useState(false);\n  const scrollContainerRef = useRef(null);\n  const lastScrollTopRef = useRef(0);\n\n  const {\n    isExecuting: isGenerating,\n    isStreaming,\n    executeOrchestration,\n    resetOrchestration,\n  } = useOrchestration(projectId);\n\n  // WebSocket 훅 추가\n  const {\n    isConnected: wsConnected,\n    isConnecting: wsConnecting,\n    error: wsError,\n    startStreaming: wsStartStreaming,\n    addMessageListener,\n    removeMessageListener,\n  } = useWebSocket(projectId);\n\n  // 초기 메시지 설정 - projectId 변경시에만 초기화\n  useEffect(() => {\n    setMessages([]); // 빈 배열로 시작\n  }, [projectId]); // projectName 대신 projectId 사용\n\n  // 사용자 스크롤 감지 함수\n  const handleScroll = useCallback(() => {\n    if (!scrollContainerRef.current) return;\n\n    const container = scrollContainerRef.current;\n    const currentScrollTop = container.scrollTop;\n    const maxScrollTop = container.scrollHeight - container.clientHeight;\n\n    // 사용자가 수동으로 스크롤했는지 감지\n    if (Math.abs(currentScrollTop - lastScrollTopRef.current) > 2) {\n      const isAtBottom = currentScrollTop >= maxScrollTop - 20;\n\n      // 하단에 있을 때만 자동 스크롤 허용, 그 외는 사용자 스크롤 모드\n      setIsUserScrolling(!isAtBottom);\n    }\n\n    lastScrollTopRef.current = currentScrollTop;\n  }, []);\n\n  const scrollToBottom = useCallback(() => {\n    // 사용자가 스크롤 중이 아닐 때만 자동 스크롤\n    if (!isUserScrolling && messagesEndRef.current) {\n      messagesEndRef.current.scrollIntoView({ behavior: \"smooth\" });\n    }\n  }, [isUserScrolling]);\n\n  // 메시지 추가 시 스크롤 하단으로 (사용자 스크롤 중이 아닐 때만)\n  useEffect(() => {\n    scrollToBottom();\n  }, [messages, scrollToBottom]);\n\n  // WebSocket 메시지 리스너 설정\n  useEffect(() => {\n    const handleWebSocketMessage = (event) => {\n      try {\n        const data = JSON.parse(event.data);\n        console.log(\"WebSocket 메시지 수신:\", data);\n\n        const currentStreamingId = streamingMessageIdRef.current;\n\n        switch (data.type) {\n          case \"stream_start\":\n            console.log(\"WebSocket 스트리밍 시작\");\n            break;\n\n          case \"progress\":\n            // 진행 상황 로그만 남기고 UI 업데이트는 제거\n            console.log(`진행 상황: ${data.step} (${data.progress}%)`);\n            break;\n\n          case \"stream_chunk\":\n            if (currentStreamingId) {\n              setMessages((prev) => {\n                const updatedMessages = [...prev];\n                const streamingMsgIndex = updatedMessages.findIndex(\n                  (msg) => msg.id === currentStreamingId\n                );\n\n                console.log(\"스트림 청크 처리:\", {\n                  currentStreamingId,\n                  streamingMsgIndex,\n                  messagesLength: prev.length,\n                  content: data.content\n                });\n\n                if (streamingMsgIndex !== -1) {\n                  // 기존 내용에 새 청크 추가\n                  const currentContent =\n                    updatedMessages[streamingMsgIndex].content || \"\";\n\n                  updatedMessages[streamingMsgIndex] = {\n                    ...updatedMessages[streamingMsgIndex],\n                    content: currentContent + data.content,\n                    isLoading: true,\n                    isStreaming: true,\n                  };\n                  \n                  console.log(\"메시지 업데이트됨:\", updatedMessages[streamingMsgIndex]);\n                } else {\n                  console.log(\"스트리밍 메시지를 찾을 수 없음, 메시지 ID들:\", prev.map(m => m.id));\n                }\n\n                return updatedMessages;\n              });\n              // 스트리밍 중에는 사용자가 스크롤 중이 아닐 때만 자동 스크롤\n              if (!isUserScrolling) {\n                scrollToBottom();\n              }\n            } else {\n              console.log(\"currentStreamingId가 null임\");\n            }\n            break;\n\n          case \"stream_complete\":\n            if (currentStreamingId) {\n              setMessages((prev) => {\n                const updatedMessages = [...prev];\n                const streamingMsgIndex = updatedMessages.findIndex(\n                  (msg) => msg.id === currentStreamingId\n                );\n\n                if (streamingMsgIndex !== -1) {\n                  updatedMessages[streamingMsgIndex] = {\n                    ...updatedMessages[streamingMsgIndex],\n                    content: data.fullContent,\n                    isLoading: false,\n                    isStreaming: false,\n                    timestamp: new Date().toISOString(),\n                  };\n                }\n\n                return updatedMessages;\n              });\n              streamingMessageIdRef.current = null;\n              scrollToBottom();\n            }\n            break;\n\n          case \"error\":\n            console.error(\"WebSocket 스트리밍 오류:\", data.message);\n            if (currentStreamingId) {\n              setMessages((prev) => {\n                const updatedMessages = [...prev];\n                const streamingMsgIndex = updatedMessages.findIndex(\n                  (msg) => msg.id === currentStreamingId\n                );\n\n                if (streamingMsgIndex !== -1) {\n                  // 오류 유형에 따른 사용자 메시지 결정\n                  let errorContent = \"메시지 처리 중 오류가 발생했습니다. 다시 시도해주세요.\";\n                  \n                  if (data.message?.includes(\"401\") || data.message?.includes(\"Unauthorized\")) {\n                    errorContent = \"인증이 만료되었습니다. 다시 로그인해주세요.\";\n                  } else if (data.message?.includes(\"timeout\") || data.message?.includes(\"시간 초과\")) {\n                    errorContent = \"처리 시간이 초과되었습니다. 요청을 단순화하거나 잠시 후 다시 시도해주세요.\";\n                  } else if (data.message?.includes(\"rate limit\") || data.message?.includes(\"제한\")) {\n                    errorContent = \"요청 한도에 도달했습니다. 잠시 후 다시 시도해주세요.\";\n                  }\n\n                  updatedMessages[streamingMsgIndex] = {\n                    ...updatedMessages[streamingMsgIndex],\n                    content: errorContent,\n                    isLoading: false,\n                    isStreaming: false,\n                    isError: true,\n                    timestamp: new Date().toISOString(),\n                  };\n                }\n\n                return updatedMessages;\n              });\n              streamingMessageIdRef.current = null;\n            }\n            \n            // 사용자 친화적인 토스트 메시지\n            const toastMessage = data.message?.includes(\"401\") \n              ? \"인증이 만료되었습니다\" \n              : \"처리 중 오류가 발생했습니다\";\n            toast.error(toastMessage);\n            break;\n\n          default:\n            console.log(\"알 수 없는 WebSocket 메시지 타입:\", data.type);\n        }\n      } catch (error) {\n        console.error(\"WebSocket 메시지 파싱 오류:\", error);\n      }\n    };\n\n    if (wsConnected) {\n      addMessageListener(handleWebSocketMessage);\n    }\n\n    return () => {\n      if (wsConnected) {\n        removeMessageListener(handleWebSocketMessage);\n      }\n    };\n  }, [wsConnected, addMessageListener, removeMessageListener, scrollToBottom]);\n\n  /**\n   * 스트리밍 응답 처리 함수\n   */\n  const handleStreamingResponse = useCallback(\n    (chunk, metadata) => {\n      const currentStreamingId = streamingMessageIdRef.current;\n\n      console.log(\"청크 수신:\", chunk, \"스트리밍 ID:\", currentStreamingId);\n\n      if (!currentStreamingId) {\n        console.error(\"스트리밍 ID가 없습니다!\");\n        return;\n      }\n\n      setMessages((prev) => {\n        const updatedMessages = [...prev];\n        const streamingMsgIndex = updatedMessages.findIndex(\n          (msg) => msg.id === currentStreamingId\n        );\n\n        if (streamingMsgIndex !== -1) {\n          // 기존 스트리밍 메시지 업데이트\n          updatedMessages[streamingMsgIndex] = {\n            ...updatedMessages[streamingMsgIndex],\n            content: updatedMessages[streamingMsgIndex].content + chunk,\n            isLoading: true,\n            isStreaming: true,\n          };\n          console.log(\n            \"스트리밍 메시지 업데이트 성공:\",\n            updatedMessages[streamingMsgIndex].content\n          );\n        } else {\n          console.error(\"스트리밍 메시지를 찾을 수 없음:\", currentStreamingId);\n        }\n\n        return updatedMessages;\n      });\n\n      // 스크롤 조정 (사용자가 스크롤 중이 아닐 때만)\n      if (!isUserScrolling) {\n        scrollToBottom();\n      }\n    },\n    [scrollToBottom, isUserScrolling]\n  );\n\n  /**\n   * 스트리밍 완료 처리 함수\n   */\n  const handleStreamingComplete = useCallback(\n    (result) => {\n      const currentStreamingId = streamingMessageIdRef.current;\n\n      console.log(\"스트리밍 완료:\", result, \"스트리밍 ID:\", currentStreamingId);\n\n      if (!currentStreamingId) {\n        console.error(\"스트리밍 완료 처리 중 ID가 없습니다!\");\n        return;\n      }\n\n      setMessages((prev) => {\n        const updatedMessages = [...prev];\n        const streamingMsgIndex = updatedMessages.findIndex(\n          (msg) => msg.id === currentStreamingId\n        );\n\n        if (streamingMsgIndex !== -1) {\n          // 스트리밍 메시지 완료 처리\n          updatedMessages[streamingMsgIndex] = {\n            ...updatedMessages[streamingMsgIndex],\n            content: result.result,\n            isLoading: false,\n            isStreaming: false,\n            performance_metrics: result.performance_metrics,\n            model_info: result.model_info,\n            timestamp: new Date().toISOString(),\n          };\n          console.log(\n            \"스트리밍 완료 처리 성공:\",\n            updatedMessages[streamingMsgIndex].content\n          );\n        } else {\n          console.error(\n            \"스트리밍 완료 처리 중 메시지를 찾을 수 없음:\",\n            currentStreamingId\n          );\n        }\n\n        return updatedMessages;\n      });\n\n      // 스트리밍 ID 초기화\n      streamingMessageIdRef.current = null;\n\n      // 입력 활성화\n      console.log(\"WebSocket 스트리밍 완료 - 입력 활성화\");\n      setCanSendMessage(true);\n\n      // 스크롤 조정 (스트리밍 완료 시에는 항상 하단으로)\n      scrollToBottom();\n    },\n    [scrollToBottom]\n  );\n\n  /**\n   * 스트리밍 중단 함수\n   */\n  const handleStopGeneration = useCallback(() => {\n    console.log(\"생성 중단 요청\");\n\n    // WebSocket 연결 종료\n    if (currentWebSocketRef.current) {\n      currentWebSocketRef.current.close();\n      currentWebSocketRef.current = null;\n    }\n\n    // 현재 실행 중인 작업 중단\n    if (currentExecutionIdRef.current) {\n      // 여기서 실제 API 호출 중단 로직을 추가할 수 있습니다\n      currentExecutionIdRef.current = null;\n    }\n\n    // 스트리밍 메시지 상태 업데이트\n    const currentStreamingId = streamingMessageIdRef.current;\n    if (currentStreamingId) {\n      setMessages((prev) => {\n        const updatedMessages = [...prev];\n        const streamingMsgIndex = updatedMessages.findIndex(\n          (msg) => msg.id === currentStreamingId\n        );\n\n        if (streamingMsgIndex !== -1) {\n          updatedMessages[streamingMsgIndex] = {\n            ...updatedMessages[streamingMsgIndex],\n            content:\n              updatedMessages[streamingMsgIndex].content +\n              \"\\n\\n[생성이 중단되었습니다]\",\n            isLoading: false,\n            isStreaming: false,\n            timestamp: new Date().toISOString(),\n          };\n        }\n\n        return updatedMessages;\n      });\n\n      streamingMessageIdRef.current = null;\n    }\n\n    // 입력 가능 상태로 복원\n    setCanSendMessage(true);\n\n    // orchestration 상태 리셋\n    resetOrchestration();\n\n    toast.success(\"생성이 중단되었습니다\");\n  }, [resetOrchestration]);\n\n  /**\n   * 입력창 높이 자동 조절\n   */\n  const adjustInputHeight = useCallback((value) => {\n    if (!value.trim()) {\n      setInputHeight(24); // 기본 높이\n      return;\n    }\n    \n    // 줄 수 계산 (대략적)\n    const lines = value.split('\\n').length;\n    const charBasedLines = Math.ceil(value.length / 80); // 80자당 1줄로 추정\n    const estimatedLines = Math.max(lines, charBasedLines);\n    \n    // 높이 계산 (lineHeight: 1.4, fontSize: 16px)\n    let calculatedHeight;\n    if (estimatedLines <= 3) {\n      calculatedHeight = 24 + (estimatedLines - 1) * 22; // 기본 + 추가 줄\n    } else if (estimatedLines <= 10) {\n      calculatedHeight = 150 + (estimatedLines - 6) * 15; // 중간 범위\n    } else {\n      calculatedHeight = Math.min(400, 150 + (estimatedLines - 6) * 12); // 최대 400px\n    }\n    \n    setInputHeight(Math.max(24, calculatedHeight));\n  }, []);\n  \n  /**\n   * 입력값 변경 처리\n   */\n  const handleInputChange = useCallback((value) => {\n    setInputValue(value);\n    adjustInputHeight(value);\n  }, [adjustInputHeight]);\n\n  /**\n   * 메시지 전송\n   */\n  const handleSendMessage = useCallback(async () => {\n    console.log(\"해들 전송 호출:\", {\n      inputValue: inputValue.trim(),\n      isGenerating,\n      canSendMessage,\n    });\n\n    if (!inputValue.trim() || isGenerating) {\n      console.log(\"전송 중단: 조건 부족\");\n      return;\n    }\n\n    // 입력 비활성화\n    console.log(\"입력 비활성화\");\n    setCanSendMessage(false);\n\n    const userMessage = {\n      id: \"user-\" + Date.now(),\n      type: \"user\",\n      content: inputValue.trim(),\n      timestamp: new Date().toISOString(),\n    };\n\n    // 스트리밍 메시지 ID 생성\n    const streamMsgId = \"streaming-\" + Date.now();\n    streamingMessageIdRef.current = streamMsgId;\n\n    console.log(\"새 스트리밍 메시지 ID 생성:\", streamMsgId);\n\n    // 스트리밍 응답을 위한 초기 메시지\n    const streamingMessage = {\n      id: streamMsgId,\n      type: \"assistant\",\n      content: \"\",\n      timestamp: new Date().toISOString(),\n      isLoading: true,\n      isStreaming: true,\n    };\n\n    setMessages((prev) => [...prev, userMessage, streamingMessage]);\n    setInputValue(\"\");\n    setInputHeight(24); // 입력창 높이 초기화\n\n    // 기존 메시지 + 현재 사용자 메시지를 포함한 대화 히스토리 생성\n    const allMessages = [...messages, userMessage];\n    const chatHistory = allMessages\n      .filter((msg) => !msg.isLoading && !msg.isError && !msg.isStreaming)\n      .map((msg) => ({\n        role: msg.type === \"user\" ? \"user\" : \"assistant\",\n        content: msg.content,\n      }));\n\n    // 최대 대화 기억 설정 (최근 50개 메시지로 최대 메모리 유지)\n    const maxHistoryLength = 50;\n    const trimmedChatHistory = chatHistory.slice(-maxHistoryLength);\n\n    console.log(\"대화 히스토리 생성:\", {\n      totalMessages: allMessages.length,\n      fullHistoryLength: chatHistory.length,\n      trimmedHistoryLength: trimmedChatHistory.length,\n      maxHistoryLength: maxHistoryLength,\n      recentHistory: trimmedChatHistory.slice(-6), // 최근 6개만 로그에 표시\n    });\n\n    try {\n      // 프롬프트 카드 정보 추가 - 활성화된 카드만 필터링하고 백엔드 형식에 맞게 변환\n      const safePromptCards = Array.isArray(promptCards) ? promptCards : [];\n      const activePromptCards = safePromptCards\n        .filter((card) => card.isActive !== false && card.enabled !== false)\n        .map((card) => ({\n          promptId: card.promptId || card.prompt_id,\n          title: card.title || \"Untitled\",\n          prompt_text: card.prompt_text || card.content || \"\",\n          tags: card.tags || [],\n          isActive: card.isActive !== false,\n          stepOrder: card.stepOrder || 0,\n        }))\n        .filter((card) => card.prompt_text.trim()) // 프롬프트 내용이 있는 것만\n        .sort((a, b) => (a.stepOrder || 0) - (b.stepOrder || 0)); // stepOrder로 정렬\n\n      console.log(\"대화 전송 데이터 확인:\", {\n        messageContent: userMessage.content,\n        chatHistoryLength: trimmedChatHistory.length,\n        promptCardsCount: activePromptCards.length,\n        chatHistory: trimmedChatHistory,\n        promptCards: activePromptCards.map((card) => ({\n          id: card.promptId,\n          title: card.title,\n          contentLength: card.prompt_text.length,\n          stepOrder: card.stepOrder,\n          hasContent: !!card.prompt_text.trim(),\n        })),\n      });\n\n      // WebSocket 연결 확인 및 실시간 스트리밍 시도\n      if (wsConnected) {\n        console.log(\"WebSocket을 통한 실시간 스트리밍 시작\");\n        console.log(\"스트리밍 매개변수 확인:\", {\n          projectId,\n          userInput: userMessage.content,\n          conversationId,\n          userSub: user?.id,\n          historyLength: trimmedChatHistory.length,\n          promptCardsLength: activePromptCards.length\n        });\n\n        const success = wsStartStreaming(\n          userMessage.content,\n          trimmedChatHistory,\n          activePromptCards,\n          selectedModel,\n          conversationId, // Add conversationId\n          user?.id // Add userSub from AuthContext\n        );\n\n        if (success) {\n          // WebSocket 스트리밍 성공, 나머지는 리스너에서 처리\n          return;\n        } else {\n          console.log(\"WebSocket 전송 실패, SSE 폴백 모드로 전환\");\n        }\n      } else {\n        console.log(\"WebSocket 미연결, SSE 모드 사용\");\n      }\n\n      // 🌟 멀티-에이전트 시스템 실행\n      console.log(\"멀티-에이전트 시스템 실행 시작\");\n\n      // 1. 먼저 프롬프트 카드들을 crew 인스턴스로 생성\n      if (activePromptCards.length > 0) {\n        try {\n          console.log(\"프롬프트 카드 → 크루 인스턴스 변환 시도\");\n          await crewAPI.createCrewInstance(projectId, activePromptCards);\n          console.log(\"크루 인스턴스 생성 완료\");\n        } catch (instanceError) {\n          console.log(\"크루 인스턴스 생성 실패:\", instanceError.message);\n          \n          // 401 인증 오류인 경우 처리 중단\n          if (instanceError.response?.status === 401) {\n            const { shouldRedirect } = await handleAPIError(instanceError);\n            if (shouldRedirect) {\n              return;\n            }\n          }\n          \n          // 다른 오류는 로그만 남기고 계속 진행 (이미 존재하는 경우 등)\n          console.log(\"크루 인스턴스 관련 오류이지만 계속 진행합니다\");\n        }\n      }\n\n      // 2. 멀티-에이전트 병렬 실행\n      const multiAgentResult = await crewAPI.executeMultiAgent(\n        projectId, \n        userMessage.content,\n        (progress) => {\n          // 진행상황 업데이트 (옵션)\n          console.log(\"멀티-에이전트 진행상황:\", progress);\n        }\n      );\n\n      console.log(\"멀티-에이전트 실행 완료:\", multiAgentResult);\n\n      // 3. 결과를 UI 메시지로 변환\n      const assistantMessage = processMultiAgentResponse(multiAgentResult);\n      \n      // 4. 스트리밍 메시지를 최종 결과로 교체\n      setMessages((prev) => {\n        const updatedMessages = [...prev];\n        const streamingMsgIndex = updatedMessages.findIndex(\n          (msg) => msg.id === streamingMessageIdRef.current\n        );\n\n        if (streamingMsgIndex !== -1) {\n          updatedMessages[streamingMsgIndex] = assistantMessage;\n        } else {\n          updatedMessages.push(assistantMessage);\n        }\n\n        return updatedMessages;\n      });\n\n      streamingMessageIdRef.current = null;\n      setCanSendMessage(true);\n      \n      // 성공 토스트\n      toast.success(`${Object.keys(multiAgentResult.agentResults || {}).length}개 에이전트 분석 완료!`);\n    } catch (error) {\n      console.error(\"메시지 전송 실패:\", error);\n\n      // API 오류 처리 위임\n      const { userMessage: errorUserMessage, shouldRedirect } = await handleAPIError(error);\n\n      // 인증 오류로 리다이렉트가 필요한 경우\n      if (shouldRedirect) {\n        return;\n      }\n\n      const errorMessage = {\n        id: \"error-\" + Date.now(),\n        type: \"assistant\",\n        content: errorUserMessage,\n        timestamp: new Date().toISOString(),\n        isError: true,\n        errorDetails: {\n          message: error.message,\n          status: error.response?.status,\n          code: error.code,\n        },\n      };\n\n      setMessages((prev) => {\n        // 스트리밍 메시지를 찾아 제거\n        const currentStreamingId = streamingMessageIdRef.current;\n        const filteredMessages = prev.filter(\n          (msg) => msg.id !== currentStreamingId\n        );\n        return [...filteredMessages, errorMessage];\n      });\n\n      streamingMessageIdRef.current = null;\n\n      // 오류 발생 시도 입력 활성화\n      setCanSendMessage(true);\n    }\n\n    // 전체 전송 과정 완료 후 입력 활성화 (보험용)\n    setCanSendMessage(true);\n  }, [\n    inputValue,\n    isGenerating,\n    executeOrchestration,\n    handleStreamingResponse,\n    handleStreamingComplete,\n    messages,\n  ]);\n\n  /**\n   * Enter 키로 전송\n   */\n  const handleKeyPress = useCallback(\n    (e) => {\n      if (e.key === \"Enter\" && !e.shiftKey) {\n        e.preventDefault();\n        handleSendMessage();\n      }\n    },\n    [handleSendMessage]\n  );\n\n  /**\n   * 메시지 복사\n   */\n  const handleCopyMessage = useCallback(async (content, messageId) => {\n    const success = await copyToClipboard(content);\n    if (success) {\n      setCopiedMessage(messageId);\n      setTimeout(() => setCopiedMessage(null), 2000);\n    }\n  }, []);\n\n  /**\n   * 개별 제목 복사\n   */\n  const handleCopyTitle = useCallback(async (title, messageId, index) => {\n    const success = await copyToClipboard(title, \"복사되었습니다!\");\n    if (success) {\n      setCopiedMessage(`${messageId}_title_${index}`);\n      setTimeout(() => setCopiedMessage(null), 2000);\n    }\n  }, []);\n\n  /**\n   * 채팅 초기화\n   */\n  const resetChat = useCallback(() => {\n    setMessages([]);\n    setInputValue(\"\");\n    setCopiedMessage(null);\n    setCanSendMessage(true);\n    streamingMessageIdRef.current = null;\n    currentWebSocketRef.current = null;\n    currentExecutionIdRef.current = null;\n    resetOrchestration();\n  }, [resetOrchestration]);\n\n  return {\n    messages,\n    inputValue,\n    setInputValue,\n    handleInputChange, // 새로운 입력 핸들러\n    copiedMessage,\n    isGenerating,\n    isStreaming,\n    canSendMessage,\n    streamingMessageId: streamingMessageIdRef.current,\n    messagesEndRef,\n    inputRef,\n    inputHeight, // 동적 높이\n    handleSendMessage,\n    handleStopGeneration,\n    handleKeyPress,\n    handleCopyMessage,\n    handleCopyTitle,\n    resetChat,\n    scrollToBottom,\n    // WebSocket 상태 추가\n    wsConnected,\n    wsConnecting,\n    wsError,\n    // 스크롤 관련 추가\n    scrollContainerRef,\n    handleScroll,\n    isUserScrolling,\n    // 모델 선택 관련 추가\n    selectedModel,\n    setSelectedModel,\n  };\n};\n","import { useState, useCallback } from \"react\";\nimport { toast } from \"react-hot-toast\";\nimport { generateAPI } from \"../services/api\";\n\n/**\n * 제목 생성 실행 및 결과 폴링을 위한 커스텀 훅\n * @param {string} projectId - 프로젝트 ID\n * @returns {Object} - 제목 생성 관련 상태와 함수들\n */\nexport const useOrchestration = (projectId) => {\n  const [isExecuting, setIsExecuting] = useState(false);\n  const [currentExecution, setCurrentExecution] = useState(null);\n  const [executionStatus, setExecutionStatus] = useState(null);\n  const [isStreaming, setIsStreaming] = useState(false);\n\n  /**\n   * 제목 생성 실행\n   * @param {string} userInput - 사용자 입력\n   * @param {Object} options - 추가 옵션 (예: chat_history, useStreaming)\n   * @returns {Promise<Object>} - 생성 결과\n   */\n  const executeOrchestration = useCallback(\n    async (userInput, options = {}) => {\n      if (!userInput.trim()) {\n        toast.error(\"메시지를 입력해주세요.\");\n        return null;\n      }\n\n      try {\n        setIsExecuting(true);\n        setExecutionStatus(\"STARTING\");\n\n        // chat_history, prompt_cards, userInput, modelId를 포함하는 data 객체 생성\n        const data = {\n          userInput: userInput,\n          chat_history: options.chat_history || [],\n          prompt_cards: options.prompt_cards || [],\n          modelId: options.modelId || null,\n        };\n\n        console.log(\"🚀 대화 생성 요청 시작:\", {\n          projectId,\n          inputLength: userInput.length,\n          historyLength: data.chat_history.length,\n          promptCardsCount: data.prompt_cards.length,\n          useStreaming: options.useStreaming === true,\n          modelId: data.modelId,\n          timestamp: new Date().toISOString(),\n        });\n\n        // 🔧 스트리밍 사용 여부 확인 - 더 안전한 로직\n        if (options.useStreaming === true) {\n          setIsStreaming(true);\n\n          // 스트리밍 콜백 함수 설정\n          const onChunk = options.onChunk || (() => {});\n          const onError = (error) => {\n            console.error(\"🔧 스트리밍 오류 처리:\", error);\n            setIsExecuting(false);\n            setIsStreaming(false);\n            setExecutionStatus(\"FAILED\");\n\n            // 🔧 개선: 오류 타입에 따른 적절한 메시지\n            if (\n              error.message?.includes(\"Gateway Timeout\") ||\n              error.message?.includes(\"504\") ||\n              error.code === \"ECONNABORTED\"\n            ) {\n              toast.error(\n                \"서버 응답 시간이 초과되었습니다. 요청을 간단히 하거나 잠시 후 다시 시도해주세요.\"\n              );\n            } else if (\n              error.message?.includes(\"CORS\") ||\n              error.message?.includes(\"Network Error\")\n            ) {\n              toast.error(\n                \"서버 연결에 문제가 있습니다. 새로고침 후 다시 시도해주세요.\"\n              );\n            } else {\n              toast.error(\n                \"처리 중 오류가 발생했습니다. 잠시 후 다시 시도해주세요.\"\n              );\n            }\n\n            if (options.onError) options.onError(error);\n          };\n\n          const onComplete = (response) => {\n            console.log(\"✅ 스트리밍 완료:\", {\n              resultLength: response.result?.length || 0,\n              timestamp: new Date().toISOString(),\n            });\n            setIsExecuting(false);\n            setIsStreaming(false);\n            setExecutionStatus(\"COMPLETED\");\n            if (options.onComplete) options.onComplete(response);\n          };\n\n          try {\n            // 🔧 개선: 스트리밍 API 호출 (내부에서 폴백 처리됨)\n            return await generateAPI.generateTitleStream(\n              projectId,\n              data,\n              onChunk,\n              onError,\n              onComplete\n            );\n          } catch (streamError) {\n            console.error(\"🔧 스트리밍 최종 실패:\", streamError);\n\n            // 🔧 스트리밍 완전 실패 시에도 폴백이 내부에서 처리되므로\n            // 여기서는 사용자에게 알림만\n            setIsStreaming(false);\n            setIsExecuting(false);\n            setExecutionStatus(\"FAILED\");\n\n            // 최종 실패 메시지\n            toast.error(\n              \"서비스에 일시적인 문제가 있습니다. 잠시 후 다시 시도해주세요.\"\n            );\n            throw streamError;\n          }\n        }\n\n        // 🔧 일반 API 호출 (스트리밍 미사용)\n        console.log(\"📄 일반 API 호출 시작...\");\n        const response = await generateAPI.generateTitle(projectId, data);\n\n        console.log(\"✅ 대화 생성 완료:\", {\n          mode: response.mode,\n          message: response.message,\n          timestamp: new Date().toISOString(),\n        });\n\n        setIsExecuting(false);\n        setExecutionStatus(\"COMPLETED\");\n\n        return response;\n      } catch (error) {\n        console.error(\"❌ 제목 생성 실패:\", {\n          error: error.message,\n          code: error.code,\n          status: error.response?.status,\n          timestamp: new Date().toISOString(),\n        });\n\n        setIsExecuting(false);\n        setIsStreaming(false);\n        setExecutionStatus(\"FAILED\");\n\n        // 🔧 개선: 상세한 오류 처리\n        if (error.response?.status === 504) {\n          toast.error(\n            \"서버 응답 시간이 초과되었습니다. 입력을 간소화하거나 잠시 후 다시 시도해주세요.\"\n          );\n        } else if (\n          error.message?.includes(\"CORS\") ||\n          error.code === \"ERR_NETWORK\"\n        ) {\n          toast.error(\n            \"서버 연결에 문제가 있습니다. 페이지를 새로고침하고 다시 시도해주세요.\"\n          );\n        } else if (\n          error.response?.status === 400 &&\n          error.response?.data?.setup_required\n        ) {\n          toast.error(\"프롬프트 카드를 먼저 설정해주세요!\");\n        } else if (error.code === \"ECONNABORTED\") {\n          toast.error(\n            \"요청 처리 시간이 초과되었습니다. 입력을 줄이거나 잠시 후 다시 시도해주세요.\"\n          );\n        } else if (error.response?.status === 500) {\n          toast.error(\n            \"서버에 일시적인 문제가 있습니다. 잠시 후 다시 시도해주세요.\"\n          );\n        } else if (error.response?.status === 403) {\n          toast.error(\"권한이 없습니다. 로그인 상태를 확인해주세요.\");\n        } else if (error.response?.status === 429) {\n          toast.error(\"요청이 너무 많습니다. 잠시 후 다시 시도해주세요.\");\n        } else {\n          toast.error(\n            \"처리 중 오류가 발생했습니다. 네트워크 연결을 확인하고 다시 시도해주세요.\"\n          );\n        }\n\n        throw error;\n      }\n    },\n    [projectId]\n  );\n\n  /**\n   * 실행 상태 조회 (Step Functions 사용 시)\n   * @param {string} executionArn - 실행 ARN\n   * @param {Function} onComplete - 완료 시 콜백\n   * @param {Function} onError - 에러 시 콜백\n   */\n  const pollOrchestrationResult = useCallback(\n    async (executionArn, onComplete, onError) => {\n      // 스트리밍 모드에서는 폴링이 필요 없음\n      if (isStreaming) {\n        return;\n      }\n\n      const poll = async () => {\n        try {\n          const result = await generateAPI.getExecutionStatus(executionArn);\n\n          setExecutionStatus(result.status);\n\n          if (result.status === \"SUCCEEDED\") {\n            setIsExecuting(false);\n            setExecutionStatus(\"COMPLETED\");\n\n            if (onComplete) {\n              onComplete(result);\n            }\n          } else if (result.status === \"FAILED\") {\n            setIsExecuting(false);\n            setExecutionStatus(\"FAILED\");\n\n            if (onError) {\n              onError(new Error(\"처리 실패\"));\n            }\n          } else if (result.status === \"RUNNING\") {\n            // 3초 후 다시 폴링\n            setTimeout(poll, 3000);\n          }\n        } catch (error) {\n          console.error(\"실행 상태 조회 실패:\", error);\n          setIsExecuting(false);\n          setExecutionStatus(\"FAILED\");\n\n          if (onError) {\n            onError(error);\n          }\n        }\n      };\n\n      poll();\n    },\n    [projectId, isStreaming]\n  );\n\n  /**\n   * 오케스트레이션 상태 초기화\n   */\n  const resetOrchestration = useCallback(() => {\n    setIsExecuting(false);\n    setIsStreaming(false);\n    setCurrentExecution(null);\n    setExecutionStatus(null);\n  }, []);\n\n  return {\n    isExecuting,\n    isStreaming,\n    currentExecution,\n    executionStatus,\n    executeOrchestration,\n    pollOrchestrationResult,\n    resetOrchestration,\n  };\n};\n","import { useState, useEffect, useRef, useCallback } from \"react\";\n\n/**\n * WebSocket 실시간 스트리밍을 위한 커스텀 훅\n */\nexport const useWebSocket = (projectId) => {\n  const [isConnected, setIsConnected] = useState(false);\n  const [isConnecting, setIsConnecting] = useState(false);\n  const [error, setError] = useState(null);\n  const wsRef = useRef(null);\n  const reconnectTimeoutRef = useRef(null);\n  const reconnectAttempts = useRef(0);\n  const maxReconnectAttempts = 5;\n\n  // WebSocket URL (환경변수나 실제 배포된 URL로 설정)\n  const getWebSocketUrl = useCallback(async () => {\n    const wsUrl =\n      process.env.REACT_APP_WS_URL ||\n      \"wss://your-websocket-api.execute-api.us-east-1.amazonaws.com/prod\";\n    \n    // URL 형식 검증 및 정규화\n    if (!wsUrl.startsWith(\"wss://\") && !wsUrl.startsWith(\"ws://\")) {\n      console.error(\"잘못된 WebSocket URL 형식:\", wsUrl);\n      return null;\n    }\n    \n    // 끝에 슬래시 제거\n    let normalizedUrl = wsUrl.replace(/\\/$/, \"\");\n    \n    // 인증 토큰을 쿼리 파라미터로 추가\n    try {\n      const { fetchAuthSession } = await import('aws-amplify/auth');\n      const session = await fetchAuthSession();\n      const token = session?.tokens?.idToken?.toString();\n      \n      if (token) {\n        // URL에 토큰을 쿼리 파라미터로 추가\n        normalizedUrl += `?token=${encodeURIComponent(token)}`;\n        console.log(\"✅ WebSocket URL에 인증 토큰 추가됨\");\n      } else {\n        console.log(\"⚠️ 인증 토큰이 없음 - 공개 WebSocket 연결 시도\");\n      }\n    } catch (authError) {\n      console.log(\"📝 인증 토큰 가져오기 실패:\", authError.message);\n    }\n    \n    console.log(\"WebSocket URL 확인:\", normalizedUrl.replace(/token=[^&]+/, 'token=***'));\n    console.log(\"환경변수 REACT_APP_WS_URL:\", process.env.REACT_APP_WS_URL);\n    \n    return normalizedUrl;\n  }, []);\n\n  // WebSocket 연결\n  const connect = useCallback(async () => {\n    // 이미 연결 중이거나 연결된 경우 중복 연결 방지\n    if (wsRef.current?.readyState === WebSocket.OPEN || \n        wsRef.current?.readyState === WebSocket.CONNECTING) {\n      console.log(\"이미 연결된 WebSocket이 있습니다 (readyState:\", wsRef.current.readyState, \")\");\n      return;\n    }\n\n    // 이전 연결이 있다면 정리\n    if (wsRef.current) {\n      wsRef.current.close();\n      wsRef.current = null;\n    }\n\n    setIsConnecting(true);\n    setError(null);\n\n    try {\n      const wsUrl = await getWebSocketUrl();\n      \n      if (!wsUrl) {\n        setError(\"유효하지 않은 WebSocket URL\");\n        setIsConnecting(false);\n        return;\n      }\n\n      console.log(\"WebSocket 연결 시도:\", wsUrl);\n      console.log(\"브라우저 WebSocket 지원:\", !!window.WebSocket);\n\n      // 연결 시도 시간 기록\n      window.wsConnectStart = Date.now();\n\n      wsRef.current = new WebSocket(wsUrl);\n\n      // 연결 상태 모니터링\n      const connectionTimeout = setTimeout(() => {\n        if (wsRef.current?.readyState === WebSocket.CONNECTING) {\n          console.error(\"WebSocket 연결 시간 초과\");\n          wsRef.current.close();\n          setError(\"연결 시간이 초과되었습니다\");\n          setIsConnecting(false);\n        }\n      }, 10000); // 10초 타임아웃\n\n      wsRef.current.onopen = (event) => {\n        clearTimeout(connectionTimeout);\n        console.log(\"🟢 WebSocket 연결 성공!\");\n        console.log(\"- Event:\", event);\n        console.log(\"- URL:\", wsRef.current?.url);\n        console.log(\"- Protocol:\", wsRef.current?.protocol);\n        console.log(\"- Extensions:\", wsRef.current?.extensions);\n        setIsConnected(true);\n        setIsConnecting(false);\n        setError(null);\n        reconnectAttempts.current = 0;\n      };\n\n      wsRef.current.onclose = (event) => {\n        clearTimeout(connectionTimeout);\n        const connectionDuration = Date.now() - (window.wsConnectStart || 0);\n        \n        console.log(\"🔴 WebSocket 연결 종료:\");\n        console.log(\"- Code:\", event.code);\n        console.log(\"- Reason:\", event.reason || \"(no reason provided)\");\n        console.log(\"- WasClean:\", event.wasClean);\n        console.log(\"- Connection duration:\", connectionDuration + \"ms\");\n        \n        setIsConnected(false);\n        setIsConnecting(false);\n\n        // 즉시 종료된 경우 (500ms 이내) - 서버 문제\n        if (connectionDuration < 500) {\n          console.error(\"⚠️ WebSocket이 즉시 종료됨 - 서버 문제 가능성\");\n          \n          // 특정 에러 코드에 따른 세분화된 에러 메시지\n          let errorMessage = \"서버 연결에 실패했습니다.\";\n          switch(event.code) {\n            case 1006:\n              errorMessage = \"비정상적인 연결 종료 (네트워크 문제 가능성)\";\n              break;\n            case 1002:\n              errorMessage = \"프로토콜 오류\";\n              break;\n            case 1003:\n              errorMessage = \"지원하지 않는 데이터 타입\";\n              break;\n            case 1011:\n              errorMessage = \"서버 내부 오류\";\n              break;\n            case 1001:\n              errorMessage = \"서버가 종료되었습니다\";\n              break;\n            case 1012:\n              errorMessage = \"서버 재시작 중입니다\";\n              break;\n            case 1013:\n              errorMessage = \"나중에 다시 시도해주세요\";\n              break;\n            case 1014:\n              errorMessage = \"잘못된 게이트웨이\";\n              break;\n            case 1015:\n              errorMessage = \"TLS 연결 실패\";\n              break;\n          }\n          \n          setError(errorMessage);\n          return;\n        }\n\n        // 자동 재연결 (정상 종료가 아닌 경우)\n        if (\n          event.code !== 1000 &&\n          reconnectAttempts.current < maxReconnectAttempts\n        ) {\n          const delay = Math.min(\n            1000 * Math.pow(2, reconnectAttempts.current),\n            30000\n          );\n          console.log(\n            `🔄 ${delay}ms 후 재연결 시도 (${\n              reconnectAttempts.current + 1\n            }/${maxReconnectAttempts})`\n          );\n\n          reconnectTimeoutRef.current = setTimeout(() => {\n            reconnectAttempts.current++;\n            connect();\n          }, delay);\n        } else if (reconnectAttempts.current >= maxReconnectAttempts) {\n          setError(\"최대 재연결 시도 횟수에 도달했습니다.\");\n        }\n      };\n\n      wsRef.current.onerror = (error) => {\n        clearTimeout(connectionTimeout);\n        console.error(\"💥 WebSocket 오류:\", error);\n        console.log(\"- ReadyState:\", wsRef.current?.readyState);\n        console.log(\"- URL:\", wsRef.current?.url);\n        setError(\"WebSocket 연결 오류가 발생했습니다\");\n        setIsConnecting(false);\n      };\n\n    } catch (err) {\n      console.error(\"💥 WebSocket 생성 실패:\", err);\n      setError(\"WebSocket 연결에 실패했습니다: \" + err.message);\n      setIsConnecting(false);\n    }\n  }, [getWebSocketUrl]);\n\n  // WebSocket 연결 해제\n  const disconnect = useCallback(() => {\n    if (reconnectTimeoutRef.current) {\n      clearTimeout(reconnectTimeoutRef.current);\n      reconnectTimeoutRef.current = null;\n    }\n\n    if (wsRef.current) {\n      wsRef.current.close(1000, \"Manual disconnect\");\n      wsRef.current = null;\n    }\n\n    setIsConnected(false);\n    setIsConnecting(false);\n    reconnectAttempts.current = 0;\n  }, []);\n\n  // 메시지 전송\n  const sendMessage = useCallback((message) => {\n    if (wsRef.current?.readyState === WebSocket.OPEN) {\n      wsRef.current.send(JSON.stringify(message));\n      return true;\n    } else {\n      console.error(\"WebSocket이 연결되지 않았습니다\");\n      setError(\"WebSocket 연결이 필요합니다\");\n      return false;\n    }\n  }, []);\n\n  // 스트리밍 요청\n  const startStreaming = useCallback(\n    (userInput, chatHistory = [], promptCards = [], modelId = null, conversationId = null, userSub = null) => {\n      if (!isConnected) {\n        setError(\"WebSocket 연결이 필요합니다\");\n        return false;\n      }\n\n      const message = {\n        action: \"stream\",\n        projectId,\n        userInput,\n        chat_history: chatHistory,\n        prompt_cards: promptCards,\n        modelId: modelId,\n        conversationId: conversationId,\n        userSub: userSub,\n      };\n\n      console.log('WebSocket 메시지 전송:', {\n        action: message.action,\n        projectId: message.projectId,\n        inputLength: userInput.length,\n        historyLength: chatHistory.length,\n        promptCardsCount: promptCards.length,\n        conversationId: message.conversationId,\n        userSub: message.userSub\n      });\n\n      return sendMessage(message);\n    },\n    [isConnected, projectId, sendMessage]\n  );\n\n  // 메시지 리스너 등록\n  const addMessageListener = useCallback((listener) => {\n    if (wsRef.current) {\n      wsRef.current.addEventListener(\"message\", listener);\n    }\n  }, []);\n\n  // 메시지 리스너 제거\n  const removeMessageListener = useCallback((listener) => {\n    if (wsRef.current) {\n      wsRef.current.removeEventListener(\"message\", listener);\n    }\n  }, []);\n\n  // 컴포넌트 마운트 시 연결, 언마운트 시 해제\n  useEffect(() => {\n    // 초기 연결 지연을 통해 React strict mode 이슈 회피\n    const timer = setTimeout(() => {\n      connect();\n    }, 100);\n    \n    return () => {\n      clearTimeout(timer);\n      disconnect();\n    };\n  }, []); // 의존성 배열을 빈 배열로 변경\n\n  // projectId 변경 시 재연결 (이전 값과 비교하여 실제 변경시에만)\n  const prevProjectIdRef = useRef(projectId);\n  useEffect(() => {\n    if (prevProjectIdRef.current !== projectId && isConnected && projectId) {\n      console.log('ProjectId 변경됨, 재연결 중:', prevProjectIdRef.current, '->', projectId);\n      disconnect();\n      setTimeout(connect, 200);\n    }\n    prevProjectIdRef.current = projectId;\n  }, [projectId, isConnected]); // connect, disconnect 의존성 제거\n\n  return {\n    isConnected,\n    isConnecting,\n    error,\n    connect,\n    disconnect,\n    sendMessage,\n    startStreaming,\n    addMessageListener,\n    removeMessageListener,\n  };\n};\n","import React, { useState } from \"react\";\nimport ReactMarkdown from \"react-markdown\";\nimport {\n  ExclamationTriangleIcon,\n} from \"@heroicons/react/24/outline\";\n\n// 타임스탬프 포맷팅 유틸리티 함수\nconst formatTimestamp = (timestamp) => {\n  if (!timestamp) return \"\";\n\n  try {\n    // 이미 Date 객체인 경우\n    if (timestamp instanceof Date) {\n      return timestamp.toLocaleTimeString('ko-KR', { \n        hour: '2-digit', \n        minute: '2-digit',\n        hour12: false \n      });\n    }\n\n    // 문자열인 경우 Date 객체로 변환\n    if (typeof timestamp === \"string\") {\n      const date = new Date(timestamp);\n      return isNaN(date.getTime()) ? \"\" : date.toLocaleTimeString('ko-KR', { \n        hour: '2-digit', \n        minute: '2-digit',\n        hour12: false \n      });\n    }\n\n    // 숫자인 경우 (타임스탬프)\n    if (typeof timestamp === \"number\") {\n      return new Date(timestamp).toLocaleTimeString('ko-KR', { \n        hour: '2-digit', \n        minute: '2-digit',\n        hour12: false \n      });\n    }\n\n    return \"\";\n  } catch (error) {\n    console.warn(\"타임스탬프 포맷 오류:\", error);\n    return \"\";\n  }\n};\n\nconst SimpleChatMessage = ({ message, onCopyMessage, onCopyTitle, copiedMessage }) => {\n  // 사용자가 대화창에서 전송한 메시지면 사용자 메시지!\n  const isUser = message.role === \"user\" || message.type === \"user\";\n  const isError = message.role === \"error\";\n  const isLoading = message.isLoading || false;\n  \n  // 버튼 상태 관리\n  const [likeClicked, setLikeClicked] = useState(false);\n  const [dislikeClicked, setDislikeClicked] = useState(false);\n  const [copyClicked, setCopyClicked] = useState(false);\n  \n  // 복사 기능\n  const handleCopyClick = async () => {\n    try {\n      await navigator.clipboard.writeText(message.content);\n      setCopyClicked(true);\n      setTimeout(() => setCopyClicked(false), 1000);\n      // 팝업 알림 없이 복사만 실행\n    } catch (err) {\n      console.error('복사 실패:', err);\n    }\n  };\n  \n  // 좋아요 클릭\n  const handleLikeClick = () => {\n    setLikeClicked(true);\n    setDislikeClicked(false); // 반대 버튼 비활성화\n    setTimeout(() => setLikeClicked(false), 2000);\n  };\n  \n  // 싫어요 클릭\n  const handleDislikeClick = () => {\n    setDislikeClicked(true);\n    setLikeClicked(false); // 반대 버튼 비활성화\n    setTimeout(() => setDislikeClicked(false), 2000);\n  };\n  \n\n  return (\n    <div className={`flex ${isUser ? \"justify-end\" : \"justify-start\"} mb-3`}>\n      {isUser ? (\n        // 사용자 메시지 - 우측 말풍선\n        <div className=\"max-w-[70%]\">\n          <div \n            className=\"bg-[#5E89FF] text-white rounded-2xl px-4 py-2 shadow-md\"\n          >\n            <div className=\"text-[15px] font-normal leading-[1.5] whitespace-pre-wrap break-words\">\n              {message.content}\n            </div>\n            {/* 타임스탬프 - 말풍선 내부 하단 */}\n            {message.timestamp && (\n              <div className=\"text-[12px] text-white/70 mt-1 text-right\">\n                {formatTimestamp(message.timestamp)}\n              </div>\n            )}\n          </div>\n        </div>\n      ) : (\n        // AI 메시지 - 좌측 플랫형 답변\n        <div className=\"w-full max-w-[75%]\">\n          <div \n            className=\"bg-transparent dark:bg-transparent\" \n            aria-live=\"polite\"\n          >\n            {isError ? (\n              <div className=\"text-red-600 dark:text-red-400\">\n                <div className=\"flex items-center mb-2\">\n                  <ExclamationTriangleIcon className=\"h-4 w-4 mr-2\" />\n                  <span className=\"text-[14px] font-semibold\">오류가 발생했습니다</span>\n                </div>\n                <div className=\"text-[15px] font-normal leading-[1.5]\">{message.content}</div>\n              </div>\n            ) : isLoading ? (\n              // 예쁜 로딩 애니메이션 - 제미나이 스타일\n              <div className=\"flex items-start gap-3\">\n                {/* AI 아이콘 */}\n                <div className=\"flex-shrink-0 w-8 h-8 bg-gradient-to-br from-indigo-400 to-purple-500 rounded-full flex items-center justify-center shadow-sm\">\n                  <svg className=\"w-4 h-4 text-white\" fill=\"none\" stroke=\"currentColor\" strokeWidth=\"1.5\" viewBox=\"0 0 24 24\">\n                    <path strokeLinecap=\"round\" strokeLinejoin=\"round\" d=\"M9.813 15.904L9 18.75l-.813-2.846a4.5 4.5 0 00-3.09-3.09L2.25 12l2.846-.813a4.5 4.5 0 003.09-3.09L9 5.25l.813 2.847a4.5 4.5 0 003.09 3.09L15.75 12l-2.847.813a4.5 4.5 0 00-3.09 3.09zM18.259 8.715L18 9.75l-.259-1.035a3.375 3.375 0 00-2.455-2.456L14.25 6l1.036-.259a3.375 3.375 0 002.455-2.456L18 2.25l.259 1.035a3.375 3.375 0 002.456 2.456L21.75 6l-1.035.259a3.375 3.375 0 00-2.456 2.456z\" />\n                  </svg>\n                </div>\n                \n                {/* 로딩 애니메이션 */}\n                <div className=\"flex-1\">\n                  <div className=\"flex items-center gap-1 mb-2\">\n                    <div className=\"w-2 h-2 bg-blue-500 rounded-full animate-bounce\" style={{ animationDelay: '0ms' }}></div>\n                    <div className=\"w-2 h-2 bg-blue-500 rounded-full animate-bounce\" style={{ animationDelay: '150ms' }}></div>\n                    <div className=\"w-2 h-2 bg-blue-500 rounded-full animate-bounce\" style={{ animationDelay: '300ms' }}></div>\n                  </div>\n                  <span className=\"text-sm text-gray-600 dark:text-gray-400\">AI가 답변을 생성하고 있습니다...</span>\n                </div>\n              </div>\n            ) : (\n              // 일반 AI 응답 - 제미나이 스타일 로고 포함\n              <div className=\"flex items-start gap-3\">\n                {/* AI 아이콘 */}\n                <div className=\"flex-shrink-0 w-8 h-8 bg-gradient-to-br from-indigo-400 to-purple-500 rounded-full flex items-center justify-center shadow-sm mt-1\">\n                  <svg className=\"w-4 h-4 text-white\" fill=\"none\" stroke=\"currentColor\" strokeWidth=\"1.5\" viewBox=\"0 0 24 24\">\n                    <path strokeLinecap=\"round\" strokeLinejoin=\"round\" d=\"M9.813 15.904L9 18.75l-.813-2.846a4.5 4.5 0 00-3.09-3.09L2.25 12l2.846-.813a4.5 4.5 0 003.09-3.09L9 5.25l.813 2.847a4.5 4.5 0 003.09 3.09L15.75 12l-2.847.813a4.5 4.5 0 00-3.09 3.09zM18.259 8.715L18 9.75l-.259-1.035a3.375 3.375 0 00-2.455-2.456L14.25 6l1.036-.259a3.375 3.375 0 002.455-2.456L18 2.25l.259 1.035a3.375 3.375 0 002.456 2.456L21.75 6l-1.035.259a3.375 3.375 0 00-2.456 2.456z\" />\n                  </svg>\n                </div>\n                \n                {/* 답변 내용 */}\n                <div className=\"flex-1 text-[#202124] dark:text-[#E5E7EB] prose prose-sm max-w-none\">\n                  <div className=\"text-[15px] font-normal leading-[1.6] whitespace-pre-wrap [&>p]:mb-3 [&>ul]:mb-3 [&>ol]:mb-3 [&>h1]:text-[18px] [&>h1]:font-semibold [&>h1]:mb-3 [&>h2]:text-[16px] [&>h2]:font-semibold [&>h2]:mb-2 [&>h3]:text-[15px] [&>h3]:font-medium [&>h3]:mb-2\">\n                    <ReactMarkdown>{message.content}</ReactMarkdown>\n                  </div>\n                </div>\n              </div>\n            )}\n            {/* 타임스탬프 - 아이콘 위치에 맞춘 여백 */}\n            {message.timestamp && (\n              <div className=\"text-[12px] text-gray-500 dark:text-gray-400 mt-1 ml-11\">\n                {formatTimestamp(message.timestamp)}\n              </div>\n            )}\n          </div>\n          \n          {/* AI 메시지 하단 액션 버튼들 - GPT 스타일 */}\n          {!isError && !isLoading && (\n            <div className=\"flex items-center gap-1 mt-2 ml-11\">\n              {/* 복사 버튼 */}\n              <button\n                onClick={handleCopyClick}\n                className={`p-1.5 rounded transition-all duration-200 transform ${\n                  copyClicked\n                    ? \"text-green-500 bg-green-100 dark:bg-green-900/30 scale-110\"\n                    : \"text-gray-400 hover:text-gray-600 dark:text-gray-500 dark:hover:text-gray-300 hover:bg-gray-100 dark:hover:bg-gray-800\"\n                }`}\n                title={copyClicked ? \"복사됨!\" : \"복사\"}\n              >\n                <svg \n                  className=\"w-4 h-4\" \n                  fill=\"none\" \n                  viewBox=\"0 0 24 24\" \n                  stroke=\"currentColor\"\n                  strokeWidth=\"2\"\n                >\n                  {copyClicked ? (\n                    <path strokeLinecap=\"round\" strokeLinejoin=\"round\" d=\"M5 13l4 4L19 7\" />\n                  ) : (\n                    <path strokeLinecap=\"round\" strokeLinejoin=\"round\" d=\"M8 16H6a2 2 0 01-2-2V6a2 2 0 012-2h8a2 2 0 012 2v2m-6 12h8a2 2 0 002-2v-8a2 2 0 00-2-2h-8a2 2 0 00-2 2v8a2 2 0 002 2z\" />\n                  )}\n                </svg>\n              </button>\n              \n              {/* 좋아요 버튼 */}\n              <button\n                onClick={handleLikeClick}\n                className={`p-1.5 rounded transition-all duration-300 transform ${\n                  likeClicked\n                    ? \"text-blue-500 bg-blue-100 dark:bg-blue-900/30 scale-110 animate-pulse\"\n                    : \"text-gray-400 hover:text-gray-600 dark:text-gray-500 dark:hover:text-gray-300 hover:bg-gray-100 dark:hover:bg-gray-800\"\n                }`}\n                title={likeClicked ? \"좋아요!\" : \"좋아요\"}\n              >\n                <svg \n                  className=\"w-4 h-4\" \n                  fill={likeClicked ? \"currentColor\" : \"none\"}\n                  viewBox=\"0 0 24 24\" \n                  stroke=\"currentColor\"\n                  strokeWidth=\"2\"\n                >\n                  <path strokeLinecap=\"round\" strokeLinejoin=\"round\" d=\"M14 10h4.764a2 2 0 011.789 2.894l-3.5 7A2 2 0 0115.263 21h-4.017c-.163 0-.326-.02-.485-.06L7 20m7-10V5a2 2 0 00-2-2h-.095c-.5 0-.905.405-.905.905 0 .714-.211 1.412-.608 2.006L7 11v9m7-10h-2M7 20H5a2 2 0 01-2-2v-6a2 2 0 012-2h2.5\" />\n                </svg>\n              </button>\n              \n              {/* 싫어요 버튼 */}\n              <button\n                onClick={handleDislikeClick}\n                className={`p-1.5 rounded transition-all duration-300 transform ${\n                  dislikeClicked\n                    ? \"text-red-500 bg-red-100 dark:bg-red-900/30 scale-110 border-2 border-red-300 animate-pulse\"\n                    : \"text-gray-400 hover:text-gray-600 dark:text-gray-500 dark:hover:text-gray-300 hover:bg-gray-100 dark:hover:bg-gray-800\"\n                }`}\n                title={dislikeClicked ? \"싫어요!\" : \"싫어요\"}\n              >\n                <svg \n                  className=\"w-4 h-4 rotate-180\" \n                  fill={dislikeClicked ? \"currentColor\" : \"none\"}\n                  viewBox=\"0 0 24 24\" \n                  stroke=\"currentColor\"\n                  strokeWidth=\"2\"\n                >\n                  <path strokeLinecap=\"round\" strokeLinejoin=\"round\" d=\"M14 10h4.764a2 2 0 011.789 2.894l-3.5 7A2 2 0 0115.263 21h-4.017c-.163 0-.326-.02-.485-.60L7 20m7-10V5a2 2 0 00-2-2h-.095c-.5 0-.905.405-.905.905 0 .714-.211 1.412-.608 2.006L7 11v9m7-10h-2M7 20H5a2 2 0 01-2-2v-6a2 2 0 012-2h2.5\" />\n                </svg>\n              </button>\n            </div>\n          )}\n        </div>\n      )}\n    </div>\n  );\n};\n\nexport default SimpleChatMessage;","import React, { useState, useCallback } from \"react\";\nimport { ChatBubbleLeftRightIcon, SparklesIcon, PaperAirplaneIcon, StopIcon } from \"@heroicons/react/24/outline\";\nimport ConversationDrawer from \"./ConversationDrawer\";\nimport ModelSelector from \"../ModelSelector\";\nimport { useChat } from \"../../hooks/useChat\";\nimport { useMessages } from \"../../hooks/useMessages\";\nimport { useConversationContext } from \"../../contexts/ConversationContext\";\nimport { useAuth } from \"../../contexts/AuthContext\";\nimport SimpleChatMessage from \"../SimpleChatMessage\";\n\nconst ChatWindow = ({ projectId, projectName, promptCards = [] }) => {\n  const [sidebarCollapsed, setSidebarCollapsed] = useState(false);\n\n  // Auth context for user info\n  const { user } = useAuth();\n\n  // Conversation context\n  const { currentConversationId, addMessage } = useConversationContext();\n\n  // Messages hook for current conversation\n  const {\n    messages: historicalMessages,\n    loading: messagesLoading,\n  } = useMessages(currentConversationId);\n\n  // Chat hook for sending messages\n  const {\n    messages: chatMessages,\n    inputValue,\n    handleInputChange,\n    copiedMessage,\n    isGenerating,\n    inputHeight,\n    handleSendMessage: originalHandleSendMessage,\n    handleStopGeneration,\n    handleKeyPress,\n    handleCopyMessage,\n    handleCopyTitle,\n    wsConnected,\n    wsConnecting,\n    selectedModel,\n    setSelectedModel,\n  } = useChat(projectId, projectName, promptCards, currentConversationId);\n\n  // 통합된 메시지 목록 (과거 메시지 + 현재 세션 메시지)\n  const allMessages = [...historicalMessages, ...chatMessages];\n\n  // 메시지 전송 핸들러 (conversation 정보 포함)\n  const handleSendMessage = useCallback(async () => {\n    if (!inputValue.trim() || isGenerating) return;\n\n    // 현재 대화 ID와 사용자 정보 포함하여 메시지 전송\n    const messageData = {\n      userInput: inputValue,\n      projectId,\n      conversationId: currentConversationId,\n      userSub: user?.id || \"anonymous\",\n      chat_history: allMessages.map((msg) => ({\n        role: msg.role,\n        content: msg.content,\n      })),\n      prompt_cards: promptCards,\n    };\n\n    // 사용자 메시지를 즉시 UI에 추가\n    const userMessage = {\n      id: Date.now().toString(),\n      role: \"user\",\n      content: inputValue,\n      timestamp: new Date().toISOString(),\n    };\n    addMessage(userMessage);\n\n    // 원래 핸들러 호출 (수정된 데이터로)\n    await originalHandleSendMessage(messageData);\n  }, [\n    inputValue,\n    isGenerating,\n    currentConversationId,\n    allMessages,\n    promptCards,\n    addMessage,\n    originalHandleSendMessage,\n    projectId,\n    user?.id,\n  ]);\n\n  return (\n    <div className=\"flex h-full overflow-hidden\">\n      {/* 대화 드로어 */}\n      <ConversationDrawer onCollapsedChange={setSidebarCollapsed} />\n\n      {/* 메인 채팅 영역 */}\n      <div className={`flex-1 flex flex-col bg-gray-50 dark:bg-dark-primary transition-all duration-500 ease-out relative ${\n        sidebarCollapsed ? \"md:ml-14\" : \"md:ml-64\"\n      }`}>\n        {/* 메시지 영역 */}\n        <div className=\"flex-1 overflow-y-auto px-4 md:px-6 py-4 min-h-0 bg-gray-50 dark:bg-dark-primary transition-all duration-300 pt-4 pb-40\">\n          <div className=\"max-w-4xl mx-auto space-y-6\">\n            {allMessages.length === 0 && !messagesLoading ? (\n              // 빈 상태 - 새 대화 시작\n              <div className=\"flex flex-col items-center justify-center min-h-[calc(100vh-280px)]\">\n                <div className=\"bg-white dark:bg-dark-secondary rounded-2xl shadow-md p-8 max-w-3xl w-full mx-auto transition-colors duration-300\">\n                  <div className=\"flex justify-center mb-6\">\n                    <div className=\"bg-blue-100 dark:bg-dark-tertiary p-3 rounded-full\">\n                      <ChatBubbleLeftRightIcon className=\"h-8 w-8 text-blue-600 dark:text-blue-400\" />\n                    </div>\n                  </div>\n                  <h2 className=\"text-xl font-semibold text-center text-gray-800 dark:text-white mb-4\">\n                    AI 헤드라인 어시스턴트\n                  </h2>\n                  <p className=\"text-gray-600 dark:text-gray-300 text-center mb-6\">\n                    본문을 입력하면 AI가 최적의 헤드라인을 제안해 드립니다.\n                  </p>\n\n                  <div className=\"space-y-4\">\n                    <div className=\"flex items-start p-3 bg-gray-50 dark:bg-dark-tertiary rounded-lg\">\n                      <div className=\"mr-3 mt-1\">\n                        <SparklesIcon className=\"h-5 w-5 text-blue-500 dark:text-blue-400\" />\n                      </div>\n                      <div>\n                        <p className=\"text-sm text-gray-700 dark:text-gray-300\">\n                          <span className=\"font-medium\">시작하는 방법:</span>{\" \"}\n                          아래 입력창에 본문을 붙여넣고 전송 버튼을 클릭하세요\n                        </p>\n                      </div>\n                    </div>\n                    <div className=\"flex items-start p-3 bg-gray-50 dark:bg-dark-tertiary rounded-lg\">\n                      <div className=\"mr-3 mt-1\">\n                        <SparklesIcon className=\"h-5 w-5 text-blue-500 dark:text-blue-400\" />\n                      </div>\n                      <div>\n                        <p className=\"text-sm text-gray-700 dark:text-gray-300\">\n                          <span className=\"font-medium\">대화 기록:</span> 좌측\n                          메뉴에서 이전 대화를 확인하고 이어서 대화할 수\n                          있습니다\n                        </p>\n                      </div>\n                    </div>\n                  </div>\n                </div>\n              </div>\n            ) : (\n              // 메시지 목록\n              <div className=\"space-y-6 pt-4\">\n                {allMessages.map((message) => (\n                  <SimpleChatMessage\n                    key={message.id}\n                    message={message}\n                    onCopyMessage={handleCopyMessage}\n                    onCopyTitle={handleCopyTitle}\n                    copiedMessage={copiedMessage}\n                  />\n                ))}\n              </div>\n            )}\n          </div>\n        </div>\n\n        {/* 고정된 하단 입력 영역 - DeepSeek 스타일 */}\n        <div className={`absolute bottom-0 left-0 right-0 bg-gray-50 dark:bg-dark-primary border-t border-gray-200 dark:border-gray-700 transition-all duration-500`}>\n          <div className=\"w-full max-w-4xl mx-auto px-4 md:px-6 py-6\">\n            {/* 둥근 모서리 통짜 입력창 */}\n            <div className=\"w-full rounded-2xl bg-white dark:bg-[#2E333D] border border-gray-200 dark:border-transparent shadow-sm dark:shadow-none transition-all duration-200\">\n              {/* 메인 입력 영역 */}\n              <div className=\"flex items-center gap-3 px-5 py-4\">\n                {/* 글 입력 영역 */}\n                <textarea\n                  value={inputValue}\n                  onChange={(e) => handleInputChange(e.target.value)}\n                  onKeyPress={handleKeyPress}\n                  placeholder={\n                    isGenerating\n                      ? \"생성 중입니다...\"\n                      : \"기사 본문을 입력하세요...\"\n                  }\n                  className=\"flex-1 resize-none bg-transparent text-gray-900 dark:text-gray-100 placeholder-gray-500 dark:placeholder-gray-400 focus:outline-none appearance-none\"\n                  rows={1}\n                  style={{\n                    height: `${Math.max(inputHeight || 24, 24)}px`,\n                    minHeight: \"24px\",\n                    maxHeight: \"200px\",\n                    lineHeight: \"1.5\",\n                    overflowY: inputHeight > 120 ? \"auto\" : \"hidden\"\n                  }}\n                  disabled={isGenerating}\n                />\n\n                {/* 전송/중단 버튼 */}\n                {isGenerating ? (\n                  <button\n                    onClick={handleStopGeneration}\n                    className=\"shrink-0 rounded-full p-2.5 bg-red-500 hover:bg-red-600 text-white transition-all duration-200\"\n                  >\n                    <StopIcon className=\"w-4 h-4\" />\n                  </button>\n                ) : (\n                  <button\n                    onClick={handleSendMessage}\n                    disabled={!inputValue.trim()}\n                    className={`shrink-0 rounded-full p-2.5 transition-all duration-200 ${\n                      inputValue.trim()\n                        ? \"bg-[#5E89FF] hover:bg-[#4A7BFF] text-white\"\n                        : \"bg-gray-300 dark:bg-gray-600 text-gray-500 dark:text-gray-400 cursor-not-allowed\"\n                    }`}\n                  >\n                    <PaperAirplaneIcon className=\"w-4 h-4\" />\n                  </button>\n                )}\n              </div>\n\n              {/* 하단 정보 영역 - 입력창 안에 위치 */}\n              <div className=\"flex items-center justify-between px-5 pb-3 pt-1\">\n                <div className=\"flex items-center gap-3\">\n                  {/* 모델 선택기 */}\n                  <div className=\"scale-90 origin-left\">\n                    <ModelSelector\n                      selectedModel={selectedModel}\n                      onModelChange={setSelectedModel}\n                    />\n                  </div>\n                  \n                  {/* 글자 수 표시 */}\n                  <div className=\"text-xs text-gray-500 dark:text-gray-400\">\n                    {inputValue.length}자\n                  </div>\n                </div>\n\n                {/* 연결 상태 */}\n                <div className=\"flex items-center gap-1.5\">\n                  {wsConnecting ? (\n                    <>\n                      <div className=\"w-1.5 h-1.5 bg-yellow-500 rounded-full animate-pulse\"></div>\n                      <span className=\"text-xs text-yellow-600 dark:text-yellow-400\">연결 중</span>\n                    </>\n                  ) : wsConnected ? (\n                    <>\n                      <div className=\"w-1.5 h-1.5 bg-green-500 rounded-full animate-pulse\"></div>\n                      <span className=\"text-xs text-green-600 dark:text-green-400\">실시간 스트리밍</span>\n                    </>\n                  ) : (\n                    <>\n                      <div className=\"w-1.5 h-1.5 bg-gray-400 rounded-full\"></div>\n                      <span className=\"text-xs text-gray-500 dark:text-gray-400\">일반 모드</span>\n                    </>\n                  )}\n                </div>\n              </div>\n            </div>\n            \n            {/* 하단 경고 문구 */}\n            <div className=\"text-center mt-4\">\n              <p className=\"text-xs text-gray-500 dark:text-gray-400\">\n                AI는 실수를 할 수 있습니다. 중요한 정보는 재차 확인하세요.\n              </p>\n            </div>\n          </div>\n        </div>\n      </div>\n    </div>\n  );\n};\n\nexport default ChatWindow;\n","import { useState, useEffect, useCallback } from 'react';\nimport { conversationAPI, mockMessages } from '../services/api';\n\n/**\n * 특정 대화의 메시지 관리를 위한 커스텀 훅\n * 페이지네이션과 실시간 메시지 추가 지원\n */\nexport const useMessages = (conversationId) => {\n  const [messages, setMessages] = useState([]);\n  const [loading, setLoading] = useState(false);\n  const [error, setError] = useState(null);\n  const [hasMore, setHasMore] = useState(true);\n  const [nextCursor, setNextCursor] = useState(null);\n\n  // 메시지 로드\n  const loadMessages = useCallback(async (reset = false) => {\n    if (!conversationId || loading) {\n      console.log('useMessages - 메시지 로드 중단:', { conversationId, loading });\n      return;\n    }\n    \n    console.log('useMessages - 메시지 로드 시작:', { \n      conversationId, \n      reset, \n      cursor: reset ? null : nextCursor,\n      currentMessagesCount: messages.length\n    });\n    \n    setLoading(true);\n    setError(null);\n\n    try {\n      const cursor = reset ? null : nextCursor;\n      const response = await conversationAPI.getMessages(conversationId, cursor);\n      \n      console.log('useMessages - API 응답:', {\n        conversationId,\n        messagesReceived: response.messages?.length || 0,\n        hasMore: response.hasMore,\n        nextCursor: response.nextCursor,\n        reset\n      });\n      \n      if (reset) {\n        setMessages(response.messages);\n      } else {\n        // 이전 메시지들을 앞에 추가 (페이지네이션)\n        setMessages(prev => [...response.messages, ...prev]);\n      }\n      \n      setHasMore(response.hasMore);\n      setNextCursor(response.nextCursor);\n      \n    } catch (err) {\n      console.error('메시지 로드 실패:', err);\n      console.error('실패한 conversationId:', conversationId);\n      setError('메시지를 불러오는데 실패했습니다.');\n      \n      // API 실패시 mock 데이터로 fallback\n      const conversationMessages = mockMessages[conversationId] || [];\n      console.log('useMessages - Mock 데이터 사용:', {\n        conversationId,\n        mockMessagesCount: conversationMessages.length\n      });\n      \n      if (reset) {\n        setMessages(conversationMessages);\n        setHasMore(false);\n        setNextCursor(null);\n      }\n    } finally {\n      setLoading(false);\n    }\n  }, [conversationId, loading, nextCursor, messages.length]);\n\n  // 새 메시지 추가 (실시간)\n  const addMessage = useCallback((message) => {\n    const newMessage = {\n      id: message.timestamp || new Date().toISOString(),\n      role: message.role,\n      content: message.content,\n      tokenCount: message.tokenCount || 0,\n      timestamp: message.timestamp || new Date().toISOString()\n    };\n    \n    setMessages(prev => [...prev, newMessage]);\n    return newMessage;\n  }, []);\n\n  // 메시지 업데이트 (스트리밍 중 내용 업데이트)\n  const updateMessage = useCallback((messageId, updates) => {\n    setMessages(prev =>\n      prev.map(msg =>\n        msg.id === messageId ? { ...msg, ...updates } : msg\n      )\n    );\n  }, []);\n\n  // 메시지 삭제\n  const removeMessage = useCallback((messageId) => {\n    setMessages(prev => prev.filter(msg => msg.id !== messageId));\n  }, []);\n\n  // 이전 메시지 로드 (스크롤 최상단에서)\n  const loadPreviousMessages = useCallback(() => {\n    if (hasMore && !loading) {\n      return loadMessages(false);\n    }\n    return Promise.resolve();\n  }, [hasMore, loading, loadMessages]);\n\n  // 메시지 초기화 (새 대화 시작시)\n  const clearMessages = useCallback(() => {\n    setMessages([]);\n    setHasMore(true);\n    setNextCursor(null);\n    setError(null);\n  }, []);\n\n  // conversationId 변경시 메시지 로드\n  useEffect(() => {\n    console.log('useMessages - conversationId 변경 감지:', {\n      conversationId,\n      previousConversationId: conversationId\n    });\n    \n    if (conversationId) {\n      console.log('useMessages - 메시지 클리어 및 로드 시작:', conversationId);\n      clearMessages();\n      loadMessages(true);\n    } else {\n      console.log('useMessages - conversationId가 null/undefined, 메시지 클리어');\n      clearMessages();\n    }\n  }, [conversationId]);\n\n  return {\n    messages,\n    loading,\n    error,\n    hasMore,\n    addMessage,\n    updateMessage,\n    removeMessage,\n    loadPreviousMessages,\n    clearMessages,\n    refresh: () => loadMessages(true)\n  };\n};","import React, { useState, useEffect } from \"react\";\nimport { toast } from \"react-hot-toast\";\nimport {\n  PlusIcon,\n  PencilIcon,\n  TrashIcon,\n  XMarkIcon,\n  SparklesIcon,\n  HashtagIcon,\n} from \"@heroicons/react/24/outline\";\nimport { promptCardAPI, handleAPIError } from \"../services/api\";\nimport ChatWindow from \"./chat/ChatWindow\";\n\nconst PromptCardManager = ({ projectId, projectName }) => {\n  const [promptCards, setPromptCards] = useState([]);\n  const [loading, setLoading] = useState(true);\n  const [editingCard, setEditingCard] = useState(null);\n  const [showForm, setShowForm] = useState(false);\n\n  useEffect(() => {\n    loadPromptCards();\n  }, [projectId]);\n\n  const loadPromptCards = async () => {\n    try {\n      setLoading(true);\n      const response = await promptCardAPI.getPromptCards(projectId, true);\n      setPromptCards(response.promptCards || []);\n    } catch (error) {\n      console.error(\"프롬프트 카드 로드 실패:\", error);\n      const errorInfo = handleAPIError(error);\n      toast.error(errorInfo.message);\n    } finally {\n      setLoading(false);\n    }\n  };\n\n  const handleSaveCard = async (cardData) => {\n    try {\n      // 백엔드에 맞는 형식으로 데이터 변환\n      const backendData = {\n        title: cardData.title,\n        prompt_text: cardData.prompt_text,\n        tags: cardData.tags || [],\n        isActive: cardData.enabled !== false, // enabled를 isActive로 변환\n      };\n\n      if (editingCard) {\n        // 수정\n        await promptCardAPI.updatePromptCard(\n          projectId,\n          editingCard.promptId || editingCard.prompt_id,\n          backendData\n        );\n        toast.success(\"프롬프트가 수정되었습니다\");\n      } else {\n        // 새로 생성\n        await promptCardAPI.createPromptCard(projectId, backendData);\n        toast.success(\"프롬프트가 생성되었습니다\");\n      }\n\n      setShowForm(false);\n      setEditingCard(null);\n\n      // 백엔드 저장 성공 후 전체 데이터 다시 로드 (페이지 새로고침 없이)\n      await loadPromptCards();\n    } catch (error) {\n      console.error(\"프롬프트 저장 실패:\", error);\n      const errorInfo = handleAPIError(error);\n      toast.error(errorInfo.message);\n    }\n  };\n\n  const handleDeleteCard = async (promptId) => {\n    if (!window.confirm(\"정말로 이 프롬프트를 삭제하시겠습니까?\")) {\n      return;\n    }\n\n    try {\n      // 백엔드에서 삭제 먼저 실행\n      await promptCardAPI.deletePromptCard(projectId, promptId);\n      toast.success(\"프롬프트가 삭제되었습니다\");\n\n      // 삭제 성공 후 UI에서 제거\n      setPromptCards((prev) =>\n        prev.filter((card) => (card.promptId || card.prompt_id) !== promptId)\n      );\n\n      // 추가로 전체 데이터 다시 로드\n      await loadPromptCards();\n    } catch (error) {\n      console.error(\"프롬프트 삭제 실패:\", error);\n      const errorInfo = handleAPIError(error);\n      toast.error(errorInfo.message);\n    }\n  };\n\n  const handleEditCard = async (card) => {\n    console.log(\"프롬프트 수정 버튼 클릭:\", card);\n\n    // 프롬프트 텍스트 내용이 없으면 S3에서 가져오기\n    let cardWithContent = { ...card };\n\n    if (!card.prompt_text && !card.content) {\n      try {\n        console.log(\"S3에서 프롬프트 내용 로드 중...\");\n        const contentResponse = await promptCardAPI.getPromptContent(\n          projectId,\n          card.promptId || card.prompt_id\n        );\n        cardWithContent.prompt_text = contentResponse.content;\n        console.log(\n          \"S3에서 프롬프트 내용 로드 완료:\",\n          contentResponse.content?.length,\n          \"문자\"\n        );\n      } catch (error) {\n        console.error(\"프롬프트 내용 로드 실패:\", error);\n        toast.error(\"프롬프트 내용을 불러올 수 없습니다\");\n        return;\n      }\n    }\n\n    setEditingCard(cardWithContent);\n    setShowForm(true);\n  };\n\n  const handleNewCard = () => {\n    console.log(\"새 프롬프트 추가 버튼 클릭\");\n    setEditingCard(null);\n    setShowForm(true);\n  };\n\n  const handleCancelForm = () => {\n    console.log(\"모달 취소 버튼 클릭\");\n    setShowForm(false);\n    setEditingCard(null);\n  };\n\n  if (loading) {\n    return (\n      <div className=\"flex items-center justify-center h-64\">\n        <div className=\"animate-spin rounded-full h-8 w-8 border-b-2 border-blue-600\"></div>\n      </div>\n    );\n  }\n\n  return (\n    <div className=\"flex h-full w-full bg-gray-50 dark:bg-dark-primary\">\n      {/* 채팅 인터페이스 */}\n      <div className=\"flex-1 min-w-0 overflow-hidden\">\n        <ChatWindow\n          projectId={projectId}\n          projectName={projectName}\n          promptCards={promptCards}\n        />\n      </div>\n\n      {/* 프롬프트 관리 사이드바 (우측) */}\n      <div className=\"w-80 bg-white dark:bg-dark-primary flex flex-col shadow-lg border-l border-gray-200 dark:border-gray-700 flex-shrink-0\">\n        <div className=\"flex-shrink-0 p-4 bg-gray-50 dark:bg-dark-primary\">\n          <div className=\"flex items-center justify-between\">\n            <h2 className=\"text-lg font-semibold text-gray-800 dark:text-white\">\n              프롬프트 카드\n            </h2>\n            <button\n              onClick={handleNewCard}\n              className=\"inline-flex items-center px-4 py-2 text-sm bg-blue-600 dark:bg-blue-500 text-white rounded-lg hover:bg-blue-700 dark:hover:bg-blue-600 transition-colors shadow-md hover:shadow-lg font-medium\"\n            >\n              <PlusIcon className=\"h-4 w-4 mr-1.5\" />새 추가\n            </button>\n          </div>\n        </div>\n\n        <div className=\"flex-1 overflow-y-auto p-4 space-y-3 min-h-0 max-h-[calc(100vh-140px)] bg-gray-50 dark:bg-dark-secondary custom-scrollbar\">\n          {promptCards.length === 0 ? (\n            <div className=\"text-center py-8\">\n              <SparklesIcon className=\"h-12 w-12 text-gray-300 dark:text-gray-600 mx-auto mb-4\" />\n              <p className=\"text-gray-500 dark:text-gray-400 mb-4\">\n                프롬프트 카드가 없습니다\n              </p>\n              <button\n                onClick={handleNewCard}\n                className=\"inline-flex items-center px-4 py-2 bg-blue-600 dark:bg-blue-500 text-white rounded-lg hover:bg-blue-700 dark:hover:bg-blue-600 transition-colors shadow-sm font-medium\"\n              >\n                <PlusIcon className=\"h-4 w-4 mr-1.5\" />첫 번째 카드 만들기\n              </button>\n            </div>\n          ) : (\n            promptCards.map((card) => (\n              <PromptCard\n                key={card.promptId || card.prompt_id}\n                card={card}\n                onEdit={() => handleEditCard(card)}\n                onDelete={() =>\n                  handleDeleteCard(card.promptId || card.prompt_id)\n                }\n              />\n            ))\n          )}\n        </div>\n      </div>\n\n      {/* 프롬프트 편집 폼 모달 */}\n      {showForm && (\n        <PromptFormModal\n          isOpen={showForm}\n          onSubmit={handleSaveCard}\n          onCancel={handleCancelForm}\n          initialData={editingCard}\n        />\n      )}\n      \n      {/* 스크롤바 스타일 */}\n      <style jsx>{`\n        .custom-scrollbar::-webkit-scrollbar {\n          width: 8px;\n        }\n        .custom-scrollbar::-webkit-scrollbar-track {\n          background: transparent;\n          border-radius: 4px;\n        }\n        .custom-scrollbar::-webkit-scrollbar-thumb {\n          background: #d1d5db;\n          border-radius: 4px;\n          border: 1px solid #f3f4f6;\n        }\n        .custom-scrollbar::-webkit-scrollbar-thumb:hover {\n          background: #9ca3af;\n        }\n        .custom-scrollbar::-webkit-scrollbar-thumb:active {\n          background: #6b7280;\n        }\n        /* 다크모드 스크롤바 */\n        .dark .custom-scrollbar::-webkit-scrollbar-thumb {\n          background: #4b5563;\n          border: 1px solid #374151;\n        }\n        .dark .custom-scrollbar::-webkit-scrollbar-thumb:hover {\n          background: #6b7280;\n        }\n        .dark .custom-scrollbar::-webkit-scrollbar-thumb:active {\n          background: #9ca3af;\n        }\n      `}</style>\n    </div>\n  );\n};\n\n// 간단한 프롬프트 카드 컴포넌트\nconst PromptCard = ({ card, onEdit, onDelete }) => {\n  return (\n    <div className=\"bg-white dark:bg-gray-600 rounded-xl p-4 flex flex-col space-y-3 shadow-md dark:shadow-lg hover:shadow-lg dark:hover:shadow-xl transition-all duration-200 hover:bg-blue-50 dark:hover:bg-gray-500\">\n      {/* Header: Title and Actions */}\n      <div className=\"flex items-start justify-between\">\n        <h3 className=\"font-semibold text-sm text-gray-800 dark:text-white leading-tight pr-2 flex-1\">\n          {card.title || `프롬프트 ${card.promptId || card.prompt_id}`}\n        </h3>\n        <div className=\"flex items-center flex-shrink-0\">\n          <button\n            onClick={async (e) => {\n              e.preventDefault();\n              e.stopPropagation();\n              await onEdit();\n            }}\n            className=\"p-1 text-gray-500 dark:text-gray-400 rounded-full hover:bg-gray-100 dark:hover:bg-dark-secondary hover:text-blue-600 dark:hover:text-blue-400 transition-colors\"\n          >\n            <PencilIcon className=\"h-4 w-4\" />\n          </button>\n          <button\n            onClick={onDelete}\n            className=\"p-1 text-gray-500 dark:text-gray-400 rounded-full hover:bg-gray-100 dark:hover:bg-dark-secondary hover:text-red-600 dark:hover:text-red-400 transition-colors\"\n          >\n            <TrashIcon className=\"h-4 w-4\" />\n          </button>\n        </div>\n      </div>\n\n      {/* Tags */}\n      {card.tags && card.tags.length > 0 && (\n        <div className=\"flex flex-wrap gap-1.5\">\n          {card.tags.slice(0, 3).map((tag) => (\n            <span\n              key={tag}\n              className=\"px-2 py-0.5 text-xs bg-gray-100 dark:bg-dark-secondary text-gray-700 dark:text-gray-300 rounded-full\"\n            >\n              #{tag}\n            </span>\n          ))}\n          {card.tags.length > 3 && (\n            <span className=\"text-xs text-gray-500 dark:text-gray-400\">\n              +{card.tags.length - 3}\n            </span>\n          )}\n        </div>\n      )}\n\n      {/* Content Snippet */}\n      {(card.content || card.prompt_text) && (\n        <p className=\"text-xs text-gray-600 dark:text-gray-300 leading-relaxed line-clamp-2\">\n          {card.content || card.prompt_text}\n        </p>\n      )}\n\n      {/* Date */}\n      <div className=\"flex items-end justify-between pt-2 text-xs text-gray-400 dark:text-gray-500\">\n        <span className=\"flex-shrink-0\">\n          생성:{\" \"}\n          {new Date(card.createdAt || new Date()).toLocaleDateString(\"ko-KR\", {\n            year: \"2-digit\",\n            month: \"2-digit\",\n            day: \"2-digit\",\n          })}\n        </span>\n        {card.updatedAt &&\n          new Date(card.updatedAt) > new Date(card.createdAt) && (\n            <span className=\"flex-shrink-0 ml-2\">\n              수정:{\" \"}\n              {new Date(card.updatedAt).toLocaleDateString(\"ko-KR\", {\n                year: \"2-digit\",\n                month: \"2-digit\",\n                day: \"2-digit\",\n              })}\n            </span>\n          )}\n      </div>\n    </div>\n  );\n};\n\n// 간단한 프롬프트 편집 폼 모달\nconst PromptFormModal = ({ isOpen, onSubmit, onCancel, initialData }) => {\n  const [formData, setFormData] = useState({\n    title: \"\",\n    prompt_text: \"\",\n    tags: [],\n    enabled: true,\n  });\n  const [tagInput, setTagInput] = useState(\"\");\n\n  useEffect(() => {\n    if (initialData) {\n      setFormData({\n        title: initialData.title || \"\",\n        prompt_text: initialData.prompt_text || initialData.content || \"\",\n        tags: Array.isArray(initialData.tags) ? [...initialData.tags] : [],\n        enabled:\n          initialData.enabled !== false && initialData.isActive !== false, // isActive도 체크\n      });\n    }\n  }, [initialData]);\n\n  const handleSubmit = (e) => {\n    e.preventDefault();\n    if (!formData.prompt_text.trim()) {\n      toast.error(\"프롬프트 내용을 입력해주세요\");\n      return;\n    }\n    onSubmit(formData);\n  };\n\n  const handleChange = (field, value) => {\n    setFormData((prev) => ({ ...prev, [field]: value }));\n  };\n\n  const handleTagAdd = (e) => {\n    if (e.key === \"Enter\" && tagInput.trim()) {\n      e.preventDefault();\n      const newTag = tagInput.trim();\n      if (!formData.tags.includes(newTag) && formData.tags.length < 5) {\n        setFormData((prev) => ({\n          ...prev,\n          tags: [...prev.tags, newTag],\n        }));\n      }\n      setTagInput(\"\");\n    }\n  };\n\n  const handleTagRemove = (tagToRemove) => {\n    setFormData((prev) => ({\n      ...prev,\n      tags: prev.tags.filter((tag) => tag !== tagToRemove),\n    }));\n  };\n\n  if (!isOpen) {\n    return null;\n  }\n\n  return (\n    <div className=\"fixed inset-0 bg-black/50 backdrop-blur-sm z-50 flex items-center justify-center p-4\">\n      <div className=\"bg-white dark:bg-dark-secondary rounded-2xl max-w-3xl w-full max-h-[90vh] overflow-hidden shadow-xl dark:shadow-none transition-colors duration-300 \">\n        {/* 헤더 */}\n        <div className=\" p-6 bg-white dark:bg-dark-secondary\">\n          <div className=\"flex items-center justify-between\">\n            <div className=\"flex items-center space-x-3\">\n              <div className=\"w-10 h-10 bg-gray-100 dark:bg-dark-tertiary rounded-lg flex items-center justify-center\">\n                {initialData ? (\n                  <PencilIcon className=\"h-6 w-6 text-gray-600 dark:text-gray-300\" />\n                ) : (\n                  <PencilIcon className=\"h-6 w-6 text-gray-600 dark:text-gray-300\" />\n                )}\n              </div>\n              <div>\n                <h3 className=\"text-lg font-semibold text-gray-900 dark:text-white\">\n                  {initialData ? \"프롬프트 편집\" : \"새 프롬프트\"}\n                </h3>\n                <p className=\"text-sm text-gray-500 dark:text-gray-400\">\n                  {initialData\n                    ? \"프롬프트 내용을 수정하세요\"\n                    : \"새로운 프롬프트를 작성하세요\"}\n                </p>\n              </div>\n            </div>\n            <button\n              type=\"button\"\n              onClick={onCancel}\n              className=\"p-2 text-gray-400 dark:text-gray-500 hover:text-gray-600 dark:hover:text-gray-300 rounded-lg hover:bg-gray-100 dark:hover:bg-dark-tertiary transition-colors\"\n            >\n              <XMarkIcon className=\"h-5 w-5\" />\n            </button>\n          </div>\n        </div>\n\n        <form\n          onSubmit={handleSubmit}\n          className=\"p-6 space-y-6 overflow-y-auto max-h-[calc(90vh-120px)]\"\n        >\n          {/* 제목 필드 */}\n          <div className=\"space-y-2\">\n            <label className=\"flex items-center text-sm font-semibold text-gray-800 dark:text-gray-200\">\n              프롬프트 제목\n            </label>\n            <input\n              type=\"text\"\n              value={formData.title}\n              onChange={(e) => handleChange(\"title\", e.target.value)}\n              className=\"w-full px-4 py-3  rounded-xl bg-gray-50 dark:bg-dark-tertiary text-gray-900 dark:text-white placeholder-gray-500 dark:placeholder-gray-400 focus:outline-none focus:border-blue-500 focus:ring-2 focus:ring-blue-500/20 dark:focus:ring-blue-500/30 transition-all duration-200\"\n              placeholder=\"프롬프트 제목을 입력하세요\"\n            />\n          </div>\n\n          {/* 해시태그 */}\n          <div className=\"space-y-2\">\n            <label className=\"flex items-center text-sm font-semibold text-gray-800 dark:text-gray-200\">\n              <HashtagIcon className=\"h-4 w-4 mr-2 text-gray-500 dark:text-gray-400\" />\n              태그\n            </label>\n            <div className=\"space-y-3\">\n              {/* 태그 입력 */}\n              <input\n                type=\"text\"\n                value={tagInput}\n                onChange={(e) => setTagInput(e.target.value)}\n                onKeyPress={handleTagAdd}\n                className=\"w-full px-4 py-3  rounded-xl bg-gray-50 dark:bg-dark-tertiary text-gray-900 dark:text-white placeholder-gray-500 dark:placeholder-gray-400 focus:outline-none focus:border-blue-500 focus:ring-2 focus:ring-blue-500/20 dark:focus:ring-blue-500/30 transition-all duration-200\"\n                placeholder=\"태그를 입력하고 Enter를 누르세요 (최대 5개)\"\n                maxLength={20}\n                disabled={formData.tags.length >= 5}\n              />\n\n              {/* 태그 목록 */}\n              {formData.tags.length > 0 && (\n                <div className=\"flex flex-wrap gap-2\">\n                  {formData.tags.map((tag, index) => (\n                    <span\n                      key={index}\n                      className=\"inline-flex items-center px-3 py-1 bg-blue-100 dark:bg-blue-900 text-blue-800 dark:text-blue-200 text-sm rounded-full\"\n                    >\n                      #{tag}\n                      <button\n                        type=\"button\"\n                        onClick={() => handleTagRemove(tag)}\n                        className=\"ml-2 text-blue-600 dark:text-blue-400 hover:text-blue-800 dark:hover:text-blue-200\"\n                      >\n                        <XMarkIcon className=\"h-3 w-3\" />\n                      </button>\n                    </span>\n                  ))}\n                </div>\n              )}\n\n              {/* 도움말 텍스트 */}\n              <p className=\"text-xs text-gray-500 dark:text-gray-400\">\n                태그는 프롬프트를 분류하고 검색하는 데 도움이 됩니다. 각 태그는\n                20자 이내로 입력하세요.\n              </p>\n            </div>\n          </div>\n\n          {/* 프롬프트 내용 */}\n          <div className=\"space-y-2\">\n            <label className=\"flex items-center text-sm font-semibold text-gray-800 dark:text-gray-200\">\n              프롬프트 내용 <span className=\"text-red-500 ml-1\">*</span>\n            </label>\n            <div className=\"relative\">\n              <textarea\n                value={formData.prompt_text}\n                onChange={(e) => handleChange(\"prompt_text\", e.target.value)}\n                rows={12}\n                className=\"w-full px-4 py-3  rounded-xl bg-gray-50 dark:bg-dark-tertiary text-gray-900 dark:text-white placeholder-gray-500 dark:placeholder-gray-400 focus:outline-none focus:border-green-500 focus:ring-2 focus:ring-green-500/20 dark:focus:ring-green-500/30 transition-all duration-200 resize-none\"\n                placeholder=\"프롬프트 내용을 입력하세요\"\n                required\n              />\n              <div className=\"absolute bottom-3 right-3 text-xs text-gray-500 dark:text-gray-400 flex items-center space-x-2\">\n                <span>{formData.prompt_text.length} 자</span>\n                <span className=\"text-gray-400 dark:text-gray-500\">\n                  / 📝 50자 이상 권장\n                </span>\n              </div>\n            </div>\n          </div>\n\n          {/* 활성화 옵션 */}\n          <div className=\"flex items-center\">\n            <input\n              type=\"checkbox\"\n              id=\"enabled\"\n              checked={formData.enabled}\n              onChange={(e) => handleChange(\"enabled\", e.target.checked)}\n              className=\"h-4 w-4 text-blue-600 focus:ring-blue-500 rounded\"\n            />\n            <label\n              htmlFor=\"enabled\"\n              className=\"ml-2 text-sm text-gray-700 dark:text-gray-300\"\n            >\n              활성화\n            </label>\n          </div>\n\n          {/* 버튼 영역 */}\n          <div className=\"flex justify-end space-x-3 pt-6 \">\n            <button\n              type=\"button\"\n              onClick={onCancel}\n              className=\"px-6 py-2.5 text-gray-700 dark:text-gray-300 bg-gray-100 dark:bg-gray-700  rounded-lg hover:bg-gray-200 dark:hover:bg-gray-600 transition-colors font-medium\"\n            >\n              취소\n            </button>\n            <button\n              type=\"submit\"\n              disabled={!formData.prompt_text.trim()}\n              className=\"px-6 py-2.5 bg-gradient-to-r from-blue-600 to-blue-700 hover:from-blue-700 hover:to-blue-800 text-white rounded-lg disabled:opacity-50 disabled:cursor-not-allowed transition-all duration-200 font-medium shadow-lg hover:shadow-xl\"\n            >\n              {initialData ? \"수정\" : \"생성\"}\n            </button>\n          </div>\n        </form>\n      </div>\n    </div>\n  );\n};\n\nexport default PromptCardManager;\n","import React from \"react\";\nimport PromptCardManager from \"./PromptCardManager\";\n\nconst AdminView = ({ projectId, projectName }) => {\n  return (\n    <div className=\"h-full w-full bg-white dark:bg-dark-primary transition-colors duration-300\">\n      <PromptCardManager projectId={projectId} projectName={projectName} />\n    </div>\n  );\n};\n\nexport default AdminView;\n","import React, { useState, useEffect } from \"react\";\nimport { promptCardAPI } from \"../services/api\";\nimport ChatWindow from \"./chat/ChatWindow\";\nimport { ChatInterfaceSkeleton } from \"./skeleton/SkeletonComponents\";\n\nconst UserView = ({ projectId, projectName }) => {\n  const [promptCards, setPromptCards] = useState([]);\n  const [loading, setLoading] = useState(true);\n\n  useEffect(() => {\n    const loadPromptCards = async () => {\n      try {\n        setLoading(true);\n        // AdminView와 동일하게 includeContent=true로 설정하여 프롬프트 내용을 포함하여 로드\n        const response = await promptCardAPI.getPromptCards(projectId, true);\n        // 응답 구조가 AdminView와 동일하게 처리\n        setPromptCards(response.promptCards || []);\n      } catch (error) {\n        console.warn(\"프롬프트 카드 로드 실패:\", error);\n        setPromptCards([]);\n      } finally {\n        setLoading(false);\n      }\n    };\n\n    loadPromptCards();\n  }, [projectId]);\n\n  if (loading) {\n    return <ChatInterfaceSkeleton />;\n  }\n\n  return (\n    <div className=\"h-screen bg-white dark:bg-dark-primary transition-colors duration-300\">\n      <ChatWindow\n        projectId={projectId}\n        projectName={projectName}\n        promptCards={promptCards}\n      />\n    </div>\n  );\n};\n\nexport default UserView;\n","import React, { useState, useEffect } from \"react\";\nimport { useParams, useNavigate } from \"react-router-dom\";\nimport { toast } from \"react-hot-toast\";\nimport { projectAPI, handleAPIError } from \"../services/api\";\nimport AdminView from \"./AdminView\";\nimport UserView from \"./UserView\";\nimport { useAuth } from \"../contexts/AuthContext\";\nimport { ChatInterfaceSkeleton } from \"./skeleton/SkeletonComponents\";\n\nconst ProjectDetail = () => {\n  const { projectId } = useParams();\n  const navigate = useNavigate();\n  const { user } = useAuth();\n  const [project, setProject] = useState(null);\n  const [loading, setLoading] = useState(true);\n\n  useEffect(() => {\n    loadProjectData();\n  }, [projectId, navigate]);\n\n  const loadProjectData = async () => {\n    try {\n      setLoading(true);\n\n      // 일반 사용자인 경우 고정된 프로젝트나 기본 프로젝트를 사용\n      let projectData;\n      if (user?.role === \"user\") {\n        // 일반 사용자용 기본 프로젝트 사용\n        if (projectId && projectId !== \"default\") {\n          try {\n            projectData = await projectAPI.getProject(projectId);\n          } catch (error) {\n            console.log(\"API 호출 실패, 기본 프로젝트 사용:\", error);\n            projectData = {\n              projectId: \"chat\",\n              name: \"AI 채팅\",\n              description: \"AI와 자유롭게 대화하세요\",\n              promptCards: [],\n              createdAt: new Date().toISOString(),\n              updatedAt: new Date().toISOString(),\n            };\n          }\n        } else {\n          // 기본 프로젝트 직접 생성\n          projectData = {\n            projectId: \"chat\",\n            name: \"AI 채팅\",\n            description: \"AI와 자유롭게 대화하세요\",\n            promptCards: [],\n            createdAt: new Date().toISOString(),\n            updatedAt: new Date().toISOString(),\n          };\n        }\n      } else {\n        // 관리자인 경우\n        try {\n          projectData = await projectAPI.getProject(projectId);\n        } catch (error) {\n          console.error(\"관리자 프로젝트 로드 실패:\", error);\n          throw error; // 관리자는 에러를 그대로 전파\n        }\n      }\n\n      setProject(projectData);\n    } catch (error) {\n      console.error(\"프로젝트 로드 실패:\", error);\n      const errorInfo = handleAPIError(error);\n      toast.error(errorInfo.message);\n\n      // 권한에 따른 리다이렉트\n      if (user?.role === \"admin\") {\n        navigate(\"/projects\");\n      } else {\n        navigate(\"/dashboard\");\n      }\n    } finally {\n      setLoading(false);\n    }\n  };\n\n  if (loading) {\n    return <ChatInterfaceSkeleton />;\n  }\n\n  if (!project) {\n    return (\n      <div className=\"min-h-screen bg-gray-50 dark:bg-gray-900 flex items-center justify-center transition-colors duration-200\">\n        <div className=\"text-center\">\n          <h2 className=\"text-xl font-semibold text-gray-900 dark:text-white mb-4\">\n            프로젝트를 찾을 수 없습니다\n          </h2>\n          <button\n            onClick={() => {\n              if (user?.role === \"admin\") {\n                navigate(\"/projects\");\n              } else {\n                navigate(\"/dashboard\");\n              }\n            }}\n            className=\"inline-flex items-center px-4 py-2 text-sm font-medium rounded-md text-blue-700 dark:text-blue-300 bg-blue-100 dark:bg-blue-900 hover:bg-blue-200 dark:hover:bg-blue-800 focus:outline-none transition-colors duration-200\"\n          >\n            {user?.role === \"admin\" ? \"프로젝트 목록으로\" : \"대시보드로\"}\n          </button>\n        </div>\n      </div>\n    );\n  }\n\n  return (\n    <div className=\"min-h-screen w-full bg-gray-50 dark:bg-dark-primary transition-all duration-500\">\n      {user?.role === \"admin\" ? (\n        // 관리자 모드: 프롬프트 카드 관리 + 채팅\n        <AdminView\n          projectId={project.projectId || projectId}\n          projectName={project.name}\n        />\n      ) : (\n        // 사용자 모드: 채팅만\n        <UserView\n          projectId={project.projectId || projectId}\n          projectName={project.name}\n        />\n      )}\n    </div>\n  );\n};\n\nexport default ProjectDetail;\n"],"names":["_ref","isOpen","onClose","className","onCollapsedChange","conversations","loading","error","hasMore","loadMore","createConversation","deleteConversation","useConversations","setConversations","useState","setLoading","setError","setHasMore","nextCursor","setNextCursor","loadConversations","useCallback","async","reset","arguments","length","undefined","cursor","response","conversationAPI","getConversations","prev","err","_err$response","_err$response2","_err$response3","_err$response4","console","message","status","data","config","errorMessage","code","log","mockConversations","title","newConversation","id","conversationId","startedAt","lastActivityAt","tokenSum","mockConversation","Date","now","toString","toISOString","updateConversation","updates","map","conv","warn","filter","removeConversation","refresh","useEffect","currentConversationId","setCurrentConversation","useConversationContext","isCreating","setIsCreating","isCollapsed","setIsCollapsed","createError","setCreateError","deletingId","setDeletingId","deleteError","setDeleteError","activeMenuId","setActiveMenuId","editingId","setEditingId","editingTitle","setEditingTitle","conversationListRef","useRef","current","scrollTop","scrollHeight","handleClickOutside","event","target","closest","document","addEventListener","removeEventListener","handleNewChat","window","innerWidth","setTimeout","handleSaveEdit","trim","handleCancelEdit","conversationGroups","groups","today","yesterday","setDate","getDate","forEach","conversation","date","createdAt","isToday","toDateString","isYesterday","key","toLocaleDateString","year","month","push","groupConversationsByDate","_jsxs","_Fragment","children","_jsx","onClick","style","overscrollBehavior","newCollapsed","xmlns","fill","viewBox","strokeWidth","stroke","strokeLinecap","strokeLinejoin","d","disabled","ref","onScroll","e","stopPropagation","jsx","Array","_","i","Object","entries","_ref2","groupTitle","groupConversations","type","value","onChange","onKeyPress","autoFocus","handleSelectConversation","handleToggleMenu","handleStartEdit","currentTitle","confirm","remainingConversations","handleDeleteConversation","MODELS","name","provider","category","speed","quality","description","recommended","new","selectedModel","onModelChange","setIsOpen","setFilter","currentModel","find","model","filteredModels","toLowerCase","SparklesIcon","replace","ChevronDownIcon","label","filterOption","handleModelSelect","modelId","copyToClipboard","text","successMessage","navigator","clipboard","writeText","toast","success","getAgentName","agentType","journalism","balanced","click","seo","social","formatMultiAgentContent","agentSummary","allTitles","content","index","agent","agentName","titles","tokenCount","useChat","projectId","projectName","promptCards","user","useAuth","isFirstRender","promptCardsLength","userId","messages","setMessages","inputValue","setInputValue","copiedMessage","setCopiedMessage","canSendMessage","setCanSendMessage","inputHeight","setInputHeight","setSelectedModel","streamingMessageIdRef","currentWebSocketRef","currentExecutionIdRef","messagesEndRef","inputRef","isUserScrolling","setIsUserScrolling","scrollContainerRef","lastScrollTopRef","isExecuting","isGenerating","isStreaming","executeOrchestration","resetOrchestration","setIsExecuting","currentExecution","setCurrentExecution","executionStatus","setExecutionStatus","setIsStreaming","userInput","options","chat_history","prompt_cards","inputLength","historyLength","promptCardsCount","useStreaming","timestamp","onChunk","onError","_error$message","_error$message2","_error$message3","_error$message4","includes","onComplete","_response$result","resultLength","result","generateAPI","generateTitleStream","streamError","generateTitle","mode","_error$response","_error$response2","_error$message5","_error$response3","_error$response4","_error$response4$data","_error$response5","_error$response6","_error$response7","setup_required","pollOrchestrationResult","executionArn","poll","getExecutionStatus","Error","useOrchestration","isConnected","wsConnected","isConnecting","wsConnecting","wsError","startStreaming","wsStartStreaming","addMessageListener","removeMessageListener","setIsConnected","setIsConnecting","wsRef","reconnectTimeoutRef","reconnectAttempts","getWebSocketUrl","wsUrl","process","startsWith","normalizedUrl","_session$tokens","_session$tokens$idTok","fetchAuthSession","session","token","tokens","idToken","encodeURIComponent","authError","connect","_wsRef$current","_wsRef$current2","readyState","WebSocket","OPEN","CONNECTING","close","wsConnectStart","connectionTimeout","_wsRef$current3","onopen","_wsRef$current4","_wsRef$current5","_wsRef$current6","clearTimeout","url","protocol","extensions","onclose","connectionDuration","reason","wasClean","delay","Math","min","pow","onerror","_wsRef$current7","_wsRef$current8","disconnect","sendMessage","_wsRef$current9","send","JSON","stringify","chatHistory","userSub","action","listener","timer","prevProjectIdRef","useWebSocket","handleScroll","container","currentScrollTop","maxScrollTop","clientHeight","abs","scrollToBottom","scrollIntoView","behavior","handleWebSocketMessage","_data$message7","parse","currentStreamingId","step","progress","updatedMessages","streamingMsgIndex","findIndex","msg","messagesLength","currentContent","isLoading","m","fullContent","_data$message","_data$message2","_data$message3","_data$message4","_data$message5","_data$message6","errorContent","isError","toastMessage","handleStreamingResponse","chunk","metadata","handleStreamingComplete","performance_metrics","model_info","handleStopGeneration","adjustInputHeight","lines","split","charBasedLines","ceil","estimatedLines","max","calculatedHeight","handleInputChange","handleSendMessage","userMessage","streamMsgId","streamingMessage","allMessages","role","trimmedChatHistory","slice","totalMessages","fullHistoryLength","trimmedHistoryLength","maxHistoryLength","recentHistory","activePromptCards","isArray","card","isActive","enabled","promptId","prompt_id","prompt_text","tags","stepOrder","sort","a","b","messageContent","chatHistoryLength","contentLength","hasContent","crewAPI","createCrewInstance","instanceError","_instanceError$respon","shouldRedirect","handleAPIError","multiAgentResult","executeMultiAgent","assistantMessage","agentResults","finalTitles","tokenUsage","keys","agentResult","values","flat","isMultiAgent","processMultiAgentResponse","errorUserMessage","errorDetails","handleKeyPress","shiftKey","preventDefault","handleCopyMessage","messageId","handleCopyTitle","resetChat","streamingMessageId","formatTimestamp","toLocaleTimeString","hour","minute","hour12","isNaN","getTime","onCopyMessage","onCopyTitle","isUser","likeClicked","setLikeClicked","dislikeClicked","setDislikeClicked","copyClicked","setCopyClicked","ExclamationTriangleIcon","animationDelay","ReactMarkdown","handleLikeClick","handleDislikeClick","sidebarCollapsed","setSidebarCollapsed","addMessage","historicalMessages","messagesLoading","loadMessages","currentMessagesCount","_response$messages","getMessages","messagesReceived","conversationMessages","mockMessages","mockMessagesCount","newMessage","updateMessage","removeMessage","loadPreviousMessages","Promise","resolve","clearMessages","previousConversationId","useMessages","chatMessages","originalHandleSendMessage","messageData","ConversationDrawer","SimpleChatMessage","ChatBubbleLeftRightIcon","placeholder","rows","height","minHeight","maxHeight","lineHeight","overflowY","StopIcon","PaperAirplaneIcon","ModelSelector","PromptCard","onEdit","onDelete","PencilIcon","TrashIcon","tag","day","updatedAt","PromptFormModal","_ref3","onSubmit","onCancel","initialData","formData","setFormData","tagInput","setTagInput","handleChange","field","XMarkIcon","HashtagIcon","newTag","maxLength","handleTagRemove","tagToRemove","required","checked","htmlFor","setPromptCards","editingCard","setEditingCard","showForm","setShowForm","loadPromptCards","promptCardAPI","getPromptCards","errorInfo","handleNewCard","ChatWindow","PlusIcon","cardWithContent","_contentResponse$cont","contentResponse","getPromptContent","handleEditCard","deletePromptCard","handleDeleteCard","backendData","cardData","updatePromptCard","createPromptCard","handleCancelForm","PromptCardManager","ChatInterfaceSkeleton","ProjectDetail","useParams","navigate","useNavigate","project","setProject","loadProjectData","projectData","projectAPI","getProject","AdminView","UserView"],"sourceRoot":""}