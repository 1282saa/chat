"use strict";(self.webpackChunkbedrock_diy_frontend=self.webpackChunkbedrock_diy_frontend||[]).push([[451],{1451:(e,t,r)=>{r.r(t),r.d(t,{default:()=>P});var s=r(5043),n=r(3216),a=r(3768),o=r(4505),l=r(8662),i=r(7985),c=r(2811),d=r(9248),u=r(7591),m=r(6214),g=r(3063),x=r(2302),h=r(7438);const p=()=>{const[e,t]=(0,s.useState)([]),[r,n]=(0,s.useState)(!1),[a,l]=(0,s.useState)(null),[i,c]=(0,s.useState)(!0),[d,u]=(0,s.useState)(null),m=(0,s.useCallback)(async function(){let e=arguments.length>0&&void 0!==arguments[0]&&arguments[0];if(!r){n(!0),l(null);try{const r=e?null:d,s=await o.Em.getConversations(r);t(e?s.conversations:e=>[...e,...s.conversations]),c(s.hasMore),u(s.nextCursor)}catch(g){var s,a,i,m;console.error("\ub300\ud654 \ubaa9\ub85d \ub85c\ub4dc \uc2e4\ud328:",g),console.error("Error details:",{message:g.message,status:null===(s=g.response)||void 0===s?void 0:s.status,data:null===(a=g.response)||void 0===a?void 0:a.data,config:g.config});let r="\ub300\ud654 \ubaa9\ub85d\uc744 \ubd88\ub7ec\uc624\ub294\ub370 \uc2e4\ud328\ud588\uc2b5\ub2c8\ub2e4.";"ERR_NETWORK"===g.code?r="\ub124\ud2b8\uc6cc\ud06c \uc5f0\uacb0\uc744 \ud655\uc778\ud574\uc8fc\uc138\uc694.":403===(null===(i=g.response)||void 0===i?void 0:i.status)?r="\uc811\uadfc \uad8c\ud55c\uc774 \uc5c6\uc2b5\ub2c8\ub2e4.":(null===(m=g.response)||void 0===m?void 0:m.status)>=500&&(r="\uc11c\ubc84 \uc624\ub958\uac00 \ubc1c\uc0dd\ud588\uc2b5\ub2c8\ub2e4. \uc7a0\uc2dc \ud6c4 \ub2e4\uc2dc \uc2dc\ub3c4\ud574\uc8fc\uc138\uc694."),l(r),e&&(console.log("API \uc2e4\ud328, mock \ub370\uc774\ud130 \uc0ac\uc6a9"),t(o.TZ),c(!1),u(null))}finally{n(!1)}}},[r,d]),g=(0,s.useCallback)(async e=>{try{const r=await o.Em.createConversation(e),s={id:r.conversationId,title:r.title,startedAt:r.startedAt,lastActivityAt:r.lastActivityAt,tokenSum:0};return t(e=>[s,...e]),s}catch(r){console.error("\ub300\ud654 \uc0dd\uc131 \uc2e4\ud328:",r);const s={id:Date.now().toString(),title:e||"New Conversation",startedAt:(new Date).toISOString(),lastActivityAt:(new Date).toISOString(),tokenSum:0};return t(e=>[s,...e]),s}},[]),x=(0,s.useCallback)((e,r)=>{t(t=>t.map(t=>t.id===e?{...t,...r,lastActivityAt:(new Date).toISOString()}:t))},[]),h=(0,s.useCallback)(async e=>{try{await o.Em.deleteConversation(e),console.log("API \uc0ad\uc81c \uc131\uacf5:",e)}catch(r){console.warn("API \uc0ad\uc81c \uc2e4\ud328, \ub85c\uceec\uc5d0\uc11c\ub9cc \uc0ad\uc81c:",r)}return t(t=>t.filter(t=>t.id!==e)),!0},[]),p=(0,s.useCallback)(e=>{t(t=>t.filter(t=>t.id!==e))},[]),b=(0,s.useCallback)(()=>{i&&!r&&m(!1)},[i,r,m]),v=(0,s.useCallback)(()=>{m(!0)},[m]);return(0,s.useEffect)(()=>{m(!0)},[]),{conversations:e,loading:r,error:a,hasMore:i,loadMore:b,refresh:v,createConversation:g,updateConversation:x,deleteConversation:h,removeConversation:p}};var b=r(8455),v=r(579);const f=e=>{let{isOpen:t,onClose:r,className:n="",onCollapsedChange:a}=e;const{conversations:l,loading:i,error:c,hasMore:d,loadMore:u,createConversation:m,deleteConversation:g,updateConversation:x}=p(),{currentConversationId:h,setCurrentConversation:f}=(0,b.g)(),[y,k]=(0,s.useState)(!1),[w,j]=(0,s.useState)(!1),[N,C]=(0,s.useState)(null),[S,I]=(0,s.useState)(null),[L,E]=(0,s.useState)(null),[D,A]=(0,s.useState)(null),[M,R]=(0,s.useState)(null),[O,T]=(0,s.useState)(""),W=(0,s.useRef)(null);(0,s.useEffect)(()=>{W.current&&l.length>0&&!w&&(W.current.scrollTop=W.current.scrollHeight)},[l.length,w]),(0,s.useEffect)(()=>{const e=e=>{D&&!e.target.closest(".conversation-menu")&&A(null)};return document.addEventListener("mousedown",e),()=>{document.removeEventListener("mousedown",e)}},[D]);const _=async()=>{if(!y){k(!0),C(null);try{console.log("\ud83d\udd0d [DEBUG] \uc0c8 \ub300\ud654 \uc0dd\uc131 \uc2dc\uc791");const e=await m("\uc0c8 \ub300\ud654");console.log("\ud83d\udd0d [DEBUG] \uc0c8 \ub300\ud654 \uc0dd\uc131 \uc644\ub8cc:",{newConversation:e,conversationId:null===e||void 0===e?void 0:e.id,conversationIdType:typeof(null===e||void 0===e?void 0:e.id),isConversationIdNull:null===(null===e||void 0===e?void 0:e.id),isConversationIdUndefined:void 0===(null===e||void 0===e?void 0:e.id)}),console.log("\ud83d\udd0d [DEBUG] setCurrentConversation \ud638\ucd9c \uc804 - \ud604\uc7ac ID:",h),f(e.id),console.log("\ud83d\udd0d [DEBUG] setCurrentConversation \ud638\ucd9c \uc644\ub8cc - \uc0c8 ID:",e.id),window.innerWidth<768&&r()}catch(c){console.error("\uc0c8 \ub300\ud654 \uc0dd\uc131 \uc2e4\ud328:",c),C("\uc0c8 \ub300\ud654\ub97c \uc0dd\uc131\ud560 \uc218 \uc5c6\uc2b5\ub2c8\ub2e4. \ub2e4\uc2dc \uc2dc\ub3c4\ud574\uc8fc\uc138\uc694."),setTimeout(()=>C(null),3e3)}finally{k(!1)}}},B=async e=>{if(!O.trim())return R(null),void T("");try{console.log("\ub300\ud654 \uc81c\ubaa9 \uc5c5\ub370\uc774\ud2b8:",e,O),await o.Em.updateConversation(e,{title:O}),x(e,{title:O}),R(null),T(""),console.log("\ub300\ud654 \uc81c\ubaa9 \uc218\uc815 \uc644\ub8cc")}catch(c){console.error("\ub300\ud654 \uc81c\ubaa9 \uc218\uc815 \uc911 \uc624\ub958:",c),alert("\uc81c\ubaa9 \uc218\uc815\uc5d0 \uc2e4\ud328\ud588\uc2b5\ub2c8\ub2e4. \ub2e4\uc2dc \uc2dc\ub3c4\ud574\uc8fc\uc138\uc694.")}},P=()=>{R(null),T("")},U=(e=>{const t={},r=new Date,s=new Date(r);return s.setDate(s.getDate()-1),e.forEach(e=>{const n=new Date(e.lastActivityAt||e.createdAt),a=n.toDateString()===r.toDateString(),o=n.toDateString()===s.toDateString();let l;if(a)l="Today";else if(o)l="Yesterday";else{l=n.toLocaleDateString("ko-KR",{year:"numeric",month:"2-digit"})}t[l]||(t[l]=[]),t[l].push(e)}),t})(l);return(0,v.jsxs)(v.Fragment,{children:[t&&(0,v.jsx)("div",{className:"fixed inset-0 bg-black/40 backdrop-blur-sm z-40 md:hidden transition-opacity duration-300",onClick:r}),(0,v.jsxs)("div",{className:`\n        conversation-drawer\n        fixed top-0 left-0 h-full z-[9999]\n        bg-[#0d1117]\n        border-r border-[#21262d] shadow-[inset_0_0_16px_rgba(0,0,0,0.4)]\n        transform transition-all duration-500 ease-out\n        ${t?"translate-x-0":"-translate-x-full"}\n        md:translate-x-0\n        ${w?"w-14":"w-full md:w-64"}\n        ${n}\n      `,style:{overscrollBehavior:"contain"},children:[!w&&(0,v.jsxs)("div",{className:"flex items-center justify-between p-5 border-b border-[#21262d] relative transition-opacity duration-300 ease-in-out",children:[(0,v.jsx)("h1",{className:"text-xl font-semibold tracking-tight text-[#e6edf3]",children:"TITLE-NOMICS"}),(0,v.jsx)("button",{onClick:()=>{const e=!w;j(e),a&&a(e)},className:"w-10 h-10 py-2 rounded-full bg-transparent hover:bg-[#11161f] transition-colors duration-200 flex items-center justify-center group",title:"\uc0ac\uc774\ub4dc\ubc14 \uc811\uae30",children:(0,v.jsx)("svg",{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:"1.5",stroke:"currentColor",className:"w-6 h-6 text-[#88929d] group-hover:text-[#e6edf3] transition-colors duration-200",children:(0,v.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M18.75 19.5l-7.5-7.5 7.5-7.5m-6 15L5.25 12l7.5-7.5"})})})]}),w&&(0,v.jsx)("div",{className:"p-2 flex justify-center border-b border-[#21262d]",children:(0,v.jsx)("button",{onClick:()=>{const e=!w;j(e),a&&a(e)},className:"w-10 h-10 py-2 rounded-full bg-transparent hover:bg-[#11161f] transition-colors duration-200 flex items-center justify-center group",title:"\uc0ac\uc774\ub4dc\ubc14 \ud3bc\uce58\uae30",children:(0,v.jsx)("svg",{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:"1.5",stroke:"currentColor",className:"w-6 h-6 text-[#88929d] group-hover:text-[#e6edf3] transition-colors duration-200 rotate-180",children:(0,v.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M18.75 19.5l-7.5-7.5 7.5-7.5m-6 15L5.25 12l7.5-7.5"})})})}),!w&&(0,v.jsxs)("div",{className:"p-4 border-b border-[#21262d] transition-opacity duration-300 ease-in-out",children:[(0,v.jsx)("button",{onClick:_,disabled:y,className:"group w-full flex items-center justify-start gap-3 px-3 py-2.5 text-[#e6edf3] hover:bg-[#21262d] disabled:bg-[#374151] rounded-lg text-sm transition-all duration-200 focus:outline-none border border-[#6e7681] hover:border-[#8b949e]",title:"\uc0c8 \ucc44\ud305",children:y?(0,v.jsxs)(v.Fragment,{children:[(0,v.jsx)("div",{className:"flex-shrink-0 w-5 h-5 flex items-center justify-center",children:(0,v.jsx)("div",{className:"animate-spin rounded-full h-4 w-4 border-b-2 border-[#e6edf3]"})}),(0,v.jsx)("span",{className:"font-medium",children:"\uc0dd\uc131 \uc911..."})]}):(0,v.jsxs)(v.Fragment,{children:[(0,v.jsx)("div",{className:"flex-shrink-0 w-5 h-5 flex items-center justify-center",children:(0,v.jsx)("svg",{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:"2",stroke:"currentColor",className:"h-4 w-4 group-hover:scale-110 transition-transform duration-200",children:(0,v.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M12 4.5v15m7.5-7.5h-15"})})}),(0,v.jsx)("span",{className:"font-medium",children:"\uc0c8 \ucc44\ud305"})]})}),(N||L)&&(0,v.jsx)("div",{className:"mt-2 p-2 bg-red-500/10 border border-red-500/20 rounded text-center",children:(0,v.jsx)("p",{className:"text-xs text-red-400",children:N||L})})]}),(0,v.jsxs)("div",{ref:W,className:"flex flex-col gap-0.5 overflow-y-auto h-[calc(100vh-210px)] custom-scrollbar",onScroll:e=>e.stopPropagation(),children:[(0,v.jsx)("style",{jsx:!0,children:"\n            /* CSS Custom Properties for Design System */\n            .conversation-drawer {\n              --color-bg-primary: #0d1117;\n              --color-bg-secondary: #11161f;\n              --color-bg-tertiary: #161b22;\n              --color-border: #21262d;\n              --color-text-primary: #e6edf3;\n              --color-text-secondary: #88929d;\n              --color-accent: #10b981;\n              --color-accent-hover: #059669;\n              --color-danger: #f85149;\n              --shadow-depth: inset 0 0 16px rgba(0, 0, 0, 0.4);\n            }\n\n            .custom-scrollbar::-webkit-scrollbar {\n              width: 8px;\n            }\n            .custom-scrollbar::-webkit-scrollbar-track {\n              background: transparent;\n              border-radius: 4px;\n            }\n            .custom-scrollbar::-webkit-scrollbar-thumb {\n              background: var(--color-border);\n              border-radius: 4px;\n              border: 1px solid var(--color-bg-primary);\n            }\n            .custom-scrollbar::-webkit-scrollbar-thumb:hover {\n              background: #30363d;\n            }\n            .custom-scrollbar::-webkit-scrollbar-thumb:active {\n              background: #484f58;\n            }\n            .custom-scrollbar::-webkit-scrollbar-corner {\n              background: transparent;\n            }\n\n            /* \uc0ac\uc774\ub4dc\ubc14 \uc2a4\ud06c\ub864 \uaca9\ub9ac */\n            .custom-scrollbar {\n              overscroll-behavior: contain;\n              scroll-behavior: smooth;\n            }\n          "}),c&&!w&&(0,v.jsx)("div",{className:"p-4 text-center bg-red-900/30 rounded-lg border border-red-700/50 mb-4",children:(0,v.jsx)("div",{className:"text-red-300 text-sm font-medium",children:c})}),0===l.length&&!i&&!c&&!w&&(0,v.jsxs)("div",{className:"p-6 text-center",children:[(0,v.jsx)("div",{className:"w-12 h-12 mx-auto mb-4 bg-gradient-to-br from-gray-800/50 to-gray-900/50 rounded-2xl flex items-center justify-center shadow-lg border border-gray-700/30",children:(0,v.jsx)("svg",{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:"1.5",stroke:"currentColor",className:"h-6 w-6 text-gray-400",children:(0,v.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M20.25 8.511c.884.284 1.5 1.128 1.5 2.097v4.286c0 1.136-.847 2.1-1.98 2.193-.34.027-.68.052-1.02.072v3.091l-3-3c-1.354 0-2.694-.055-4.02-.163a2.115 2.115 0 0 1-.825-.242m9.345-8.334a2.126 2.126 0 0 0-.476-.095 48.64 48.64 0 0 0-8.048 0c-1.131.094-1.976 1.057-1.976 2.192v4.286c0 .837.46 1.58 1.155 1.951m9.345-8.334V6.637c0-1.621-1.152-3.026-2.76-3.235A48.455 48.455 0 0 0 11.25 3c-2.115 0-4.198.137-6.24.402-1.608.209-2.76 1.614-2.76 3.235v6.226c0 1.621 1.152 3.026 2.76 3.235.577.075 1.157.14 1.74.194V21l4.155-4.155"})})}),(0,v.jsx)("h3",{className:"text-sm font-medium text-white mb-2 drop-shadow",children:"\uc544\uc9c1 \ub300\ud654\uac00 \uc5c6\uc2b5\ub2c8\ub2e4"}),(0,v.jsx)("p",{className:"text-xs text-gray-400 leading-snug opacity-80",children:"\uc0c8 \ub300\ud654\ub97c \uc2dc\uc791\ud574\uc11c AI\uc640 \ub300\ud654\ud574\ubcf4\uc138\uc694!"})]}),i&&0===l.length&&!w&&(0,v.jsx)("div",{className:"flex flex-col gap-1",children:[...Array(5)].map((e,t)=>(0,v.jsx)("div",{className:"w-full h-10 px-3 bg-gray-900/40 animate-pulse flex items-center",children:(0,v.jsx)("div",{className:"h-3 bg-gray-700/40 rounded w-3/4"})},t))}),!w&&l.length>0&&(0,v.jsx)("div",{className:"flex flex-col gap-1 transition-opacity duration-300 ease-in-out",children:Object.entries(U).map(e=>{let[t,s]=e;return(0,v.jsxs)("div",{children:[(0,v.jsx)("div",{className:"text-xs text-white/40 uppercase tracking-wide py-2 px-3 font-medium",children:t}),s.map(e=>(0,v.jsx)("div",{className:`\n                        flex items-center justify-between h-10 px-3 py-2 text-sm transition-colors duration-200 relative\n                        ${h===e.id?"bg-[#161b22] text-[#e6edf3] relative before:absolute before:left-0 before:top-0 before:bottom-0 before:w-[2px] before:bg-[#10b981]":"text-[#88929d] hover:bg-[#11161f] hover:text-[#e6edf3]"}\n                      `,children:M===e.id?(0,v.jsxs)("div",{className:"flex-1 flex items-center gap-2",children:[(0,v.jsx)("input",{type:"text",value:O,onChange:e=>T(e.target.value),onKeyPress:t=>{"Enter"===t.key?B(e.id):"Escape"===t.key&&P()},className:"flex-1 bg-[#0d1117] border border-[#21262d] rounded px-2 py-1 text-sm text-[#e6edf3] focus:outline-none focus:border-[#10b981]",autoFocus:!0}),(0,v.jsx)("button",{onClick:()=>B(e.id),className:"p-1 text-[#10b981] hover:bg-[#161b22] rounded",title:"\uc800\uc7a5",children:(0,v.jsx)("svg",{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:"2",stroke:"currentColor",className:"h-4 w-4",children:(0,v.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"m4.5 12.75 6 6 9-13.5"})})}),(0,v.jsx)("button",{onClick:P,className:"p-1 text-[#88929d] hover:text-[#f85149] hover:bg-[#161b22] rounded",title:"\ucde8\uc18c",children:(0,v.jsx)("svg",{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:"2",stroke:"currentColor",className:"h-4 w-4",children:(0,v.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M6 18L18 6M6 6l12 12"})})})]}):(0,v.jsxs)(v.Fragment,{children:[(0,v.jsx)("button",{onClick:()=>{return t=e.id,f(t),void(window.innerWidth<768&&r());var t},className:"flex-1 text-left truncate focus:outline-none py-2",title:e.title,children:(0,v.jsx)("span",{className:"truncate text-sm font-medium",children:e.title||"\uc0c8 \ub300\ud654"})}),(0,v.jsxs)("div",{className:"conversation-menu relative",children:[(0,v.jsx)("button",{onClick:t=>{return r=e.id,t.stopPropagation(),void A(D===r?null:r);var r},className:"ml-2 py-2 px-2 text-[#88929d] hover:text-[#e6edf3] transition-colors duration-200 flex-shrink-0 rounded-md hover:bg-[#161b22]",title:"\uba54\ub274",children:(0,v.jsx)("svg",{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:"1.5",stroke:"currentColor",className:"h-5 w-5",children:(0,v.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M6.75 12a.75.75 0 1 1-1.5 0 .75.75 0 0 1 1.5 0ZM12.75 12a.75.75 0 1 1-1.5 0 .75.75 0 0 1 1.5 0ZM18.75 12a.75.75 0 1 1-1.5 0 .75.75 0 0 1 1.5 0Z"})})}),D===e.id&&(0,v.jsxs)("div",{className:"absolute right-0 top-full mt-1 bg-[#21262d] border border-[#30363d] rounded-md shadow-lg z-50 min-w-[120px]",children:[(0,v.jsxs)("button",{onClick:t=>{return r=e.id,s=e.title,t.stopPropagation(),R(r),T(s),void A(null);var r,s},className:"w-full px-3 py-2 text-sm text-[#e6edf3] hover:bg-[#30363d] flex items-center gap-2 transition-colors duration-200",children:[(0,v.jsx)("svg",{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:"1.5",stroke:"currentColor",className:"h-4 w-4",children:(0,v.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"m16.862 4.487 1.687-1.688a1.875 1.875 0 1 1 2.652 2.652L10.582 16.07a4.5 4.5 0 0 1-1.897 1.13L6 18l.8-2.685a4.5 4.5 0 0 1 1.13-1.897l8.932-8.931Zm0 0L19.5 7.125M18 14v4.75A2.25 2.25 0 0 1 15.75 21H5.25A2.25 2.25 0 0 1 3 18.75V8.25A2.25 2.25 0 0 1 5.25 6H10"})}),"\uc218\uc815"]}),(0,v.jsxs)("button",{onClick:t=>(async(e,t)=>{if(t.stopPropagation(),window.confirm("\uc774 \ub300\ud654\ub97c \uc0ad\uc81c\ud558\uc2dc\uaca0\uc2b5\ub2c8\uae4c?")){I(e),E(null),A(null);try{if(await g(e),h===e&&l.length>1){const t=l.filter(t=>t.id!==e);t.length>0&&f(t[0].id)}console.log("\ub300\ud654 \uc0ad\uc81c \uc644\ub8cc:",e)}catch(c){console.error("\ub300\ud654 \uc0ad\uc81c \uc911 \uc624\ub958:",c)}finally{I(null)}}})(e.id,t),disabled:S===e.id,className:"w-full px-3 py-2 text-sm text-[#f85149] hover:bg-[#30363d] flex items-center gap-2 transition-colors duration-200 disabled:opacity-50",children:[S===e.id?(0,v.jsx)("div",{className:"animate-spin rounded-full h-4 w-4 border-b border-[#f85149]"}):(0,v.jsx)("svg",{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:"1.5",stroke:"currentColor",className:"h-4 w-4",children:(0,v.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"m14.74 9-.346 9m-4.788 0L9.26 9m9.968-3.21c.342.052.682.107 1.022.166m-1.022-.165L18.16 19.673a2.25 2.25 0 0 1-2.244 2.077H8.084a2.25 2.25 0 0 1-2.244-2.077L4.772 5.79m14.456 0a48.108 48.108 0 0 0-3.478-.397m-12 .562c.34-.059.68-.114 1.022-.165m0 0a48.11 48.11 0 0 1 3.478-.397m7.5 0v-.916c0-1.18-.91-2.164-2.09-2.201a51.964 51.964 0 0 0-3.32 0c-1.18.037-2.09 1.022-2.09 2.201v.916m7.5 0a48.667 48.667 0 0 0-7.5 0"})}),"\uc0ad\uc81c"]})]})]})]})},e.id))]},t)})}),w&&(0,v.jsx)("div",{className:"flex flex-col items-center p-2 transition-opacity duration-300 ease-in-out",children:(0,v.jsx)("button",{onClick:_,disabled:y,className:"w-10 h-10 bg-[#21262d] hover:bg-[#30363d] disabled:bg-[#374151] text-white rounded-full flex items-center justify-center transition-colors duration-200 focus:outline-none border border-[#30363d] hover:border-[#444c56]",title:"\uc0c8 \ub300\ud654",children:y?(0,v.jsx)("div",{className:"animate-spin rounded-full h-4 w-4 border-b-2 border-white"}):(0,v.jsx)("svg",{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:"2",stroke:"currentColor",className:"h-6 w-6",children:(0,v.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M12 4.5v15m7.5-7.5h-15"})})})})]}),i&&l.length>0&&(0,v.jsx)("div",{className:"p-4 text-center",children:(0,v.jsx)("div",{className:"animate-spin rounded-full h-4 w-4 border-b-2 border-blue-300 mx-auto"})}),d&&!i&&l.length>0&&!w&&(0,v.jsx)("div",{className:"p-4 text-center",children:(0,v.jsx)("button",{onClick:u,className:"text-xs text-white/60 hover:text-white/80 transition-colors duration-200 px-3 py-1.5 hover:bg-gray-800/40 rounded",children:"\ub354 \ubcf4\uae30"})})]})]})};var y=r(2517);const k=[{id:"anthropic.claude-3-5-sonnet-20241022-v2:0",name:"Claude 3.5 Sonnet v2",provider:"Anthropic",category:"premium",speed:"\ube60\ub984",quality:"\ucd5c\uace0",description:"\ud14d\uc2a4\ud2b8 \uc0dd\uc131, \ub2e4\uad6d\uc5b4 \uc9c0\uc6d0, \ubcf5\uc7a1\ud55c \ucd94\ub860\uc5d0 \ucd5c\uc801",recommended:!0},{id:"anthropic.claude-3-5-haiku-20241022-v1:0",name:"Claude 3.5 Haiku",provider:"Anthropic",category:"fast",speed:"\ub9e4\uc6b0 \ube60\ub984",quality:"\uc88b\uc74c",description:"\ube60\ub978 \uc751\ub2f5, \ud14d\uc2a4\ud2b8 \uc0dd\uc131\uc5d0 \ucd5c\uc801\ud654",recommended:!0},{id:"anthropic.claude-sonnet-4-v1:0",name:"Claude Sonnet 4",provider:"Anthropic",category:"premium",speed:"\ubcf4\ud1b5",quality:"\ucd5c\uace0",description:"\ucd5c\uc2e0 \ubaa8\ub378\ub85c \ud5a5\uc0c1\ub41c \ud14d\uc2a4\ud2b8 \uc0dd\uc131, \uc2e4\uc2dc\uac04 \uc9c0\uc6d0",new:!0},{id:"anthropic.claude-opus-4-v1:0",name:"Claude Opus 4",provider:"Anthropic",category:"premium",speed:"\ub290\ub9bc",quality:"\ucd5c\uace0",description:"\ucd5c\uace0 \uc131\ub2a5\uc774 \ud544\uc694\ud55c \ubcf5\uc7a1\ud55c \uc81c\ubaa9 \uc0dd\uc131",new:!0},{id:"anthropic.claude-3-opus-20240229-v1:0",name:"Claude 3 Opus",provider:"Anthropic",category:"premium",speed:"\ub290\ub9bc",quality:"\ucd5c\uace0",description:"\uc774\ubbf8\uc9c0\ub97c \ud14d\uc2a4\ud2b8 \ubc0f \ucf54\ub4dc\ub85c \ubcc0\ud658, \ubcf5\uc7a1\ud55c \ucd94\ub860"},{id:"anthropic.claude-3-sonnet-20240229-v1:0",name:"Claude 3 Sonnet",provider:"Anthropic",category:"balanced",speed:"\ubcf4\ud1b5",quality:"\uc88b\uc74c",description:"\uade0\ud615\uc7a1\ud78c \uc131\ub2a5\uacfc \uc18d\ub3c4"},{id:"anthropic.claude-3-haiku-20240307-v1:0",name:"Claude 3 Haiku",provider:"Anthropic",category:"fast",speed:"\ube60\ub984",quality:"\ubcf4\ud1b5",description:"\ub300\ud654, \ucc44\ud305 \ucd5c\uc801\ud654"},{id:"amazon.nova-pro-v1:0",name:"Nova Pro",provider:"Amazon",category:"balanced",speed:"\ube60\ub984",quality:"\uc88b\uc74c",description:"\ud14d\uc2a4\ud2b8 \uc0dd\uc131, \ucf54\ub4dc \uc0dd\uc131, \ubcf5\uc7a1\ud55c \ucd94\ub860",recommended:!0},{id:"amazon.nova-lite-v1:0",name:"Nova Lite",provider:"Amazon",category:"fast",speed:"\ub9e4\uc6b0 \ube60\ub984",quality:"\ubcf4\ud1b5",description:"\uac00\ubcbc\uc6b4 \ubaa8\ub378\ub85c \ube60\ub978 \uc751\ub2f5, \ub2e4\uad6d\uc5b4 \uc9c0\uc6d0"},{id:"amazon.nova-micro-v1:0",name:"Nova Micro",provider:"Amazon",category:"fast",speed:"\ucd08\uace0\uc18d",quality:"\uae30\ubcf8",description:"\ucd08\uacbd\ub7c9 \ubaa8\ub378\ub85c \ub9e4\uc6b0 \ube60\ub978 \uc751\ub2f5"},{id:"meta.llama3-3-70b-instruct-v1:0",name:"Llama 3.3 70B",provider:"Meta",category:"balanced",speed:"\ubcf4\ud1b5",quality:"\uc88b\uc74c",description:"\ud234 \uc0ac\uc6a9, \ucf54\ub4dc \uc0dd\uc131, \uace0\uae09 \ucd94\ub860"},{id:"meta.llama3-2-3b-instruct-v1:0",name:"Llama 3.2 3B",provider:"Meta",category:"fast",speed:"\ube60\ub984",quality:"\ubcf4\ud1b5",description:"\uacbd\ub7c9 \ubaa8\ub378\ub85c \ube60\ub978 \ucc98\ub9ac"}],w=e=>{let{selectedModel:t,onModelChange:r}=e;const[n,a]=(0,s.useState)(!1),[o,l]=(0,s.useState)("all");console.log("\ud83e\udd16 ModelSelector \ub80c\ub354\ub9c1\ub428:",{selectedModel:t,isOpen:n});const c=k.find(e=>e.id===t)||k[0],d=k.filter(e=>"all"===o||e.provider.toLowerCase()===o);return(0,v.jsxs)("div",{className:"relative",children:[(0,v.jsxs)("button",{onClick:()=>a(!n),className:"flex items-center gap-2 px-3 py-1.5 bg-gray-100 dark:bg-gray-800 rounded-lg hover:bg-gray-200 dark:hover:bg-gray-700 border border-gray-300 dark:border-gray-600 shadow-sm transition-all duration-200 text-xs",title:`${c.name} (${c.provider})`,children:[(0,v.jsx)(i.A,{className:"h-3.5 w-3.5 text-blue-600 dark:text-blue-400"}),(0,v.jsx)("span",{className:"text-gray-700 dark:text-gray-300 font-medium",children:c.name.replace(/Claude |Llama |Nova /,"")}),(0,v.jsx)(y.A,{className:"h-3 w-3 text-gray-500 transition-transform "+(n?"rotate-180":"")})]}),n&&(0,v.jsxs)("div",{className:"absolute bottom-full left-0 mb-2 bg-white dark:bg-dark-secondary  rounded-lg shadow-lg z-50 max-h-[400px] overflow-hidden min-w-[300px]",children:[(0,v.jsx)("div",{className:"p-3 ",children:(0,v.jsx)("div",{className:"flex gap-1 text-xs",children:[{key:"all",label:"\uc804\uccb4"},{key:"anthropic",label:"Anthropic"},{key:"amazon",label:"Amazon"},{key:"meta",label:"Meta"}].map(e=>(0,v.jsx)("button",{onClick:()=>l(e.key),className:"px-2 py-1 rounded transition-colors "+(o===e.key?"bg-blue-100 text-blue-800 dark:bg-blue-900 dark:text-blue-200":"text-gray-600 dark:text-gray-400 hover:bg-gray-100 dark:hover:bg-dark-tertiary"),children:e.label},e.key))})}),(0,v.jsx)("div",{className:"max-h-[300px] overflow-y-auto",children:d.map(e=>(0,v.jsx)("button",{onClick:()=>{return t=e.id,r(t),void a(!1);var t},className:"w-full p-3 text-left hover:bg-gray-50 dark:hover:bg-gray-700 last:border-b-0 transition-colors "+(e.id===t?"bg-blue-50 dark:bg-blue-900/20":""),children:(0,v.jsxs)("div",{className:"flex-1 min-w-0",children:[(0,v.jsx)("div",{className:"mb-1",children:(0,v.jsx)("span",{className:"font-medium text-gray-900 dark:text-white",children:e.name})}),(0,v.jsxs)("div",{className:"text-xs text-gray-500 dark:text-gray-400 mb-1",children:[e.provider," \u2022 \uc18d\ub3c4: ",e.speed," \u2022 \ud488\uc9c8:"," ",e.quality]}),(0,v.jsx)("div",{className:"text-xs text-gray-600 dark:text-gray-400",children:e.description})]})},e.id))})]}),n&&(0,v.jsx)("div",{className:"fixed inset-0 z-40",onClick:()=>a(!1)})]})},j=async function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"\ud074\ub9bd\ubcf4\ub4dc\uc5d0 \ubcf5\uc0ac\ub418\uc5c8\uc2b5\ub2c8\ub2e4!",r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"\ubcf5\uc0ac\uc5d0 \uc2e4\ud328\ud588\uc2b5\ub2c8\ub2e4.";try{return await navigator.clipboard.writeText(e),a.oR.success(t),!0}catch(s){return console.error("\ubcf5\uc0ac \uc2e4\ud328:",s),a.oR.error(r),!1}};var N=r(7656);const C=e=>({journalism:"\ud83d\udcf0 \uc800\ub110\ub9ac\uc998 \ucda9\uc2e4\ud615",balanced:"\u2696\ufe0f \uade0\ud615\uc7a1\ud78c \ud6c4\ud0b9\ud615",click:"\ud83c\udfaf \ud074\ub9ad\uc720\ub3c4\ud615",seo:"\ud83d\udd0d SEO/AEO \ucd5c\uc801\ud654\ud615",social:"\ud83d\udcf1 \uc18c\uc15c\ubbf8\ub514\uc5b4 \uacf5\uc720\ud615"}[e]||`\ud83e\udd16 ${e}`),S=(e,t)=>{let r="\ud83d\ude80 **\uba40\ud2f0-\uc5d0\uc774\uc804\ud2b8 \ubd84\uc11d \uc644\ub8cc**\n\n";return t.length>0&&(r+="\ud83d\udccb **\uc0dd\uc131\ub41c \uc81c\ubaa9 \ubaa9\ub85d:**\n",t.forEach((e,t)=>{r+=`${t+1}. ${e}\n`}),r+="\n"),r+="\ud83d\udd0d **\uc5d0\uc774\uc804\ud2b8\ubcc4 \ubd84\uc11d \uacb0\uacfc:**\n\n",e.forEach(e=>{r+=`### ${e.agentName}\n`,e.titles.length>0&&(r+="**\uc0dd\uc131 \uc81c\ubaa9:**\n",e.titles.forEach(e=>{r+=`\u2022 ${e}\n`})),r+=`**\ud1a0\ud070 \uc0ac\uc6a9\ub7c9:** ${e.tokenCount}\uac1c\n\n`}),r},I=function(e,t){let r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:[],n=arguments.length>3&&void 0!==arguments[3]?arguments[3]:null;const{user:l}=(0,N.A)(),i=(0,s.useRef)(!0);i.current&&(console.log("\ud83d\udd0d [DEBUG] useChat \ucd08\uae30\ud654:",{projectId:e,projectName:t,promptCardsLength:null===r||void 0===r?void 0:r.length,conversationId:n,conversationIdType:typeof n,isConversationIdNull:null===n,isConversationIdUndefined:void 0===n,userId:null===l||void 0===l?void 0:l.id}),i.current=!1),(0,s.useEffect)(()=>{console.log("\ud83d\udd0d [DEBUG] useChat - conversationId \ubcc0\uacbd:",{newConversationId:n,conversationIdType:typeof n,isNull:null===n,isUndefined:void 0===n})},[n]);const[c,d]=(0,s.useState)([]),[u,m]=(0,s.useState)(""),[g,x]=(0,s.useState)(null),[h,p]=(0,s.useState)(!0),[b,v]=(0,s.useState)(24),[f,y]=(0,s.useState)("anthropic.claude-3-5-sonnet-20241022-v2:0"),k=(0,s.useRef)(null),w=(0,s.useRef)(null),I=(0,s.useRef)(null),L=(0,s.useRef)(null),E=(0,s.useRef)(null),[D,A]=(0,s.useState)(!1),M=(0,s.useRef)(null),R=(0,s.useRef)(0),{isExecuting:O,isStreaming:T,executeOrchestration:W,resetOrchestration:_}=(e=>{const[t,r]=(0,s.useState)(!1),[n,l]=(0,s.useState)(null),[i,c]=(0,s.useState)(null),[d,u]=(0,s.useState)(!1),m=(0,s.useCallback)(async function(t){let s=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};if(!t.trim())return a.oR.error("\uba54\uc2dc\uc9c0\ub97c \uc785\ub825\ud574\uc8fc\uc138\uc694."),null;try{r(!0),c("STARTING");const n={userInput:t,chat_history:s.chat_history||[],prompt_cards:s.prompt_cards||[],modelId:s.modelId||null};if(console.log("\ud83d\ude80 \ub300\ud654 \uc0dd\uc131 \uc694\uccad \uc2dc\uc791:",{projectId:e,inputLength:t.length,historyLength:n.chat_history.length,promptCardsCount:n.prompt_cards.length,useStreaming:!0===s.useStreaming,modelId:n.modelId,timestamp:(new Date).toISOString()}),!0===s.useStreaming){u(!0);const t=s.onChunk||(()=>{}),l=e=>{var t,n,o,l;console.error("\ud83d\udd27 \uc2a4\ud2b8\ub9ac\ubc0d \uc624\ub958 \ucc98\ub9ac:",e),r(!1),u(!1),c("FAILED"),null!==(t=e.message)&&void 0!==t&&t.includes("Gateway Timeout")||null!==(n=e.message)&&void 0!==n&&n.includes("504")||"ECONNABORTED"===e.code?a.oR.error("\uc11c\ubc84 \uc751\ub2f5 \uc2dc\uac04\uc774 \ucd08\uacfc\ub418\uc5c8\uc2b5\ub2c8\ub2e4. \uc694\uccad\uc744 \uac04\ub2e8\ud788 \ud558\uac70\ub098 \uc7a0\uc2dc \ud6c4 \ub2e4\uc2dc \uc2dc\ub3c4\ud574\uc8fc\uc138\uc694."):null!==(o=e.message)&&void 0!==o&&o.includes("CORS")||null!==(l=e.message)&&void 0!==l&&l.includes("Network Error")?a.oR.error("\uc11c\ubc84 \uc5f0\uacb0\uc5d0 \ubb38\uc81c\uac00 \uc788\uc2b5\ub2c8\ub2e4. \uc0c8\ub85c\uace0\uce68 \ud6c4 \ub2e4\uc2dc \uc2dc\ub3c4\ud574\uc8fc\uc138\uc694."):a.oR.error("\ucc98\ub9ac \uc911 \uc624\ub958\uac00 \ubc1c\uc0dd\ud588\uc2b5\ub2c8\ub2e4. \uc7a0\uc2dc \ud6c4 \ub2e4\uc2dc \uc2dc\ub3c4\ud574\uc8fc\uc138\uc694."),s.onError&&s.onError(e)},i=e=>{var t;console.log("\u2705 \uc2a4\ud2b8\ub9ac\ubc0d \uc644\ub8cc:",{resultLength:(null===(t=e.result)||void 0===t?void 0:t.length)||0,timestamp:(new Date).toISOString()}),r(!1),u(!1),c("COMPLETED"),s.onComplete&&s.onComplete(e)};try{return await o.YG.generateTitleStream(e,n,t,l,i)}catch(b){throw console.error("\ud83d\udd27 \uc2a4\ud2b8\ub9ac\ubc0d \ucd5c\uc885 \uc2e4\ud328:",b),u(!1),r(!1),c("FAILED"),a.oR.error("\uc11c\ube44\uc2a4\uc5d0 \uc77c\uc2dc\uc801\uc778 \ubb38\uc81c\uac00 \uc788\uc2b5\ub2c8\ub2e4. \uc7a0\uc2dc \ud6c4 \ub2e4\uc2dc \uc2dc\ub3c4\ud574\uc8fc\uc138\uc694."),b}}console.log("\ud83d\udcc4 \uc77c\ubc18 API \ud638\ucd9c \uc2dc\uc791...");const l=await o.YG.generateTitle(e,n);return console.log("\u2705 \ub300\ud654 \uc0dd\uc131 \uc644\ub8cc:",{mode:l.mode,message:l.message,timestamp:(new Date).toISOString()}),r(!1),c("COMPLETED"),l}catch(v){var n,l,i,d,m,g,x,h,p;throw console.error("\u274c \uc81c\ubaa9 \uc0dd\uc131 \uc2e4\ud328:",{error:v.message,code:v.code,status:null===(n=v.response)||void 0===n?void 0:n.status,timestamp:(new Date).toISOString()}),r(!1),u(!1),c("FAILED"),504===(null===(l=v.response)||void 0===l?void 0:l.status)?a.oR.error("\uc11c\ubc84 \uc751\ub2f5 \uc2dc\uac04\uc774 \ucd08\uacfc\ub418\uc5c8\uc2b5\ub2c8\ub2e4. \uc785\ub825\uc744 \uac04\uc18c\ud654\ud558\uac70\ub098 \uc7a0\uc2dc \ud6c4 \ub2e4\uc2dc \uc2dc\ub3c4\ud574\uc8fc\uc138\uc694."):null!==(i=v.message)&&void 0!==i&&i.includes("CORS")||"ERR_NETWORK"===v.code?a.oR.error("\uc11c\ubc84 \uc5f0\uacb0\uc5d0 \ubb38\uc81c\uac00 \uc788\uc2b5\ub2c8\ub2e4. \ud398\uc774\uc9c0\ub97c \uc0c8\ub85c\uace0\uce68\ud558\uace0 \ub2e4\uc2dc \uc2dc\ub3c4\ud574\uc8fc\uc138\uc694."):400===(null===(d=v.response)||void 0===d?void 0:d.status)&&null!==(m=v.response)&&void 0!==m&&null!==(g=m.data)&&void 0!==g&&g.setup_required?a.oR.error("\ud504\ub86c\ud504\ud2b8 \uce74\ub4dc\ub97c \uba3c\uc800 \uc124\uc815\ud574\uc8fc\uc138\uc694!"):"ECONNABORTED"===v.code?a.oR.error("\uc694\uccad \ucc98\ub9ac \uc2dc\uac04\uc774 \ucd08\uacfc\ub418\uc5c8\uc2b5\ub2c8\ub2e4. \uc785\ub825\uc744 \uc904\uc774\uac70\ub098 \uc7a0\uc2dc \ud6c4 \ub2e4\uc2dc \uc2dc\ub3c4\ud574\uc8fc\uc138\uc694."):500===(null===(x=v.response)||void 0===x?void 0:x.status)?a.oR.error("\uc11c\ubc84\uc5d0 \uc77c\uc2dc\uc801\uc778 \ubb38\uc81c\uac00 \uc788\uc2b5\ub2c8\ub2e4. \uc7a0\uc2dc \ud6c4 \ub2e4\uc2dc \uc2dc\ub3c4\ud574\uc8fc\uc138\uc694."):403===(null===(h=v.response)||void 0===h?void 0:h.status)?a.oR.error("\uad8c\ud55c\uc774 \uc5c6\uc2b5\ub2c8\ub2e4. \ub85c\uadf8\uc778 \uc0c1\ud0dc\ub97c \ud655\uc778\ud574\uc8fc\uc138\uc694."):429===(null===(p=v.response)||void 0===p?void 0:p.status)?a.oR.error("\uc694\uccad\uc774 \ub108\ubb34 \ub9ce\uc2b5\ub2c8\ub2e4. \uc7a0\uc2dc \ud6c4 \ub2e4\uc2dc \uc2dc\ub3c4\ud574\uc8fc\uc138\uc694."):a.oR.error("\ucc98\ub9ac \uc911 \uc624\ub958\uac00 \ubc1c\uc0dd\ud588\uc2b5\ub2c8\ub2e4. \ub124\ud2b8\uc6cc\ud06c \uc5f0\uacb0\uc744 \ud655\uc778\ud558\uace0 \ub2e4\uc2dc \uc2dc\ub3c4\ud574\uc8fc\uc138\uc694."),v}},[e]),g=(0,s.useCallback)(async(e,t,s)=>{if(d)return;const n=async()=>{try{const a=await o.YG.getExecutionStatus(e);c(a.status),"SUCCEEDED"===a.status?(r(!1),c("COMPLETED"),t&&t(a)):"FAILED"===a.status?(r(!1),c("FAILED"),s&&s(new Error("\ucc98\ub9ac \uc2e4\ud328"))):"RUNNING"===a.status&&setTimeout(n,3e3)}catch(a){console.error("\uc2e4\ud589 \uc0c1\ud0dc \uc870\ud68c \uc2e4\ud328:",a),r(!1),c("FAILED"),s&&s(a)}};n()},[e,d]),x=(0,s.useCallback)(()=>{r(!1),u(!1),l(null),c(null)},[]);return{isExecuting:t,isStreaming:d,currentExecution:n,executionStatus:i,executeOrchestration:m,pollOrchestrationResult:g,resetOrchestration:x}})(e),{isConnected:B,isConnecting:P,error:U,startStreaming:G,addMessageListener:F,removeMessageListener:z}=(e=>{const[t,r]=(0,s.useState)(!1),[n,a]=(0,s.useState)(!1),[o,l]=(0,s.useState)(null),i=(0,s.useRef)(null),c=(0,s.useRef)(null),d=(0,s.useRef)(0),u=(0,s.useCallback)(async()=>{const e="wss://qc2865b7d2.execute-api.us-east-1.amazonaws.com/prod";if(!e.startsWith("wss://")&&!e.startsWith("ws://"))return console.error("\uc798\ubabb\ub41c WebSocket URL \ud615\uc2dd:",e),null;let t=e.replace(/\/$/,"");return console.log("\ud83d\udd13 \uac1c\ubc1c \ubaa8\ub4dc: WebSocket \uc778\uc99d \uc2a4\ud0b5"),console.log("WebSocket URL \ud655\uc778:",t.replace(/token=[^&]+/,"token=***")),console.log("\ud658\uacbd\ubcc0\uc218 REACT_APP_WS_URL:","wss://qc2865b7d2.execute-api.us-east-1.amazonaws.com/prod"),t},[]),m=(0,s.useCallback)(async()=>{var e,t;if((null===(e=i.current)||void 0===e?void 0:e.readyState)!==WebSocket.OPEN&&(null===(t=i.current)||void 0===t?void 0:t.readyState)!==WebSocket.CONNECTING){i.current&&(i.current.close(),i.current=null),a(!0),l(null);try{const e=await u();if(!e)return l("\uc720\ud6a8\ud558\uc9c0 \uc54a\uc740 WebSocket URL"),void a(!1);console.log("WebSocket \uc5f0\uacb0 \uc2dc\ub3c4:",e),console.log("\ube0c\ub77c\uc6b0\uc800 WebSocket \uc9c0\uc6d0:",!!window.WebSocket),window.wsConnectStart=Date.now(),i.current=new WebSocket(e);const t=setTimeout(()=>{var e;(null===(e=i.current)||void 0===e?void 0:e.readyState)===WebSocket.CONNECTING&&(console.error("WebSocket \uc5f0\uacb0 \uc2dc\uac04 \ucd08\uacfc"),i.current.close(),l("\uc5f0\uacb0 \uc2dc\uac04\uc774 \ucd08\uacfc\ub418\uc5c8\uc2b5\ub2c8\ub2e4"),a(!1))},1e4);i.current.onopen=e=>{var s,n,o;clearTimeout(t),console.log("\ud83d\udfe2 WebSocket \uc5f0\uacb0 \uc131\uacf5!"),console.log("- Event:",e),console.log("- URL:",null===(s=i.current)||void 0===s?void 0:s.url),console.log("- Protocol:",null===(n=i.current)||void 0===n?void 0:n.protocol),console.log("- Extensions:",null===(o=i.current)||void 0===o?void 0:o.extensions),r(!0),a(!1),l(null),d.current=0},i.current.onclose=e=>{clearTimeout(t);const s=Date.now()-(window.wsConnectStart||0);if(console.log("\ud83d\udd34 WebSocket \uc5f0\uacb0 \uc885\ub8cc:"),console.log("- Code:",e.code),console.log("- Reason:",e.reason||"(no reason provided)"),console.log("- WasClean:",e.wasClean),console.log("- Connection duration:",s+"ms"),r(!1),a(!1),s<500){console.error("\u26a0\ufe0f WebSocket\uc774 \uc989\uc2dc \uc885\ub8cc\ub428 - \uc11c\ubc84 \ubb38\uc81c \uac00\ub2a5\uc131");let t="\uc11c\ubc84 \uc5f0\uacb0\uc5d0 \uc2e4\ud328\ud588\uc2b5\ub2c8\ub2e4.";switch(e.code){case 1006:t="\ube44\uc815\uc0c1\uc801\uc778 \uc5f0\uacb0 \uc885\ub8cc (\ub124\ud2b8\uc6cc\ud06c \ubb38\uc81c \uac00\ub2a5\uc131)";break;case 1002:t="\ud504\ub85c\ud1a0\ucf5c \uc624\ub958";break;case 1003:t="\uc9c0\uc6d0\ud558\uc9c0 \uc54a\ub294 \ub370\uc774\ud130 \ud0c0\uc785";break;case 1011:t="\uc11c\ubc84 \ub0b4\ubd80 \uc624\ub958";break;case 1001:t="\uc11c\ubc84\uac00 \uc885\ub8cc\ub418\uc5c8\uc2b5\ub2c8\ub2e4";break;case 1012:t="\uc11c\ubc84 \uc7ac\uc2dc\uc791 \uc911\uc785\ub2c8\ub2e4";break;case 1013:t="\ub098\uc911\uc5d0 \ub2e4\uc2dc \uc2dc\ub3c4\ud574\uc8fc\uc138\uc694";break;case 1014:t="\uc798\ubabb\ub41c \uac8c\uc774\ud2b8\uc6e8\uc774";break;case 1015:t="TLS \uc5f0\uacb0 \uc2e4\ud328"}return void l(t)}if(1e3!==e.code&&d.current<5){const e=Math.min(1e3*Math.pow(2,d.current),3e4);console.log(`\ud83d\udd04 ${e}ms \ud6c4 \uc7ac\uc5f0\uacb0 \uc2dc\ub3c4 (${d.current+1}/5)`),c.current=setTimeout(()=>{d.current++,m()},e)}else d.current>=5&&l("\ucd5c\ub300 \uc7ac\uc5f0\uacb0 \uc2dc\ub3c4 \ud69f\uc218\uc5d0 \ub3c4\ub2ec\ud588\uc2b5\ub2c8\ub2e4.")},i.current.onerror=e=>{var r,s;clearTimeout(t),console.error("\ud83d\udca5 WebSocket \uc624\ub958:",e),console.log("- ReadyState:",null===(r=i.current)||void 0===r?void 0:r.readyState),console.log("- URL:",null===(s=i.current)||void 0===s?void 0:s.url),l("WebSocket \uc5f0\uacb0 \uc624\ub958\uac00 \ubc1c\uc0dd\ud588\uc2b5\ub2c8\ub2e4"),a(!1)}}catch(s){console.error("\ud83d\udca5 WebSocket \uc0dd\uc131 \uc2e4\ud328:",s),l("WebSocket \uc5f0\uacb0\uc5d0 \uc2e4\ud328\ud588\uc2b5\ub2c8\ub2e4: "+s.message),a(!1)}}else console.log("\uc774\ubbf8 \uc5f0\uacb0\ub41c WebSocket\uc774 \uc788\uc2b5\ub2c8\ub2e4 (readyState:",i.current.readyState,")")},[u]),g=(0,s.useCallback)(()=>{c.current&&(clearTimeout(c.current),c.current=null),i.current&&(i.current.close(1e3,"Manual disconnect"),i.current=null),r(!1),a(!1),d.current=0},[]),x=(0,s.useCallback)(e=>{var t;return(null===(t=i.current)||void 0===t?void 0:t.readyState)===WebSocket.OPEN?(i.current.send(JSON.stringify(e)),!0):(console.error("WebSocket\uc774 \uc5f0\uacb0\ub418\uc9c0 \uc54a\uc558\uc2b5\ub2c8\ub2e4"),l("WebSocket \uc5f0\uacb0\uc774 \ud544\uc694\ud569\ub2c8\ub2e4"),!1)},[]),h=(0,s.useCallback)(function(r){let s=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[],n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:[],a=arguments.length>3&&void 0!==arguments[3]?arguments[3]:null,o=arguments.length>4&&void 0!==arguments[4]?arguments[4]:null,i=arguments.length>5&&void 0!==arguments[5]?arguments[5]:null;if(!t)return l("WebSocket \uc5f0\uacb0\uc774 \ud544\uc694\ud569\ub2c8\ub2e4"),!1;const c={action:"stream",projectId:e,userInput:r,chat_history:s,prompt_cards:n,modelId:a,conversationId:o,userSub:i};return console.log("\ud83d\udd0d [DEBUG] WebSocket \uba54\uc2dc\uc9c0 \uc804\uc1a1 \uc0c1\uc138:",{action:c.action,projectId:c.projectId,inputLength:r.length,historyLength:s.length,promptCardsCount:n.length,conversationId:c.conversationId,conversationIdType:typeof c.conversationId,conversationIdValue:c.conversationId,isConversationIdNull:null===c.conversationId,isConversationIdUndefined:void 0===c.conversationId,userSub:c.userSub,fullMessage:JSON.stringify(c)}),x(c)},[t,e,x]),p=(0,s.useCallback)(e=>{i.current&&i.current.addEventListener("message",e)},[]),b=(0,s.useCallback)(e=>{i.current&&i.current.removeEventListener("message",e)},[]);(0,s.useEffect)(()=>{const e=setTimeout(()=>{m()},100);return()=>{clearTimeout(e),g()}},[]);const v=(0,s.useRef)(e);return(0,s.useEffect)(()=>{v.current!==e&&t&&e&&(console.log("ProjectId \ubcc0\uacbd\ub428, \uc7ac\uc5f0\uacb0 \uc911:",v.current,"->",e),g(),setTimeout(m,200)),v.current=e},[e,t]),{isConnected:t,isConnecting:n,error:o,connect:m,disconnect:g,sendMessage:x,startStreaming:h,addMessageListener:p,removeMessageListener:b}})(e);(0,s.useEffect)(()=>{d([])},[e]);const $=(0,s.useCallback)(()=>{if(!M.current)return;const e=M.current,t=e.scrollTop,r=e.scrollHeight-e.clientHeight;if(Math.abs(t-R.current)>2){A(!(t>=r-20))}R.current=t},[]),H=(0,s.useCallback)(()=>{!D&&L.current&&L.current.scrollIntoView({behavior:"smooth"})},[D]);(0,s.useEffect)(()=>{H()},[c,H]),(0,s.useEffect)(()=>{const e=e=>{var t;try{const r=JSON.parse(e.data);console.log("WebSocket \uba54\uc2dc\uc9c0 \uc218\uc2e0:",r);const s=k.current;switch(r.type){case"stream_start":console.log("WebSocket \uc2a4\ud2b8\ub9ac\ubc0d \uc2dc\uc791");break;case"progress":console.log(`\uc9c4\ud589 \uc0c1\ud669: ${r.step} (${r.progress}%)`);break;case"stream_chunk":s?(d(e=>{const t=[...e],n=t.findIndex(e=>e.id===s);if(console.log("\uc2a4\ud2b8\ub9bc \uccad\ud06c \ucc98\ub9ac:",{currentStreamingId:s,streamingMsgIndex:n,messagesLength:e.length,content:r.content}),-1!==n){const e=t[n].content||"";t[n]={...t[n],content:e+r.content,isLoading:!0,isStreaming:!0},console.log("\uba54\uc2dc\uc9c0 \uc5c5\ub370\uc774\ud2b8\ub428:",t[n])}else console.log("\uc2a4\ud2b8\ub9ac\ubc0d \uba54\uc2dc\uc9c0\ub97c \ucc3e\uc744 \uc218 \uc5c6\uc74c, \uba54\uc2dc\uc9c0 ID\ub4e4:",e.map(e=>e.id));return t}),D||H()):console.log("currentStreamingId\uac00 null\uc784");break;case"stream_complete":s&&(d(e=>{const t=[...e],n=t.findIndex(e=>e.id===s);return-1!==n&&(t[n]={...t[n],content:r.fullContent,isLoading:!1,isStreaming:!1,timestamp:(new Date).toISOString()}),t}),k.current=null,H());break;case"error":console.error("WebSocket \uc2a4\ud2b8\ub9ac\ubc0d \uc624\ub958:",r.message),s&&(d(e=>{const t=[...e],n=t.findIndex(e=>e.id===s);if(-1!==n){var a,o,l,i,c,d;let e="\uba54\uc2dc\uc9c0 \ucc98\ub9ac \uc911 \uc624\ub958\uac00 \ubc1c\uc0dd\ud588\uc2b5\ub2c8\ub2e4. \ub2e4\uc2dc \uc2dc\ub3c4\ud574\uc8fc\uc138\uc694.";null!==(a=r.message)&&void 0!==a&&a.includes("401")||null!==(o=r.message)&&void 0!==o&&o.includes("Unauthorized")?e="\uc778\uc99d\uc774 \ub9cc\ub8cc\ub418\uc5c8\uc2b5\ub2c8\ub2e4. \ub2e4\uc2dc \ub85c\uadf8\uc778\ud574\uc8fc\uc138\uc694.":null!==(l=r.message)&&void 0!==l&&l.includes("timeout")||null!==(i=r.message)&&void 0!==i&&i.includes("\uc2dc\uac04 \ucd08\uacfc")?e="\ucc98\ub9ac \uc2dc\uac04\uc774 \ucd08\uacfc\ub418\uc5c8\uc2b5\ub2c8\ub2e4. \uc694\uccad\uc744 \ub2e8\uc21c\ud654\ud558\uac70\ub098 \uc7a0\uc2dc \ud6c4 \ub2e4\uc2dc \uc2dc\ub3c4\ud574\uc8fc\uc138\uc694.":(null!==(c=r.message)&&void 0!==c&&c.includes("rate limit")||null!==(d=r.message)&&void 0!==d&&d.includes("\uc81c\ud55c"))&&(e="\uc694\uccad \ud55c\ub3c4\uc5d0 \ub3c4\ub2ec\ud588\uc2b5\ub2c8\ub2e4. \uc7a0\uc2dc \ud6c4 \ub2e4\uc2dc \uc2dc\ub3c4\ud574\uc8fc\uc138\uc694."),t[n]={...t[n],content:e,isLoading:!1,isStreaming:!1,isError:!0,timestamp:(new Date).toISOString()}}return t}),k.current=null);const e=null!==(t=r.message)&&void 0!==t&&t.includes("401")?"\uc778\uc99d\uc774 \ub9cc\ub8cc\ub418\uc5c8\uc2b5\ub2c8\ub2e4":"\ucc98\ub9ac \uc911 \uc624\ub958\uac00 \ubc1c\uc0dd\ud588\uc2b5\ub2c8\ub2e4";a.oR.error(e);break;default:console.log("\uc54c \uc218 \uc5c6\ub294 WebSocket \uba54\uc2dc\uc9c0 \ud0c0\uc785:",r.type)}}catch(r){console.error("WebSocket \uba54\uc2dc\uc9c0 \ud30c\uc2f1 \uc624\ub958:",r)}};return B&&F(e),()=>{B&&z(e)}},[B,F,z,H]);const q=(0,s.useCallback)((e,t)=>{const r=k.current;console.log("\uccad\ud06c \uc218\uc2e0:",e,"\uc2a4\ud2b8\ub9ac\ubc0d ID:",r),r?(d(t=>{const s=[...t],n=s.findIndex(e=>e.id===r);return-1!==n?(s[n]={...s[n],content:s[n].content+e,isLoading:!0,isStreaming:!0},console.log("\uc2a4\ud2b8\ub9ac\ubc0d \uba54\uc2dc\uc9c0 \uc5c5\ub370\uc774\ud2b8 \uc131\uacf5:",s[n].content)):console.error("\uc2a4\ud2b8\ub9ac\ubc0d \uba54\uc2dc\uc9c0\ub97c \ucc3e\uc744 \uc218 \uc5c6\uc74c:",r),s}),D||H()):console.error("\uc2a4\ud2b8\ub9ac\ubc0d ID\uac00 \uc5c6\uc2b5\ub2c8\ub2e4!")},[H,D]),K=(0,s.useCallback)(e=>{const t=k.current;console.log("\uc2a4\ud2b8\ub9ac\ubc0d \uc644\ub8cc:",e,"\uc2a4\ud2b8\ub9ac\ubc0d ID:",t),t?(d(r=>{const s=[...r],n=s.findIndex(e=>e.id===t);return-1!==n?(s[n]={...s[n],content:e.result,isLoading:!1,isStreaming:!1,performance_metrics:e.performance_metrics,model_info:e.model_info,timestamp:(new Date).toISOString()},console.log("\uc2a4\ud2b8\ub9ac\ubc0d \uc644\ub8cc \ucc98\ub9ac \uc131\uacf5:",s[n].content)):console.error("\uc2a4\ud2b8\ub9ac\ubc0d \uc644\ub8cc \ucc98\ub9ac \uc911 \uba54\uc2dc\uc9c0\ub97c \ucc3e\uc744 \uc218 \uc5c6\uc74c:",t),s}),k.current=null,console.log("WebSocket \uc2a4\ud2b8\ub9ac\ubc0d \uc644\ub8cc - \uc785\ub825 \ud65c\uc131\ud654"),p(!0),H()):console.error("\uc2a4\ud2b8\ub9ac\ubc0d \uc644\ub8cc \ucc98\ub9ac \uc911 ID\uac00 \uc5c6\uc2b5\ub2c8\ub2e4!")},[H]),V=(0,s.useCallback)(()=>{console.log("\uc0dd\uc131 \uc911\ub2e8 \uc694\uccad"),w.current&&(w.current.close(),w.current=null),I.current&&(I.current=null);const e=k.current;e&&(d(t=>{const r=[...t],s=r.findIndex(t=>t.id===e);return-1!==s&&(r[s]={...r[s],content:r[s].content+"\n\n[\uc0dd\uc131\uc774 \uc911\ub2e8\ub418\uc5c8\uc2b5\ub2c8\ub2e4]",isLoading:!1,isStreaming:!1,timestamp:(new Date).toISOString()}),r}),k.current=null),p(!0),_(),a.oR.success("\uc0dd\uc131\uc774 \uc911\ub2e8\ub418\uc5c8\uc2b5\ub2c8\ub2e4")},[_]),Z=(0,s.useCallback)(e=>{if(!e.trim())return void v(24);const t=e.split("\n").length,r=Math.ceil(e.length/80),s=Math.max(t,r);let n;n=s<=3?24+22*(s-1):s<=10?150+15*(s-6):Math.min(400,150+12*(s-6)),v(Math.max(24,n))},[]),Y=(0,s.useCallback)(e=>{m(e),Z(e)},[Z]),J=(0,s.useCallback)(async()=>{if(console.log("\ud574\ub4e4 \uc804\uc1a1 \ud638\ucd9c:",{inputValue:u.trim(),isGenerating:O,canSendMessage:h}),!u.trim()||O)return void console.log("\uc804\uc1a1 \uc911\ub2e8: \uc870\uac74 \ubd80\uc871");console.log("\uc785\ub825 \ube44\ud65c\uc131\ud654"),p(!1);const t={id:"user-"+Date.now(),type:"user",content:u.trim(),timestamp:(new Date).toISOString()},s="streaming-"+Date.now();k.current=s,console.log("\uc0c8 \uc2a4\ud2b8\ub9ac\ubc0d \uba54\uc2dc\uc9c0 ID \uc0dd\uc131:",s);const i={id:s,type:"assistant",content:"",timestamp:(new Date).toISOString(),isLoading:!0,isStreaming:!0};d(e=>[...e,t,i]),m(""),v(24);const g=[...c,t],x=g.filter(e=>!e.isLoading&&!e.isError&&!e.isStreaming).map(e=>({role:"user"===e.type?"user":"assistant",content:e.content})),b=x.slice(-50);console.log("\ub300\ud654 \ud788\uc2a4\ud1a0\ub9ac \uc0dd\uc131:",{totalMessages:g.length,fullHistoryLength:x.length,trimmedHistoryLength:b.length,maxHistoryLength:50,recentHistory:b.slice(-6)});try{const s=(Array.isArray(r)?r:[]).filter(e=>!1!==e.isActive&&!1!==e.enabled).map(e=>({promptId:e.promptId||e.prompt_id,title:e.title||"Untitled",prompt_text:e.prompt_text||e.content||"",tags:e.tags||[],isActive:!1!==e.isActive,stepOrder:e.stepOrder||0})).filter(e=>e.prompt_text.trim()).sort((e,t)=>(e.stepOrder||0)-(t.stepOrder||0));if(console.log("\ub300\ud654 \uc804\uc1a1 \ub370\uc774\ud130 \ud655\uc778:",{messageContent:t.content,chatHistoryLength:b.length,promptCardsCount:s.length,chatHistory:b,promptCards:s.map(e=>({id:e.promptId,title:e.title,contentLength:e.prompt_text.length,stepOrder:e.stepOrder,hasContent:!!e.prompt_text.trim()}))}),B){console.log("WebSocket\uc744 \ud1b5\ud55c \uc2e4\uc2dc\uac04 \uc2a4\ud2b8\ub9ac\ubc0d \uc2dc\uc791"),console.log("\ud83d\udd0d [DEBUG] \uc2a4\ud2b8\ub9ac\ubc0d \ub9e4\uac1c\ubcc0\uc218 \uc0c1\uc138 \ud655\uc778:",{projectId:e,userInput:t.content,conversationId:n,userSub:null===l||void 0===l?void 0:l.id,historyLength:b.length,promptCardsLength:s.length,conversationIdType:typeof n,conversationIdValue:n,isConversationIdNull:null===n,isConversationIdUndefined:void 0===n});if(G(t.content,b,s,f,n,null===l||void 0===l?void 0:l.id))return;console.log("WebSocket \uc804\uc1a1 \uc2e4\ud328, SSE \ud3f4\ubc31 \ubaa8\ub4dc\ub85c \uc804\ud658")}else console.log("WebSocket \ubbf8\uc5f0\uacb0, SSE \ubaa8\ub4dc \uc0ac\uc6a9");if(console.log("\uba40\ud2f0-\uc5d0\uc774\uc804\ud2b8 \uc2dc\uc2a4\ud15c \uc2e4\ud589 \uc2dc\uc791"),s.length>0)try{console.log("\ud504\ub86c\ud504\ud2b8 \uce74\ub4dc \u2192 \ud06c\ub8e8 \uc778\uc2a4\ud134\uc2a4 \ubcc0\ud658 \uc2dc\ub3c4"),await o.WK.createCrewInstance(e,s),console.log("\ud06c\ub8e8 \uc778\uc2a4\ud134\uc2a4 \uc0dd\uc131 \uc644\ub8cc")}catch(j){var y;if(console.log("\ud06c\ub8e8 \uc778\uc2a4\ud134\uc2a4 \uc0dd\uc131 \uc2e4\ud328:",j.message),401===(null===(y=j.response)||void 0===y?void 0:y.status)){const{shouldRedirect:e}=await(0,o.t6)(j);if(e)return}console.log("\ud06c\ub8e8 \uc778\uc2a4\ud134\uc2a4 \uad00\ub828 \uc624\ub958\uc774\uc9c0\ub9cc \uacc4\uc18d \uc9c4\ud589\ud569\ub2c8\ub2e4")}const i=await o.WK.executeMultiAgent(e,t.content,e=>{console.log("\uba40\ud2f0-\uc5d0\uc774\uc804\ud2b8 \uc9c4\ud589\uc0c1\ud669:",e)});console.log("\uba40\ud2f0-\uc5d0\uc774\uc804\ud2b8 \uc2e4\ud589 \uc644\ub8cc:",i);const c=(e=>{if(!e)return console.error("\uba40\ud2f0-\uc5d0\uc774\uc804\ud2b8 \uc751\ub2f5 \uc624\ub958: \uacb0\uacfc\uac00 \uc5c6\uc2b5\ub2c8\ub2e4",e),{id:"error-"+Date.now(),type:"assistant",content:"\ucc98\ub9ac \uc911 \uc624\ub958\uac00 \ubc1c\uc0dd\ud588\uc2b5\ub2c8\ub2e4. \ub2e4\uc2dc \uc2dc\ub3c4\ud574\uc8fc\uc138\uc694.",timestamp:(new Date).toISOString(),isError:!0};const t=e.agentResults||{},r=e.finalTitles||{},s=e.tokenUsage||0,n=Object.keys(t).map(e=>{const s=t[e],n=r[e]||[];return{agentType:e,agentName:C(e),result:(null===s||void 0===s?void 0:s.content)||"\uacb0\uacfc \uc5c6\uc74c",titles:n,tokenCount:(null===s||void 0===s?void 0:s.tokenCount)||0}}),a=Object.values(r).flat();return{id:"multi-agent-"+Date.now(),type:"assistant",content:S(n,a),timestamp:new Date,isMultiAgent:!0,agentResults:n,allTitles:a,tokenUsage:s}})(i);d(e=>{const t=[...e],r=t.findIndex(e=>e.id===k.current);return-1!==r?t[r]=c:t.push(c),t}),k.current=null,p(!0),a.oR.success(`${Object.keys(i.agentResults||{}).length}\uac1c \uc5d0\uc774\uc804\ud2b8 \ubd84\uc11d \uc644\ub8cc!`)}catch(N){var w;console.error("\uba54\uc2dc\uc9c0 \uc804\uc1a1 \uc2e4\ud328:",N);const{userMessage:e,shouldRedirect:t}=await(0,o.t6)(N);if(t)return;const r={id:"error-"+Date.now(),type:"assistant",content:e,timestamp:(new Date).toISOString(),isError:!0,errorDetails:{message:N.message,status:null===(w=N.response)||void 0===w?void 0:w.status,code:N.code}};d(e=>{const t=k.current;return[...e.filter(e=>e.id!==t),r]}),k.current=null,p(!0)}p(!0)},[u,O,W,q,K,c]),Q=(0,s.useCallback)(e=>{"Enter"!==e.key||e.shiftKey||(e.preventDefault(),J())},[J]),X=(0,s.useCallback)(async(e,t)=>{await j(e)&&(x(t),setTimeout(()=>x(null),2e3))},[]),ee=(0,s.useCallback)(async(e,t,r)=>{await j(e,"\ubcf5\uc0ac\ub418\uc5c8\uc2b5\ub2c8\ub2e4!")&&(x(`${t}_title_${r}`),setTimeout(()=>x(null),2e3))},[]),te=(0,s.useCallback)(()=>{d([]),m(""),x(null),p(!0),k.current=null,w.current=null,I.current=null,_()},[_]);return{messages:c,inputValue:u,setInputValue:m,handleInputChange:Y,copiedMessage:g,isGenerating:O,isStreaming:T,canSendMessage:h,streamingMessageId:k.current,messagesEndRef:L,inputRef:E,inputHeight:b,handleSendMessage:J,handleStopGeneration:V,handleKeyPress:Q,handleCopyMessage:X,handleCopyTitle:ee,resetChat:te,scrollToBottom:H,wsConnected:B,wsConnecting:P,wsError:U,scrollContainerRef:M,handleScroll:$,isUserScrolling:D,selectedModel:f,setSelectedModel:y}};var L=r(8047),E=r(9399);const D=e=>{if(!e)return"";try{if(e instanceof Date)return e.toLocaleTimeString("ko-KR",{hour:"2-digit",minute:"2-digit",hour12:!1});if("string"===typeof e){const t=new Date(e);return isNaN(t.getTime())?"":t.toLocaleTimeString("ko-KR",{hour:"2-digit",minute:"2-digit",hour12:!1})}return"number"===typeof e?new Date(e).toLocaleTimeString("ko-KR",{hour:"2-digit",minute:"2-digit",hour12:!1}):""}catch(t){return console.warn("\ud0c0\uc784\uc2a4\ud0ec\ud504 \ud3ec\ub9f7 \uc624\ub958:",t),""}},A=e=>{let{message:t,onCopyMessage:r,onCopyTitle:n,copiedMessage:a}=e;const o="user"===t.role||"user"===t.type,l="error"===t.role,i=t.isLoading||!1,[c,d]=(0,s.useState)(!1),[u,m]=(0,s.useState)(!1),[g,x]=(0,s.useState)(!1);return(0,v.jsx)("div",{className:`flex ${o?"justify-end":"justify-start"} mb-3`,children:o?(0,v.jsx)("div",{className:"max-w-[70%]",children:(0,v.jsxs)("div",{className:"bg-[#5E89FF] text-white rounded-2xl px-4 py-2 shadow-md",children:[(0,v.jsx)("div",{className:"text-[15px] font-normal leading-[1.5] whitespace-pre-wrap break-words",children:t.content}),t.timestamp&&(0,v.jsx)("div",{className:"text-[12px] text-white/70 mt-1 text-right",children:D(t.timestamp)})]})}):(0,v.jsxs)("div",{className:"w-full max-w-[75%]",children:[(0,v.jsxs)("div",{className:"bg-transparent dark:bg-transparent","aria-live":"polite",children:[l?(0,v.jsxs)("div",{className:"text-red-600 dark:text-red-400",children:[(0,v.jsxs)("div",{className:"flex items-center mb-2",children:[(0,v.jsx)(E.A,{className:"h-4 w-4 mr-2"}),(0,v.jsx)("span",{className:"text-[14px] font-semibold",children:"\uc624\ub958\uac00 \ubc1c\uc0dd\ud588\uc2b5\ub2c8\ub2e4"})]}),(0,v.jsx)("div",{className:"text-[15px] font-normal leading-[1.5]",children:t.content})]}):i?(0,v.jsxs)("div",{className:"flex items-start gap-3",children:[(0,v.jsx)("div",{className:"flex-shrink-0 w-8 h-8 bg-gradient-to-br from-indigo-400 to-purple-500 rounded-full flex items-center justify-center shadow-sm",children:(0,v.jsx)("svg",{className:"w-4 h-4 text-white",fill:"none",stroke:"currentColor",strokeWidth:"1.5",viewBox:"0 0 24 24",children:(0,v.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M9.813 15.904L9 18.75l-.813-2.846a4.5 4.5 0 00-3.09-3.09L2.25 12l2.846-.813a4.5 4.5 0 003.09-3.09L9 5.25l.813 2.847a4.5 4.5 0 003.09 3.09L15.75 12l-2.847.813a4.5 4.5 0 00-3.09 3.09zM18.259 8.715L18 9.75l-.259-1.035a3.375 3.375 0 00-2.455-2.456L14.25 6l1.036-.259a3.375 3.375 0 002.455-2.456L18 2.25l.259 1.035a3.375 3.375 0 002.456 2.456L21.75 6l-1.035.259a3.375 3.375 0 00-2.456 2.456z"})})}),(0,v.jsxs)("div",{className:"flex-1",children:[(0,v.jsxs)("div",{className:"flex items-center gap-1 mb-2",children:[(0,v.jsx)("div",{className:"w-2 h-2 bg-blue-500 rounded-full animate-bounce",style:{animationDelay:"0ms"}}),(0,v.jsx)("div",{className:"w-2 h-2 bg-blue-500 rounded-full animate-bounce",style:{animationDelay:"150ms"}}),(0,v.jsx)("div",{className:"w-2 h-2 bg-blue-500 rounded-full animate-bounce",style:{animationDelay:"300ms"}})]}),(0,v.jsx)("span",{className:"text-sm text-gray-600 dark:text-gray-400",children:"AI\uac00 \ub2f5\ubcc0\uc744 \uc0dd\uc131\ud558\uace0 \uc788\uc2b5\ub2c8\ub2e4..."})]})]}):(0,v.jsxs)("div",{className:"flex items-start gap-3",children:[(0,v.jsx)("div",{className:"flex-shrink-0 w-8 h-8 bg-gradient-to-br from-indigo-400 to-purple-500 rounded-full flex items-center justify-center shadow-sm mt-1",children:(0,v.jsx)("svg",{className:"w-4 h-4 text-white",fill:"none",stroke:"currentColor",strokeWidth:"1.5",viewBox:"0 0 24 24",children:(0,v.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M9.813 15.904L9 18.75l-.813-2.846a4.5 4.5 0 00-3.09-3.09L2.25 12l2.846-.813a4.5 4.5 0 003.09-3.09L9 5.25l.813 2.847a4.5 4.5 0 003.09 3.09L15.75 12l-2.847.813a4.5 4.5 0 00-3.09 3.09zM18.259 8.715L18 9.75l-.259-1.035a3.375 3.375 0 00-2.455-2.456L14.25 6l1.036-.259a3.375 3.375 0 002.455-2.456L18 2.25l.259 1.035a3.375 3.375 0 002.456 2.456L21.75 6l-1.035.259a3.375 3.375 0 00-2.456 2.456z"})})}),(0,v.jsx)("div",{className:"flex-1 text-[#202124] dark:text-[#E5E7EB] prose prose-sm max-w-none",children:(0,v.jsx)("div",{className:"text-[15px] font-normal leading-[1.6] whitespace-pre-wrap [&>p]:mb-3 [&>ul]:mb-3 [&>ol]:mb-3 [&>h1]:text-[18px] [&>h1]:font-semibold [&>h1]:mb-3 [&>h2]:text-[16px] [&>h2]:font-semibold [&>h2]:mb-2 [&>h3]:text-[15px] [&>h3]:font-medium [&>h3]:mb-2",children:(0,v.jsx)(L.oz,{children:t.content})})})]}),t.timestamp&&(0,v.jsx)("div",{className:"text-[12px] text-gray-500 dark:text-gray-400 mt-1 ml-11",children:D(t.timestamp)})]}),!l&&!i&&(0,v.jsxs)("div",{className:"flex items-center gap-1 mt-2 ml-11",children:[(0,v.jsx)("button",{onClick:async()=>{try{await navigator.clipboard.writeText(t.content),x(!0),setTimeout(()=>x(!1),1e3)}catch(e){console.error("\ubcf5\uc0ac \uc2e4\ud328:",e)}},className:"p-1.5 rounded transition-all duration-200 transform "+(g?"text-green-500 bg-green-100 dark:bg-green-900/30 scale-110":"text-gray-400 hover:text-gray-600 dark:text-gray-500 dark:hover:text-gray-300 hover:bg-gray-100 dark:hover:bg-gray-800"),title:g?"\ubcf5\uc0ac\ub428!":"\ubcf5\uc0ac",children:(0,v.jsx)("svg",{className:"w-4 h-4",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",strokeWidth:"2",children:g?(0,v.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M5 13l4 4L19 7"}):(0,v.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M8 16H6a2 2 0 01-2-2V6a2 2 0 012-2h8a2 2 0 012 2v2m-6 12h8a2 2 0 002-2v-8a2 2 0 00-2-2h-8a2 2 0 00-2 2v8a2 2 0 002 2z"})})}),(0,v.jsx)("button",{onClick:()=>{d(!0),m(!1),setTimeout(()=>d(!1),2e3)},className:"p-1.5 rounded transition-all duration-300 transform "+(c?"text-blue-500 bg-blue-100 dark:bg-blue-900/30 scale-110 animate-pulse":"text-gray-400 hover:text-gray-600 dark:text-gray-500 dark:hover:text-gray-300 hover:bg-gray-100 dark:hover:bg-gray-800"),title:c?"\uc88b\uc544\uc694!":"\uc88b\uc544\uc694",children:(0,v.jsx)("svg",{className:"w-4 h-4",fill:c?"currentColor":"none",viewBox:"0 0 24 24",stroke:"currentColor",strokeWidth:"2",children:(0,v.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M14 10h4.764a2 2 0 011.789 2.894l-3.5 7A2 2 0 0115.263 21h-4.017c-.163 0-.326-.02-.485-.06L7 20m7-10V5a2 2 0 00-2-2h-.095c-.5 0-.905.405-.905.905 0 .714-.211 1.412-.608 2.006L7 11v9m7-10h-2M7 20H5a2 2 0 01-2-2v-6a2 2 0 012-2h2.5"})})}),(0,v.jsx)("button",{onClick:()=>{m(!0),d(!1),setTimeout(()=>m(!1),2e3)},className:"p-1.5 rounded transition-all duration-300 transform "+(u?"text-red-500 bg-red-100 dark:bg-red-900/30 scale-110 border-2 border-red-300 animate-pulse":"text-gray-400 hover:text-gray-600 dark:text-gray-500 dark:hover:text-gray-300 hover:bg-gray-100 dark:hover:bg-gray-800"),title:u?"\uc2eb\uc5b4\uc694!":"\uc2eb\uc5b4\uc694",children:(0,v.jsx)("svg",{className:"w-4 h-4 rotate-180",fill:u?"currentColor":"none",viewBox:"0 0 24 24",stroke:"currentColor",strokeWidth:"2",children:(0,v.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M14 10h4.764a2 2 0 011.789 2.894l-3.5 7A2 2 0 0115.263 21h-4.017c-.163 0-.326-.02-.485-.60L7 20m7-10V5a2 2 0 00-2-2h-.095c-.5 0-.905.405-.905.905 0 .714-.211 1.412-.608 2.006L7 11v9m7-10h-2M7 20H5a2 2 0 01-2-2v-6a2 2 0 012-2h2.5"})})})]})]})})},M=e=>{let{projectId:t,projectName:r,promptCards:n=[]}=e;const[a,l]=(0,s.useState)(!1),{user:c}=(0,N.A)(),{currentConversationId:d,addMessage:u,setCurrentConversation:m}=(0,b.g)(),{createConversation:y}=p(),{messages:k,loading:j}=(e=>{const[t,r]=(0,s.useState)([]),[n,a]=(0,s.useState)(!1),[l,i]=(0,s.useState)(null),[c,d]=(0,s.useState)(!0),[u,m]=(0,s.useState)(null),g=(0,s.useCallback)(async function(){let s=arguments.length>0&&void 0!==arguments[0]&&arguments[0];if(e&&!n){console.log("useMessages - \uba54\uc2dc\uc9c0 \ub85c\ub4dc \uc2dc\uc791:",{conversationId:e,reset:s,cursor:s?null:u,currentMessagesCount:t.length}),a(!0),i(null);try{var l;const t=s?null:u,n=await o.Em.getMessages(e,t);console.log("useMessages - API \uc751\ub2f5:",{conversationId:e,messagesReceived:(null===(l=n.messages)||void 0===l?void 0:l.length)||0,hasMore:n.hasMore,nextCursor:n.nextCursor,reset:s}),r(s?n.messages:e=>[...n.messages,...e]),d(n.hasMore),m(n.nextCursor)}catch(c){console.error("\uba54\uc2dc\uc9c0 \ub85c\ub4dc \uc2e4\ud328:",c),console.error("\uc2e4\ud328\ud55c conversationId:",e),i("\uba54\uc2dc\uc9c0\ub97c \ubd88\ub7ec\uc624\ub294\ub370 \uc2e4\ud328\ud588\uc2b5\ub2c8\ub2e4.");const t=o.TI[e]||[];console.log("useMessages - Mock \ub370\uc774\ud130 \uc0ac\uc6a9:",{conversationId:e,mockMessagesCount:t.length}),s&&(r(t),d(!1),m(null))}finally{a(!1)}}else console.log("useMessages - \uba54\uc2dc\uc9c0 \ub85c\ub4dc \uc911\ub2e8:",{conversationId:e,loading:n})},[e,n,u,t.length]),x=(0,s.useCallback)(e=>{const t={id:e.timestamp||(new Date).toISOString(),role:e.role,content:e.content,tokenCount:e.tokenCount||0,timestamp:e.timestamp||(new Date).toISOString()};return r(e=>[...e,t]),t},[]),h=(0,s.useCallback)((e,t)=>{r(r=>r.map(r=>r.id===e?{...r,...t}:r))},[]),p=(0,s.useCallback)(e=>{r(t=>t.filter(t=>t.id!==e))},[]),b=(0,s.useCallback)(()=>c&&!n?g(!1):Promise.resolve(),[c,n,g]),v=(0,s.useCallback)(()=>{r([]),d(!0),m(null),i(null)},[]);return(0,s.useEffect)(()=>{console.log("\ud83d\udd0d [DEBUG] useMessages - conversationId \ubcc0\uacbd \uac10\uc9c0:",{conversationId:e,conversationIdType:typeof e,isConversationIdNull:null===e,isConversationIdUndefined:void 0===e,previousConversationId:e}),e?(console.log("\ud83d\udd0d [DEBUG] useMessages - \uba54\uc2dc\uc9c0 \ud074\ub9ac\uc5b4 \ubc0f \ub85c\ub4dc \uc2dc\uc791:",e),v(),g(!0)):(console.log("\ud83d\udd0d [DEBUG] useMessages - conversationId\uac00 null/undefined, \uba54\uc2dc\uc9c0 \ud074\ub9ac\uc5b4"),v())},[e]),{messages:t,loading:n,error:l,hasMore:c,addMessage:x,updateMessage:h,removeMessage:p,loadPreviousMessages:b,clearMessages:v,refresh:()=>g(!0)}})(d);console.log("\ud83d\udd0d [DEBUG] ChatWindow - useChat \ud638\ucd9c:",{projectId:t,projectName:r,currentConversationId:d,currentConversationIdType:typeof d,isCurrentConversationIdNull:null===d});const{messages:C,inputValue:S,handleInputChange:L,copiedMessage:E,isGenerating:D,inputHeight:M,handleSendMessage:R,handleStopGeneration:O,handleKeyPress:T,handleCopyMessage:W,handleCopyTitle:_,wsConnected:B,wsConnecting:P,selectedModel:U,setSelectedModel:G}=I(t,r,n,d),F=[...k,...C],z=(0,s.useCallback)(async()=>{if(console.log("\ud83d\udd0d [DEBUG] ChatWindow handleSendMessage - \uc804\uc1a1 \uc2dc\uc791:",{currentConversationId:d,inputValueLength:null===S||void 0===S?void 0:S.length,isGenerating:D}),!S.trim()||D)return;let e=d;if(!e){console.log("\ud83d\udd0d [DEBUG] \ub300\ud654 ID\uac00 \uc5c6\uc74c - \uc0c8 \ub300\ud654 \uc0dd\uc131 \uc2dc\uc791");try{const t=await y("\uc0c8 \ub300\ud654");console.log("\ud83d\udd0d [DEBUG] \uc0c8 \ub300\ud654 \uc0dd\uc131 \uc644\ub8cc:",{newConversationId:null===t||void 0===t?void 0:t.id,newConversation:t}),e=t.id,m(e),await new Promise(e=>setTimeout(e,100))}catch(t){console.error("\ud83d\udd0d [DEBUG] \ub300\ud654 \uc0dd\uc131 \uc2e4\ud328:",t)}}console.log("\ud83d\udd0d [DEBUG] \uba54\uc2dc\uc9c0 \uc804\uc1a1 \uc2dc conversationId:",e),await R()},[S,D,d,F,n,u,R,t,null===c||void 0===c?void 0:c.id]);return(0,v.jsxs)("div",{className:"flex h-full overflow-hidden",children:[(0,v.jsx)(f,{onCollapsedChange:l}),(0,v.jsxs)("div",{className:"flex-1 flex flex-col bg-gray-50 dark:bg-dark-primary transition-all duration-500 ease-out relative "+(a?"md:ml-14":"md:ml-64"),children:[(0,v.jsx)("div",{className:"flex-1 overflow-y-auto px-4 md:px-6 py-4 min-h-0 bg-gray-50 dark:bg-dark-primary transition-all duration-300 pt-4 pb-40",children:(0,v.jsx)("div",{className:"max-w-4xl mx-auto space-y-6",children:0!==F.length||j?(0,v.jsx)("div",{className:"space-y-6 pt-4",children:F.map(e=>(0,v.jsx)(A,{message:e,onCopyMessage:W,onCopyTitle:_,copiedMessage:E},e.id))}):(0,v.jsx)("div",{className:"flex flex-col items-center justify-center min-h-[calc(100vh-280px)]",children:(0,v.jsxs)("div",{className:"bg-white dark:bg-dark-secondary rounded-2xl shadow-md p-8 max-w-3xl w-full mx-auto transition-colors duration-300",children:[(0,v.jsx)("div",{className:"flex justify-center mb-6",children:(0,v.jsx)("div",{className:"bg-blue-100 dark:bg-dark-tertiary p-3 rounded-full",children:(0,v.jsx)(g.A,{className:"h-8 w-8 text-blue-600 dark:text-blue-400"})})}),(0,v.jsx)("h2",{className:"text-xl font-semibold text-center text-gray-800 dark:text-white mb-4",children:"AI \ud5e4\ub4dc\ub77c\uc778 \uc5b4\uc2dc\uc2a4\ud134\ud2b8"}),(0,v.jsx)("p",{className:"text-gray-600 dark:text-gray-300 text-center mb-6",children:"\ubcf8\ubb38\uc744 \uc785\ub825\ud558\uba74 AI\uac00 \ucd5c\uc801\uc758 \ud5e4\ub4dc\ub77c\uc778\uc744 \uc81c\uc548\ud574 \ub4dc\ub9bd\ub2c8\ub2e4."}),(0,v.jsxs)("div",{className:"space-y-4",children:[(0,v.jsxs)("div",{className:"flex items-start p-3 bg-gray-50 dark:bg-dark-tertiary rounded-lg",children:[(0,v.jsx)("div",{className:"mr-3 mt-1",children:(0,v.jsx)(i.A,{className:"h-5 w-5 text-blue-500 dark:text-blue-400"})}),(0,v.jsx)("div",{children:(0,v.jsxs)("p",{className:"text-sm text-gray-700 dark:text-gray-300",children:[(0,v.jsx)("span",{className:"font-medium",children:"\uc2dc\uc791\ud558\ub294 \ubc29\ubc95:"})," ","\uc544\ub798 \uc785\ub825\ucc3d\uc5d0 \ubcf8\ubb38\uc744 \ubd99\uc5ec\ub123\uace0 \uc804\uc1a1 \ubc84\ud2bc\uc744 \ud074\ub9ad\ud558\uc138\uc694"]})})]}),(0,v.jsxs)("div",{className:"flex items-start p-3 bg-gray-50 dark:bg-dark-tertiary rounded-lg",children:[(0,v.jsx)("div",{className:"mr-3 mt-1",children:(0,v.jsx)(i.A,{className:"h-5 w-5 text-blue-500 dark:text-blue-400"})}),(0,v.jsx)("div",{children:(0,v.jsxs)("p",{className:"text-sm text-gray-700 dark:text-gray-300",children:[(0,v.jsx)("span",{className:"font-medium",children:"\ub300\ud654 \uae30\ub85d:"})," \uc88c\uce21 \uba54\ub274\uc5d0\uc11c \uc774\uc804 \ub300\ud654\ub97c \ud655\uc778\ud558\uace0 \uc774\uc5b4\uc11c \ub300\ud654\ud560 \uc218 \uc788\uc2b5\ub2c8\ub2e4"]})})]})]})]})})})}),(0,v.jsx)("div",{className:"absolute bottom-0 left-0 right-0 bg-gray-50 dark:bg-dark-primary border-t border-gray-200 dark:border-gray-700 transition-all duration-500",children:(0,v.jsxs)("div",{className:"w-full max-w-4xl mx-auto px-4 md:px-6 py-6",children:[(0,v.jsxs)("div",{className:"w-full rounded-2xl bg-white dark:bg-[#2E333D] border border-gray-200 dark:border-transparent shadow-sm dark:shadow-none transition-all duration-200",children:[(0,v.jsxs)("div",{className:"flex items-center gap-3 px-5 py-4",children:[(0,v.jsx)("textarea",{value:S,onChange:e=>L(e.target.value),onKeyPress:T,placeholder:D?"\uc0dd\uc131 \uc911\uc785\ub2c8\ub2e4...":"\uae30\uc0ac \ubcf8\ubb38\uc744 \uc785\ub825\ud558\uc138\uc694...",className:"flex-1 resize-none bg-transparent text-gray-900 dark:text-gray-100 placeholder-gray-500 dark:placeholder-gray-400 focus:outline-none appearance-none",rows:1,style:{height:`${Math.max(M||24,24)}px`,minHeight:"24px",maxHeight:"200px",lineHeight:"1.5",overflowY:M>120?"auto":"hidden"},disabled:D}),D?(0,v.jsx)("button",{onClick:O,className:"shrink-0 rounded-full p-2.5 bg-red-500 hover:bg-red-600 text-white transition-all duration-200",children:(0,v.jsx)(x.A,{className:"w-4 h-4"})}):(0,v.jsx)("button",{onClick:z,disabled:!S.trim(),className:"shrink-0 rounded-full p-2.5 transition-all duration-200 "+(S.trim()?"bg-[#5E89FF] hover:bg-[#4A7BFF] text-white":"bg-gray-300 dark:bg-gray-600 text-gray-500 dark:text-gray-400 cursor-not-allowed"),children:(0,v.jsx)(h.A,{className:"w-4 h-4"})})]}),(0,v.jsxs)("div",{className:"flex items-center justify-between px-5 pb-3 pt-1",children:[(0,v.jsxs)("div",{className:"flex items-center gap-3",children:[(0,v.jsx)("div",{className:"scale-90 origin-left",children:(0,v.jsx)(w,{selectedModel:U,onModelChange:G})}),(0,v.jsxs)("div",{className:"text-xs text-gray-500 dark:text-gray-400",children:[S.length,"\uc790"]})]}),(0,v.jsx)("div",{className:"flex items-center gap-1.5",children:P?(0,v.jsxs)(v.Fragment,{children:[(0,v.jsx)("div",{className:"w-1.5 h-1.5 bg-yellow-500 rounded-full animate-pulse"}),(0,v.jsx)("span",{className:"text-xs text-yellow-600 dark:text-yellow-400",children:"\uc5f0\uacb0 \uc911"})]}):B?(0,v.jsxs)(v.Fragment,{children:[(0,v.jsx)("div",{className:"w-1.5 h-1.5 bg-green-500 rounded-full animate-pulse"}),(0,v.jsx)("span",{className:"text-xs text-green-600 dark:text-green-400",children:"\uc2e4\uc2dc\uac04 \uc2a4\ud2b8\ub9ac\ubc0d"})]}):(0,v.jsxs)(v.Fragment,{children:[(0,v.jsx)("div",{className:"w-1.5 h-1.5 bg-gray-400 rounded-full"}),(0,v.jsx)("span",{className:"text-xs text-gray-500 dark:text-gray-400",children:"\uc77c\ubc18 \ubaa8\ub4dc"})]})})]})]}),(0,v.jsx)("div",{className:"text-center mt-4",children:(0,v.jsx)("p",{className:"text-xs text-gray-500 dark:text-gray-400",children:"AI\ub294 \uc2e4\uc218\ub97c \ud560 \uc218 \uc788\uc2b5\ub2c8\ub2e4. \uc911\uc694\ud55c \uc815\ubcf4\ub294 \uc7ac\ucc28 \ud655\uc778\ud558\uc138\uc694."})})]})})]})]})},R=e=>{let{card:t,onEdit:r,onDelete:s}=e;return(0,v.jsxs)("div",{className:"bg-white dark:bg-gray-600 rounded-xl p-4 flex flex-col space-y-3 shadow-md dark:shadow-lg hover:shadow-lg dark:hover:shadow-xl transition-all duration-200 hover:bg-blue-50 dark:hover:bg-gray-500",children:[(0,v.jsxs)("div",{className:"flex items-start justify-between",children:[(0,v.jsx)("h3",{className:"font-semibold text-sm text-gray-800 dark:text-white leading-tight pr-2 flex-1",children:t.title||`\ud504\ub86c\ud504\ud2b8 ${t.promptId||t.prompt_id}`}),(0,v.jsxs)("div",{className:"flex items-center flex-shrink-0",children:[(0,v.jsx)("button",{onClick:async e=>{e.preventDefault(),e.stopPropagation(),await r()},className:"p-1 text-gray-500 dark:text-gray-400 rounded-full hover:bg-gray-100 dark:hover:bg-dark-secondary hover:text-blue-600 dark:hover:text-blue-400 transition-colors",children:(0,v.jsx)(c.A,{className:"h-4 w-4"})}),(0,v.jsx)("button",{onClick:s,className:"p-1 text-gray-500 dark:text-gray-400 rounded-full hover:bg-gray-100 dark:hover:bg-dark-secondary hover:text-red-600 dark:hover:text-red-400 transition-colors",children:(0,v.jsx)(d.A,{className:"h-4 w-4"})})]})]}),t.tags&&t.tags.length>0&&(0,v.jsxs)("div",{className:"flex flex-wrap gap-1.5",children:[t.tags.slice(0,3).map(e=>(0,v.jsxs)("span",{className:"px-2 py-0.5 text-xs bg-gray-100 dark:bg-dark-secondary text-gray-700 dark:text-gray-300 rounded-full",children:["#",e]},e)),t.tags.length>3&&(0,v.jsxs)("span",{className:"text-xs text-gray-500 dark:text-gray-400",children:["+",t.tags.length-3]})]}),(t.content||t.prompt_text)&&(0,v.jsx)("p",{className:"text-xs text-gray-600 dark:text-gray-300 leading-relaxed line-clamp-2",children:t.content||t.prompt_text}),(0,v.jsxs)("div",{className:"flex items-end justify-between pt-2 text-xs text-gray-400 dark:text-gray-500",children:[(0,v.jsxs)("span",{className:"flex-shrink-0",children:["\uc0dd\uc131:"," ",new Date(t.createdAt||new Date).toLocaleDateString("ko-KR",{year:"2-digit",month:"2-digit",day:"2-digit"})]}),t.updatedAt&&new Date(t.updatedAt)>new Date(t.createdAt)&&(0,v.jsxs)("span",{className:"flex-shrink-0 ml-2",children:["\uc218\uc815:"," ",new Date(t.updatedAt).toLocaleDateString("ko-KR",{year:"2-digit",month:"2-digit",day:"2-digit"})]})]})]})},O=e=>{let{isOpen:t,onSubmit:r,onCancel:n,initialData:o}=e;const[l,i]=(0,s.useState)({title:"",prompt_text:"",tags:[],enabled:!0}),[d,g]=(0,s.useState)("");(0,s.useEffect)(()=>{o&&i({title:o.title||"",prompt_text:o.prompt_text||o.content||"",tags:Array.isArray(o.tags)?[...o.tags]:[],enabled:!1!==o.enabled&&!1!==o.isActive})},[o]);const x=(e,t)=>{i(r=>({...r,[e]:t}))};return t?(0,v.jsx)("div",{className:"fixed inset-0 bg-black/50 backdrop-blur-sm z-50 flex items-center justify-center p-4",children:(0,v.jsxs)("div",{className:"bg-white dark:bg-dark-secondary rounded-2xl max-w-3xl w-full max-h-[90vh] overflow-hidden shadow-xl dark:shadow-none transition-colors duration-300 ",children:[(0,v.jsx)("div",{className:" p-6 bg-white dark:bg-dark-secondary",children:(0,v.jsxs)("div",{className:"flex items-center justify-between",children:[(0,v.jsxs)("div",{className:"flex items-center space-x-3",children:[(0,v.jsx)("div",{className:"w-10 h-10 bg-gray-100 dark:bg-dark-tertiary rounded-lg flex items-center justify-center",children:(0,v.jsx)(c.A,{className:"h-6 w-6 text-gray-600 dark:text-gray-300"})}),(0,v.jsxs)("div",{children:[(0,v.jsx)("h3",{className:"text-lg font-semibold text-gray-900 dark:text-white",children:o?"\ud504\ub86c\ud504\ud2b8 \ud3b8\uc9d1":"\uc0c8 \ud504\ub86c\ud504\ud2b8"}),(0,v.jsx)("p",{className:"text-sm text-gray-500 dark:text-gray-400",children:o?"\ud504\ub86c\ud504\ud2b8 \ub0b4\uc6a9\uc744 \uc218\uc815\ud558\uc138\uc694":"\uc0c8\ub85c\uc6b4 \ud504\ub86c\ud504\ud2b8\ub97c \uc791\uc131\ud558\uc138\uc694"})]})]}),(0,v.jsx)("button",{type:"button",onClick:n,className:"p-2 text-gray-400 dark:text-gray-500 hover:text-gray-600 dark:hover:text-gray-300 rounded-lg hover:bg-gray-100 dark:hover:bg-dark-tertiary transition-colors",children:(0,v.jsx)(u.A,{className:"h-5 w-5"})})]})}),(0,v.jsxs)("form",{onSubmit:e=>{e.preventDefault(),l.prompt_text.trim()?r(l):a.oR.error("\ud504\ub86c\ud504\ud2b8 \ub0b4\uc6a9\uc744 \uc785\ub825\ud574\uc8fc\uc138\uc694")},className:"p-6 space-y-6 overflow-y-auto max-h-[calc(90vh-120px)]",children:[(0,v.jsxs)("div",{className:"space-y-2",children:[(0,v.jsx)("label",{className:"flex items-center text-sm font-semibold text-gray-800 dark:text-gray-200",children:"\ud504\ub86c\ud504\ud2b8 \uc81c\ubaa9"}),(0,v.jsx)("input",{type:"text",value:l.title,onChange:e=>x("title",e.target.value),className:"w-full px-4 py-3  rounded-xl bg-gray-50 dark:bg-dark-tertiary text-gray-900 dark:text-white placeholder-gray-500 dark:placeholder-gray-400 focus:outline-none focus:border-blue-500 focus:ring-2 focus:ring-blue-500/20 dark:focus:ring-blue-500/30 transition-all duration-200",placeholder:"\ud504\ub86c\ud504\ud2b8 \uc81c\ubaa9\uc744 \uc785\ub825\ud558\uc138\uc694"})]}),(0,v.jsxs)("div",{className:"space-y-2",children:[(0,v.jsxs)("label",{className:"flex items-center text-sm font-semibold text-gray-800 dark:text-gray-200",children:[(0,v.jsx)(m.A,{className:"h-4 w-4 mr-2 text-gray-500 dark:text-gray-400"}),"\ud0dc\uadf8"]}),(0,v.jsxs)("div",{className:"space-y-3",children:[(0,v.jsx)("input",{type:"text",value:d,onChange:e=>g(e.target.value),onKeyPress:e=>{if("Enter"===e.key&&d.trim()){e.preventDefault();const t=d.trim();!l.tags.includes(t)&&l.tags.length<5&&i(e=>({...e,tags:[...e.tags,t]})),g("")}},className:"w-full px-4 py-3  rounded-xl bg-gray-50 dark:bg-dark-tertiary text-gray-900 dark:text-white placeholder-gray-500 dark:placeholder-gray-400 focus:outline-none focus:border-blue-500 focus:ring-2 focus:ring-blue-500/20 dark:focus:ring-blue-500/30 transition-all duration-200",placeholder:"\ud0dc\uadf8\ub97c \uc785\ub825\ud558\uace0 Enter\ub97c \ub204\ub974\uc138\uc694 (\ucd5c\ub300 5\uac1c)",maxLength:20,disabled:l.tags.length>=5}),l.tags.length>0&&(0,v.jsx)("div",{className:"flex flex-wrap gap-2",children:l.tags.map((e,t)=>(0,v.jsxs)("span",{className:"inline-flex items-center px-3 py-1 bg-blue-100 dark:bg-blue-900 text-blue-800 dark:text-blue-200 text-sm rounded-full",children:["#",e,(0,v.jsx)("button",{type:"button",onClick:()=>{return t=e,void i(e=>({...e,tags:e.tags.filter(e=>e!==t)}));var t},className:"ml-2 text-blue-600 dark:text-blue-400 hover:text-blue-800 dark:hover:text-blue-200",children:(0,v.jsx)(u.A,{className:"h-3 w-3"})})]},t))}),(0,v.jsx)("p",{className:"text-xs text-gray-500 dark:text-gray-400",children:"\ud0dc\uadf8\ub294 \ud504\ub86c\ud504\ud2b8\ub97c \ubd84\ub958\ud558\uace0 \uac80\uc0c9\ud558\ub294 \ub370 \ub3c4\uc6c0\uc774 \ub429\ub2c8\ub2e4. \uac01 \ud0dc\uadf8\ub294 20\uc790 \uc774\ub0b4\ub85c \uc785\ub825\ud558\uc138\uc694."})]})]}),(0,v.jsxs)("div",{className:"space-y-2",children:[(0,v.jsxs)("label",{className:"flex items-center text-sm font-semibold text-gray-800 dark:text-gray-200",children:["\ud504\ub86c\ud504\ud2b8 \ub0b4\uc6a9 ",(0,v.jsx)("span",{className:"text-red-500 ml-1",children:"*"})]}),(0,v.jsxs)("div",{className:"relative",children:[(0,v.jsx)("textarea",{value:l.prompt_text,onChange:e=>x("prompt_text",e.target.value),rows:12,className:"w-full px-4 py-3  rounded-xl bg-gray-50 dark:bg-dark-tertiary text-gray-900 dark:text-white placeholder-gray-500 dark:placeholder-gray-400 focus:outline-none focus:border-green-500 focus:ring-2 focus:ring-green-500/20 dark:focus:ring-green-500/30 transition-all duration-200 resize-none",placeholder:"\ud504\ub86c\ud504\ud2b8 \ub0b4\uc6a9\uc744 \uc785\ub825\ud558\uc138\uc694",required:!0}),(0,v.jsxs)("div",{className:"absolute bottom-3 right-3 text-xs text-gray-500 dark:text-gray-400 flex items-center space-x-2",children:[(0,v.jsxs)("span",{children:[l.prompt_text.length," \uc790"]}),(0,v.jsx)("span",{className:"text-gray-400 dark:text-gray-500",children:"/ \ud83d\udcdd 50\uc790 \uc774\uc0c1 \uad8c\uc7a5"})]})]})]}),(0,v.jsxs)("div",{className:"flex items-center",children:[(0,v.jsx)("input",{type:"checkbox",id:"enabled",checked:l.enabled,onChange:e=>x("enabled",e.target.checked),className:"h-4 w-4 text-blue-600 focus:ring-blue-500 rounded"}),(0,v.jsx)("label",{htmlFor:"enabled",className:"ml-2 text-sm text-gray-700 dark:text-gray-300",children:"\ud65c\uc131\ud654"})]}),(0,v.jsxs)("div",{className:"flex justify-end space-x-3 pt-6 ",children:[(0,v.jsx)("button",{type:"button",onClick:n,className:"px-6 py-2.5 text-gray-700 dark:text-gray-300 bg-gray-100 dark:bg-gray-700  rounded-lg hover:bg-gray-200 dark:hover:bg-gray-600 transition-colors font-medium",children:"\ucde8\uc18c"}),(0,v.jsx)("button",{type:"submit",disabled:!l.prompt_text.trim(),className:"px-6 py-2.5 bg-gradient-to-r from-blue-600 to-blue-700 hover:from-blue-700 hover:to-blue-800 text-white rounded-lg disabled:opacity-50 disabled:cursor-not-allowed transition-all duration-200 font-medium shadow-lg hover:shadow-xl",children:o?"\uc218\uc815":"\uc0dd\uc131"})]})]})]})}):null},T=e=>{let{projectId:t,projectName:r}=e;const[n,c]=(0,s.useState)([]),[d,u]=(0,s.useState)(!0),[m,g]=(0,s.useState)(null),[x,h]=(0,s.useState)(!1);(0,s.useEffect)(()=>{p()},[t]);const p=async()=>{try{u(!0);const e=await o.dF.getPromptCards(t,!0);c(e.promptCards||[])}catch(e){console.error("\ud504\ub86c\ud504\ud2b8 \uce74\ub4dc \ub85c\ub4dc \uc2e4\ud328:",e);const t=(0,o.t6)(e);a.oR.error(t.message)}finally{u(!1)}},b=()=>{console.log("\uc0c8 \ud504\ub86c\ud504\ud2b8 \ucd94\uac00 \ubc84\ud2bc \ud074\ub9ad"),g(null),h(!0)};return d?(0,v.jsx)("div",{className:"flex items-center justify-center h-64",children:(0,v.jsx)("div",{className:"animate-spin rounded-full h-8 w-8 border-b-2 border-blue-600"})}):(0,v.jsxs)("div",{className:"flex h-full w-full bg-gray-50 dark:bg-dark-primary",children:[(0,v.jsx)("div",{className:"flex-1 min-w-0 overflow-hidden",children:(0,v.jsx)(M,{projectId:t,projectName:r,promptCards:n})}),(0,v.jsxs)("div",{className:"w-80 bg-white dark:bg-dark-primary flex flex-col shadow-lg border-l border-gray-200 dark:border-gray-700 flex-shrink-0",children:[(0,v.jsx)("div",{className:"flex-shrink-0 p-4 bg-gray-50 dark:bg-dark-primary",children:(0,v.jsxs)("div",{className:"flex items-center justify-between",children:[(0,v.jsx)("h2",{className:"text-lg font-semibold text-gray-800 dark:text-white",children:"\ud504\ub86c\ud504\ud2b8 \uce74\ub4dc"}),(0,v.jsxs)("button",{onClick:b,className:"inline-flex items-center px-4 py-2 text-sm bg-blue-600 dark:bg-blue-500 text-white rounded-lg hover:bg-blue-700 dark:hover:bg-blue-600 transition-colors shadow-md hover:shadow-lg font-medium",children:[(0,v.jsx)(l.A,{className:"h-4 w-4 mr-1.5"}),"\uc0c8 \ucd94\uac00"]})]})}),(0,v.jsx)("div",{className:"flex-1 overflow-y-auto p-4 space-y-3 min-h-0 max-h-[calc(100vh-140px)] bg-gray-50 dark:bg-dark-secondary custom-scrollbar",children:0===n.length?(0,v.jsxs)("div",{className:"text-center py-8",children:[(0,v.jsx)(i.A,{className:"h-12 w-12 text-gray-300 dark:text-gray-600 mx-auto mb-4"}),(0,v.jsx)("p",{className:"text-gray-500 dark:text-gray-400 mb-4",children:"\ud504\ub86c\ud504\ud2b8 \uce74\ub4dc\uac00 \uc5c6\uc2b5\ub2c8\ub2e4"}),(0,v.jsxs)("button",{onClick:b,className:"inline-flex items-center px-4 py-2 bg-blue-600 dark:bg-blue-500 text-white rounded-lg hover:bg-blue-700 dark:hover:bg-blue-600 transition-colors shadow-sm font-medium",children:[(0,v.jsx)(l.A,{className:"h-4 w-4 mr-1.5"}),"\uccab \ubc88\uc9f8 \uce74\ub4dc \ub9cc\ub4e4\uae30"]})]}):n.map(e=>(0,v.jsx)(R,{card:e,onEdit:()=>(async e=>{console.log("\ud504\ub86c\ud504\ud2b8 \uc218\uc815 \ubc84\ud2bc \ud074\ub9ad:",e);let r={...e};if(!e.prompt_text&&!e.content)try{var s;console.log("S3\uc5d0\uc11c \ud504\ub86c\ud504\ud2b8 \ub0b4\uc6a9 \ub85c\ub4dc \uc911...");const n=await o.dF.getPromptContent(t,e.promptId||e.prompt_id);r.prompt_text=n.content,console.log("S3\uc5d0\uc11c \ud504\ub86c\ud504\ud2b8 \ub0b4\uc6a9 \ub85c\ub4dc \uc644\ub8cc:",null===(s=n.content)||void 0===s?void 0:s.length,"\ubb38\uc790")}catch(n){return console.error("\ud504\ub86c\ud504\ud2b8 \ub0b4\uc6a9 \ub85c\ub4dc \uc2e4\ud328:",n),void a.oR.error("\ud504\ub86c\ud504\ud2b8 \ub0b4\uc6a9\uc744 \ubd88\ub7ec\uc62c \uc218 \uc5c6\uc2b5\ub2c8\ub2e4")}g(r),h(!0)})(e),onDelete:()=>(async e=>{if(window.confirm("\uc815\ub9d0\ub85c \uc774 \ud504\ub86c\ud504\ud2b8\ub97c \uc0ad\uc81c\ud558\uc2dc\uaca0\uc2b5\ub2c8\uae4c?"))try{await o.dF.deletePromptCard(t,e),a.oR.success("\ud504\ub86c\ud504\ud2b8\uac00 \uc0ad\uc81c\ub418\uc5c8\uc2b5\ub2c8\ub2e4"),c(t=>t.filter(t=>(t.promptId||t.prompt_id)!==e)),await p()}catch(r){console.error("\ud504\ub86c\ud504\ud2b8 \uc0ad\uc81c \uc2e4\ud328:",r);const e=(0,o.t6)(r);a.oR.error(e.message)}})(e.promptId||e.prompt_id)},e.promptId||e.prompt_id))})]}),x&&(0,v.jsx)(O,{isOpen:x,onSubmit:async e=>{try{const r={title:e.title,prompt_text:e.prompt_text,tags:e.tags||[],isActive:!1!==e.enabled};m?(await o.dF.updatePromptCard(t,m.promptId||m.prompt_id,r),a.oR.success("\ud504\ub86c\ud504\ud2b8\uac00 \uc218\uc815\ub418\uc5c8\uc2b5\ub2c8\ub2e4")):(await o.dF.createPromptCard(t,r),a.oR.success("\ud504\ub86c\ud504\ud2b8\uac00 \uc0dd\uc131\ub418\uc5c8\uc2b5\ub2c8\ub2e4")),h(!1),g(null),await p()}catch(r){console.error("\ud504\ub86c\ud504\ud2b8 \uc800\uc7a5 \uc2e4\ud328:",r);const e=(0,o.t6)(r);a.oR.error(e.message)}},onCancel:()=>{console.log("\ubaa8\ub2ec \ucde8\uc18c \ubc84\ud2bc \ud074\ub9ad"),h(!1),g(null)},initialData:m}),(0,v.jsx)("style",{jsx:!0,children:"\n        .custom-scrollbar::-webkit-scrollbar {\n          width: 8px;\n        }\n        .custom-scrollbar::-webkit-scrollbar-track {\n          background: transparent;\n          border-radius: 4px;\n        }\n        .custom-scrollbar::-webkit-scrollbar-thumb {\n          background: #d1d5db;\n          border-radius: 4px;\n          border: 1px solid #f3f4f6;\n        }\n        .custom-scrollbar::-webkit-scrollbar-thumb:hover {\n          background: #9ca3af;\n        }\n        .custom-scrollbar::-webkit-scrollbar-thumb:active {\n          background: #6b7280;\n        }\n        /* \ub2e4\ud06c\ubaa8\ub4dc \uc2a4\ud06c\ub864\ubc14 */\n        .dark .custom-scrollbar::-webkit-scrollbar-thumb {\n          background: #4b5563;\n          border: 1px solid #374151;\n        }\n        .dark .custom-scrollbar::-webkit-scrollbar-thumb:hover {\n          background: #6b7280;\n        }\n        .dark .custom-scrollbar::-webkit-scrollbar-thumb:active {\n          background: #9ca3af;\n        }\n      "})]})},W=e=>{let{projectId:t,projectName:r}=e;return(0,v.jsx)("div",{className:"h-full w-full bg-white dark:bg-dark-primary transition-colors duration-300",children:(0,v.jsx)(T,{projectId:t,projectName:r})})};var _=r(4546);const B=e=>{let{projectId:t,projectName:r}=e;const[n,a]=(0,s.useState)([]),[l,i]=(0,s.useState)(!0);return(0,s.useEffect)(()=>{(async()=>{try{i(!0);const e=await o.dF.getPromptCards(t,!0);a(e.promptCards||[])}catch(e){console.warn("\ud504\ub86c\ud504\ud2b8 \uce74\ub4dc \ub85c\ub4dc \uc2e4\ud328:",e),a([])}finally{i(!1)}})()},[t]),l?(0,v.jsx)(_.P7,{}):(0,v.jsx)("div",{className:"h-screen bg-white dark:bg-dark-primary transition-colors duration-300",children:(0,v.jsx)(M,{projectId:t,projectName:r,promptCards:n})})},P=()=>{const{projectId:e}=(0,n.g)(),t=(0,n.Zp)(),{user:r}=(0,N.A)(),[l,i]=(0,s.useState)(null),[c,d]=(0,s.useState)(!0);(0,s.useEffect)(()=>{u()},[e,t]);const u=async()=>{try{let t;if(d(!0),"user"===(null===r||void 0===r?void 0:r.role))if(e&&"default"!==e)try{t=await o._x.getProject(e)}catch(s){console.log("API \ud638\ucd9c \uc2e4\ud328, \uae30\ubcf8 \ud504\ub85c\uc81d\ud2b8 \uc0ac\uc6a9:",s),t={projectId:"4039d9fc-d318-4903-804e-9cf5bf05ba8e",name:"\uc11c\uc6b8\uacbd\uc81c",description:"\uc11c\uc6b8\uacbd\uc81c\uc2e0\ubb38 AI \uc81c\ubaa9 \uc0dd\uc131 \uc2dc\uc2a4\ud15c",promptCards:[],createdAt:(new Date).toISOString(),updatedAt:(new Date).toISOString()}}else t={projectId:"4039d9fc-d318-4903-804e-9cf5bf05ba8e",name:"\uc11c\uc6b8\uacbd\uc81c",description:"\uc11c\uc6b8\uacbd\uc81c\uc2e0\ubb38 AI \uc81c\ubaa9 \uc0dd\uc131 \uc2dc\uc2a4\ud15c",promptCards:[],createdAt:(new Date).toISOString(),updatedAt:(new Date).toISOString()};else try{t=await o._x.getProject(e)}catch(s){throw console.error("\uad00\ub9ac\uc790 \ud504\ub85c\uc81d\ud2b8 \ub85c\ub4dc \uc2e4\ud328:",s),s}i(t)}catch(s){console.error("\ud504\ub85c\uc81d\ud2b8 \ub85c\ub4dc \uc2e4\ud328:",s);const e=(0,o.t6)(s);a.oR.error(e.message),"admin"===(null===r||void 0===r?void 0:r.role)?t("/projects"):t("/dashboard")}finally{d(!1)}};return c?(0,v.jsx)(_.P7,{}):l?(0,v.jsx)("div",{className:"min-h-screen w-full bg-gray-50 dark:bg-dark-primary transition-all duration-500",children:"admin"===(null===r||void 0===r?void 0:r.role)?(0,v.jsx)(W,{projectId:l.projectId||e,projectName:l.name}):(0,v.jsx)(B,{projectId:l.projectId||e,projectName:l.name})}):(0,v.jsx)("div",{className:"min-h-screen bg-gray-50 dark:bg-gray-900 flex items-center justify-center transition-colors duration-200",children:(0,v.jsxs)("div",{className:"text-center",children:[(0,v.jsx)("h2",{className:"text-xl font-semibold text-gray-900 dark:text-white mb-4",children:"\ud504\ub85c\uc81d\ud2b8\ub97c \ucc3e\uc744 \uc218 \uc5c6\uc2b5\ub2c8\ub2e4"}),(0,v.jsx)("button",{onClick:()=>{"admin"===(null===r||void 0===r?void 0:r.role)?t("/projects"):t("/dashboard")},className:"inline-flex items-center px-4 py-2 text-sm font-medium rounded-md text-blue-700 dark:text-blue-300 bg-blue-100 dark:bg-blue-900 hover:bg-blue-200 dark:hover:bg-blue-800 focus:outline-none transition-colors duration-200",children:"admin"===(null===r||void 0===r?void 0:r.role)?"\ud504\ub85c\uc81d\ud2b8 \ubaa9\ub85d\uc73c\ub85c":"\ub300\uc2dc\ubcf4\ub4dc\ub85c"})]})})}}}]);
//# sourceMappingURL=451.4f58e70f.chunk.js.map