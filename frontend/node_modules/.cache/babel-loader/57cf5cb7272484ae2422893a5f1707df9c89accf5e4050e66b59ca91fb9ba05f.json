{"ast":null,"code":"var _jsxFileName = \"/Users/yeong-gwang/Documents/work/\\u1109\\u1165\\u110B\\u116E\\u11AF\\u1100\\u1167\\u11BC\\u110C\\u1166\\u1109\\u1175\\u11AB\\u1106\\u116E\\u11AB/ai_\\u110C\\u1166\\u1106\\u1169\\u11A8\\u1103\\u1161\\u11AF\\u1100\\u1175/frontend/src/components/prompts/InlineEditablePromptCard.js\",\n  _s = $RefreshSig$(),\n  _s2 = $RefreshSig$();\nimport React, { useState, useRef, useEffect } from \"react\";\nimport { PencilIcon, CheckIcon, XMarkIcon, EyeIcon, EyeSlashIcon, DocumentTextIcon, ClockIcon, ExclamationTriangleIcon } from \"@heroicons/react/24/outline\";\nimport { promptCardAPI } from \"../../services/api\";\nimport { toast } from \"react-hot-toast\";\n\n// 디바운스 훅\nimport { jsxDEV as _jsxDEV } from \"react/jsx-dev-runtime\";\nconst useDebounce = (value, delay) => {\n  _s();\n  const [debouncedValue, setDebouncedValue] = useState(value);\n  useEffect(() => {\n    const handler = setTimeout(() => {\n      setDebouncedValue(value);\n    }, delay);\n    return () => {\n      clearTimeout(handler);\n    };\n  }, [value, delay]);\n  return debouncedValue;\n};\n_s(useDebounce, \"KDuPAtDOgxm8PU6legVJOb3oOmA=\");\nconst InlineEditablePromptCard = ({\n  card,\n  projectId,\n  onUpdate,\n  onToggle,\n  isCurrentStep = false,\n  isExecuted = false,\n  isExecuting = false,\n  hideDeleteButton = true\n}) => {\n  _s2();\n  const [isEditing, setIsEditing] = useState(false);\n  const [editText, setEditText] = useState(card.prompt_text || '');\n  const [isSaving, setIsSaving] = useState(false);\n  const [lastSaved, setLastSaved] = useState(null);\n  const [hasUnsavedChanges, setHasUnsavedChanges] = useState(false);\n  const [validationErrors, setValidationErrors] = useState([]);\n  const textareaRef = useRef(null);\n  const originalText = useRef(card.prompt_text || '');\n\n  // 디바운스된 텍스트 (자동 저장용)\n  const debouncedText = useDebounce(editText, 2000);\n\n  // 카테고리 정보\n  const getCategoryInfo = categoryId => {\n    const categories = {\n      instruction: {\n        name: \"역할 및 목표\",\n        color: \"bg-blue-100/80 text-blue-700 border-blue-200/80\",\n        description: \"AI의 역할, 정체성, 핵심 목표를 명확히 정의합니다\"\n      },\n      knowledge: {\n        name: \"지식 베이스\",\n        color: \"bg-green-100/80 text-green-700 border-green-200/80\",\n        description: \"작업 수행에 필요한 핵심 지식과 원칙을 제공합니다\"\n      },\n      secondary: {\n        name: \"CoT (사고 과정)\",\n        color: \"bg-purple-100/80 text-purple-700 border-purple-200/80\",\n        description: \"단계별 추론 과정을 통해 사고의 투명성을 확보합니다\"\n      },\n      style_guide: {\n        name: \"스타일 가이드\",\n        color: \"bg-yellow-100/80 text-yellow-700 border-yellow-200/80\",\n        description: \"일관된 스타일과 형식을 유지하기 위한 가이드라인\"\n      },\n      validation: {\n        name: \"ReAct (추론+행동)\",\n        color: \"bg-orange-100/80 text-orange-700 border-orange-200/80\",\n        description: \"추론과 행동을 결합하여 더 정확한 결과를 도출합니다\"\n      },\n      enhancement: {\n        name: \"품질 검증\",\n        color: \"bg-indigo-100/80 text-indigo-700 border-indigo-200/80\",\n        description: \"최종 결과물의 품질을 검증하고 개선합니다\"\n      }\n    };\n    return categories[categoryId] || {\n      name: categoryId,\n      color: \"bg-gray-100/80 text-gray-700 border-gray-200/80\",\n      description: \"사용자 정의 프롬프트\"\n    };\n  };\n  const categoryInfo = getCategoryInfo(card.category);\n\n  // 프롬프트 검증\n  const validatePrompt = text => {\n    const errors = [];\n    if (!text.trim()) {\n      errors.push('프롬프트 내용이 비어있습니다');\n    } else if (text.length < 10) {\n      errors.push('프롬프트가 너무 짧습니다 (최소 10자)');\n    } else if (text.length > 4000) {\n      errors.push('프롬프트가 너무 깁니다 (최대 4000자)');\n    }\n\n    // CoT 패턴 체크\n    if (card.category === 'secondary' && text.trim() && !text.includes('단계')) {\n      errors.push('CoT 프롬프트에는 단계별 지침이 포함되어야 합니다');\n    }\n\n    // ReAct 패턴 체크\n    if (card.category === 'validation' && text.trim()) {\n      const hasThought = text.toLowerCase().includes('thought');\n      const hasAction = text.toLowerCase().includes('action');\n      if (!hasThought || !hasAction) {\n        errors.push('ReAct 프롬프트에는 Thought와 Action이 포함되어야 합니다');\n      }\n    }\n    return errors;\n  };\n\n  // 텍스트 변경 시 검증\n  useEffect(() => {\n    if (isEditing) {\n      const errors = validatePrompt(editText);\n      setValidationErrors(errors);\n      setHasUnsavedChanges(editText !== originalText.current);\n    }\n  }, [editText, isEditing, card.category]);\n\n  // 자동 저장\n  useEffect(() => {\n    if (isEditing && debouncedText !== originalText.current && debouncedText.trim()) {\n      if (validationErrors.length === 0) {\n        handleAutoSave();\n      }\n    }\n  }, [debouncedText]);\n\n  // 편집 모드 진입\n  const startEditing = () => {\n    setIsEditing(true);\n    setEditText(card.prompt_text || '');\n    originalText.current = card.prompt_text || '';\n    setTimeout(() => {\n      if (textareaRef.current) {\n        textareaRef.current.focus();\n        textareaRef.current.style.height = 'auto';\n        textareaRef.current.style.height = textareaRef.current.scrollHeight + 'px';\n      }\n    }, 0);\n  };\n\n  // 편집 모드 종료\n  const stopEditing = () => {\n    setIsEditing(false);\n    setEditText(card.prompt_text || '');\n    setValidationErrors([]);\n    setHasUnsavedChanges(false);\n  };\n\n  // 수동 저장\n  const handleSave = async () => {\n    if (validationErrors.length > 0) {\n      toast.error('프롬프트에 오류가 있습니다. 수정 후 다시 시도해주세요.');\n      return;\n    }\n    await savePrompt();\n  };\n\n  // 자동 저장\n  const handleAutoSave = async () => {\n    await savePrompt(true);\n  };\n\n  // 프롬프트 저장\n  const savePrompt = async (isAutoSave = false) => {\n    if (isSaving) return;\n    setIsSaving(true);\n    try {\n      const updatedCard = {\n        ...card,\n        prompt_text: editText.trim()\n      };\n      await promptCardAPI.updatePromptCard(projectId, card.promptId || card.id, updatedCard);\n\n      // 상태 업데이트\n      originalText.current = editText.trim();\n      setHasUnsavedChanges(false);\n      setLastSaved(new Date());\n      if (onUpdate) {\n        onUpdate(updatedCard);\n      }\n      if (!isAutoSave) {\n        toast.success('프롬프트가 저장되었습니다');\n        setIsEditing(false);\n      } else {\n        toast.success('자동 저장 완료', {\n          duration: 1000\n        });\n      }\n    } catch (error) {\n      console.error('프롬프트 저장 실패:', error);\n      toast.error('저장에 실패했습니다. 다시 시도해주세요.');\n    } finally {\n      setIsSaving(false);\n    }\n  };\n\n  // 텍스트 영역 높이 자동 조절\n  const handleTextChange = e => {\n    setEditText(e.target.value);\n\n    // 높이 자동 조절\n    if (textareaRef.current) {\n      textareaRef.current.style.height = 'auto';\n      textareaRef.current.style.height = textareaRef.current.scrollHeight + 'px';\n    }\n  };\n\n  // 토글 처리\n  const handleToggle = async () => {\n    try {\n      await onToggle(card.promptId || card.id, !card.enabled);\n    } catch (error) {\n      console.error(\"카드 토글 실패:\", error);\n    }\n  };\n\n  // ESC 키로 편집 취소\n  const handleKeyDown = e => {\n    if (e.key === 'Escape') {\n      stopEditing();\n    }\n  };\n\n  // 카드 스타일\n  const getCardStyles = () => {\n    let baseStyles = \"relative bg-white border-2 rounded-lg p-4 transition-all duration-200 group\";\n    if (isCurrentStep) {\n      baseStyles += \" ring-2 ring-blue-400 border-blue-300 bg-blue-50\";\n    } else if (isExecuted) {\n      baseStyles += \" ring-2 ring-green-400 border-green-300 bg-green-50\";\n    } else if (isEditing) {\n      baseStyles += \" ring-2 ring-purple-400 border-purple-300 bg-purple-50\";\n    } else if (card.enabled) {\n      baseStyles += \" border-gray-200 hover:border-gray-300 hover:shadow-md\";\n    } else {\n      baseStyles += \" border-gray-200 bg-gray-50 opacity-60\";\n    }\n    return baseStyles;\n  };\n  return /*#__PURE__*/_jsxDEV(\"div\", {\n    className: getCardStyles(),\n    children: [isExecuting && /*#__PURE__*/_jsxDEV(\"div\", {\n      className: \"absolute -top-2 -right-2 z-10\",\n      children: /*#__PURE__*/_jsxDEV(\"div\", {\n        className: \"flex items-center justify-center w-6 h-6 bg-blue-500 text-white rounded-full shadow-lg\",\n        children: /*#__PURE__*/_jsxDEV(\"div\", {\n          className: \"animate-spin rounded-full h-3 w-3 border border-t-transparent border-white\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 272,\n          columnNumber: 13\n        }, this)\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 271,\n        columnNumber: 11\n      }, this)\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 270,\n      columnNumber: 9\n    }, this), isSaving && /*#__PURE__*/_jsxDEV(\"div\", {\n      className: \"absolute top-2 right-2 z-10\",\n      children: /*#__PURE__*/_jsxDEV(\"div\", {\n        className: \"flex items-center gap-1 text-xs text-blue-600 bg-white px-2 py-1 rounded shadow-md\",\n        children: [/*#__PURE__*/_jsxDEV(ClockIcon, {\n          className: \"h-3 w-3 animate-spin\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 281,\n          columnNumber: 13\n        }, this), /*#__PURE__*/_jsxDEV(\"span\", {\n          children: \"\\uC800\\uC7A5 \\uC911...\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 282,\n          columnNumber: 13\n        }, this)]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 280,\n        columnNumber: 11\n      }, this)\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 279,\n      columnNumber: 9\n    }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n      className: \"flex items-start justify-between mb-3\",\n      children: [/*#__PURE__*/_jsxDEV(\"div\", {\n        className: \"flex items-center gap-2 flex-1\",\n        children: /*#__PURE__*/_jsxDEV(\"div\", {\n          className: `inline-flex items-center px-3 py-1 rounded-full text-sm font-medium border ${categoryInfo.color}`,\n          children: [/*#__PURE__*/_jsxDEV(DocumentTextIcon, {\n            className: \"h-4 w-4 mr-1\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 291,\n            columnNumber: 13\n          }, this), /*#__PURE__*/_jsxDEV(\"span\", {\n            children: categoryInfo.name\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 292,\n            columnNumber: 13\n          }, this)]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 290,\n          columnNumber: 11\n        }, this)\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 289,\n        columnNumber: 9\n      }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n        className: \"flex items-center gap-1\",\n        children: [/*#__PURE__*/_jsxDEV(\"button\", {\n          onClick: handleToggle,\n          className: `p-2 rounded-lg transition-colors ${card.enabled ? \"text-green-600 hover:bg-green-50\" : \"text-gray-400 hover:bg-gray-100\"}`,\n          title: card.enabled ? \"비활성화\" : \"활성화\",\n          children: card.enabled ? /*#__PURE__*/_jsxDEV(EyeIcon, {\n            className: \"h-4 w-4\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 309,\n            columnNumber: 15\n          }, this) : /*#__PURE__*/_jsxDEV(EyeSlashIcon, {\n            className: \"h-4 w-4\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 311,\n            columnNumber: 15\n          }, this)\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 299,\n          columnNumber: 11\n        }, this), !isEditing ? /*#__PURE__*/_jsxDEV(\"button\", {\n          onClick: startEditing,\n          className: \"p-2 text-gray-600 hover:bg-blue-50 hover:text-blue-600 rounded-lg transition-colors\",\n          title: \"\\uD3B8\\uC9D1\",\n          children: /*#__PURE__*/_jsxDEV(PencilIcon, {\n            className: \"h-4 w-4\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 322,\n            columnNumber: 15\n          }, this)\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 317,\n          columnNumber: 13\n        }, this) : /*#__PURE__*/_jsxDEV(\"div\", {\n          className: \"flex items-center gap-1\",\n          children: [/*#__PURE__*/_jsxDEV(\"button\", {\n            onClick: handleSave,\n            disabled: validationErrors.length > 0 || isSaving,\n            className: `p-2 rounded-lg transition-colors ${validationErrors.length > 0 || isSaving ? \"text-gray-400 cursor-not-allowed\" : \"text-green-600 hover:bg-green-50\"}`,\n            title: \"\\uC800\\uC7A5\",\n            children: /*#__PURE__*/_jsxDEV(CheckIcon, {\n              className: \"h-4 w-4\"\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 336,\n              columnNumber: 17\n            }, this)\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 326,\n            columnNumber: 15\n          }, this), /*#__PURE__*/_jsxDEV(\"button\", {\n            onClick: stopEditing,\n            className: \"p-2 text-red-600 hover:bg-red-50 rounded-lg transition-colors\",\n            title: \"\\uCDE8\\uC18C\",\n            children: /*#__PURE__*/_jsxDEV(XMarkIcon, {\n              className: \"h-4 w-4\"\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 343,\n              columnNumber: 17\n            }, this)\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 338,\n            columnNumber: 15\n          }, this)]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 325,\n          columnNumber: 13\n        }, this)]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 297,\n        columnNumber: 9\n      }, this)]\n    }, void 0, true, {\n      fileName: _jsxFileName,\n      lineNumber: 288,\n      columnNumber: 7\n    }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n      className: \"text-sm text-gray-600 mb-3 leading-relaxed\",\n      children: categoryInfo.description\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 351,\n      columnNumber: 7\n    }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n      className: \"space-y-2\",\n      children: !isEditing ?\n      /*#__PURE__*/\n      // 읽기 모드\n      _jsxDEV(\"div\", {\n        className: \"min-h-[100px] p-3 bg-gray-50 rounded-lg border cursor-pointer hover:bg-gray-100 transition-colors\",\n        onClick: startEditing,\n        title: \"\\uD074\\uB9AD\\uD558\\uC5EC \\uD3B8\\uC9D1\",\n        children: /*#__PURE__*/_jsxDEV(\"div\", {\n          className: \"text-sm text-gray-800 whitespace-pre-wrap leading-relaxed\",\n          children: card.prompt_text || /*#__PURE__*/_jsxDEV(\"span\", {\n            className: \"text-gray-400 italic\",\n            children: \"\\uD504\\uB86C\\uD504\\uD2B8 \\uB0B4\\uC6A9\\uC744 \\uC785\\uB825\\uD558\\uB824\\uBA74 \\uD074\\uB9AD\\uD558\\uC138\\uC694...\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 366,\n            columnNumber: 17\n          }, this)\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 364,\n          columnNumber: 13\n        }, this)\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 359,\n        columnNumber: 11\n      }, this) :\n      /*#__PURE__*/\n      // 편집 모드\n      _jsxDEV(\"div\", {\n        className: \"space-y-2\",\n        children: [/*#__PURE__*/_jsxDEV(\"textarea\", {\n          ref: textareaRef,\n          value: editText,\n          onChange: handleTextChange,\n          onKeyDown: handleKeyDown,\n          className: `w-full min-h-[120px] p-3 border rounded-lg text-sm resize-none focus:outline-none focus:ring-2 ${validationErrors.length > 0 ? \"border-red-300 focus:ring-red-500 bg-red-50\" : \"border-gray-300 focus:ring-blue-500 bg-white\"}`,\n          placeholder: `${categoryInfo.name} 프롬프트를 입력하세요...`\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 375,\n          columnNumber: 13\n        }, this), validationErrors.length > 0 && /*#__PURE__*/_jsxDEV(\"div\", {\n          className: \"space-y-1\",\n          children: validationErrors.map((error, index) => /*#__PURE__*/_jsxDEV(\"div\", {\n            className: \"flex items-center gap-2 text-xs text-red-600\",\n            children: [/*#__PURE__*/_jsxDEV(ExclamationTriangleIcon, {\n              className: \"h-3 w-3\"\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 393,\n              columnNumber: 21\n            }, this), /*#__PURE__*/_jsxDEV(\"span\", {\n              children: error\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 394,\n              columnNumber: 21\n            }, this)]\n          }, index, true, {\n            fileName: _jsxFileName,\n            lineNumber: 392,\n            columnNumber: 19\n          }, this))\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 390,\n          columnNumber: 15\n        }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n          className: \"flex items-center justify-between text-xs text-gray-500\",\n          children: [/*#__PURE__*/_jsxDEV(\"div\", {\n            className: \"flex items-center gap-4\",\n            children: [/*#__PURE__*/_jsxDEV(\"span\", {\n              children: [\"\\uAE38\\uC774: \", editText.length, \"/4000\"]\n            }, void 0, true, {\n              fileName: _jsxFileName,\n              lineNumber: 403,\n              columnNumber: 17\n            }, this), hasUnsavedChanges && /*#__PURE__*/_jsxDEV(\"span\", {\n              className: \"text-orange-600\",\n              children: \"\\u25CF \\uC800\\uC7A5\\uB418\\uC9C0 \\uC54A\\uC740 \\uBCC0\\uACBD\\uC0AC\\uD56D\"\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 405,\n              columnNumber: 19\n            }, this)]\n          }, void 0, true, {\n            fileName: _jsxFileName,\n            lineNumber: 402,\n            columnNumber: 15\n          }, this), /*#__PURE__*/_jsxDEV(\"span\", {\n            children: \"ESC: \\uCDE8\\uC18C | 2\\uCD08 \\uD6C4 \\uC790\\uB3D9 \\uC800\\uC7A5\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 408,\n            columnNumber: 15\n          }, this)]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 401,\n          columnNumber: 13\n        }, this)]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 374,\n        columnNumber: 11\n      }, this)\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 356,\n      columnNumber: 7\n    }, this), lastSaved && /*#__PURE__*/_jsxDEV(\"div\", {\n      className: \"mt-2 text-xs text-gray-500 text-right\",\n      children: [\"\\uB9C8\\uC9C0\\uB9C9 \\uC800\\uC7A5: \", lastSaved.toLocaleTimeString()]\n    }, void 0, true, {\n      fileName: _jsxFileName,\n      lineNumber: 416,\n      columnNumber: 9\n    }, this), isExecuted && /*#__PURE__*/_jsxDEV(\"div\", {\n      className: \"mt-3 flex items-center text-green-600 text-sm bg-green-50 p-2 rounded-lg border border-green-200\",\n      children: [/*#__PURE__*/_jsxDEV(CheckIcon, {\n        className: \"h-4 w-4 mr-2\"\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 424,\n        columnNumber: 11\n      }, this), /*#__PURE__*/_jsxDEV(\"span\", {\n        children: \"\\uC2E4\\uD589 \\uC644\\uB8CC\"\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 425,\n        columnNumber: 11\n      }, this)]\n    }, void 0, true, {\n      fileName: _jsxFileName,\n      lineNumber: 423,\n      columnNumber: 9\n    }, this)]\n  }, void 0, true, {\n    fileName: _jsxFileName,\n    lineNumber: 267,\n    columnNumber: 5\n  }, this);\n};\n_s2(InlineEditablePromptCard, \"gIS3ahWlIJ/SB1SkOvz7SE+LobY=\", false, function () {\n  return [useDebounce];\n});\n_c = InlineEditablePromptCard;\nexport default InlineEditablePromptCard;\nvar _c;\n$RefreshReg$(_c, \"InlineEditablePromptCard\");","map":{"version":3,"names":["React","useState","useRef","useEffect","PencilIcon","CheckIcon","XMarkIcon","EyeIcon","EyeSlashIcon","DocumentTextIcon","ClockIcon","ExclamationTriangleIcon","promptCardAPI","toast","jsxDEV","_jsxDEV","useDebounce","value","delay","_s","debouncedValue","setDebouncedValue","handler","setTimeout","clearTimeout","InlineEditablePromptCard","card","projectId","onUpdate","onToggle","isCurrentStep","isExecuted","isExecuting","hideDeleteButton","_s2","isEditing","setIsEditing","editText","setEditText","prompt_text","isSaving","setIsSaving","lastSaved","setLastSaved","hasUnsavedChanges","setHasUnsavedChanges","validationErrors","setValidationErrors","textareaRef","originalText","debouncedText","getCategoryInfo","categoryId","categories","instruction","name","color","description","knowledge","secondary","style_guide","validation","enhancement","categoryInfo","category","validatePrompt","text","errors","trim","push","length","includes","hasThought","toLowerCase","hasAction","current","handleAutoSave","startEditing","focus","style","height","scrollHeight","stopEditing","handleSave","error","savePrompt","isAutoSave","updatedCard","updatePromptCard","promptId","id","Date","success","duration","console","handleTextChange","e","target","handleToggle","enabled","handleKeyDown","key","getCardStyles","baseStyles","className","children","fileName","_jsxFileName","lineNumber","columnNumber","onClick","title","disabled","ref","onChange","onKeyDown","placeholder","map","index","toLocaleTimeString","_c","$RefreshReg$"],"sources":["/Users/yeong-gwang/Documents/work/서울경제신문/ai_제목달기/frontend/src/components/prompts/InlineEditablePromptCard.js"],"sourcesContent":["import React, { useState, useRef, useEffect } from \"react\";\nimport {\n  PencilIcon,\n  CheckIcon,\n  XMarkIcon,\n  EyeIcon,\n  EyeSlashIcon,\n  DocumentTextIcon,\n  ClockIcon,\n  ExclamationTriangleIcon,\n} from \"@heroicons/react/24/outline\";\nimport { promptCardAPI } from \"../../services/api\";\nimport { toast } from \"react-hot-toast\";\n\n// 디바운스 훅\nconst useDebounce = (value, delay) => {\n  const [debouncedValue, setDebouncedValue] = useState(value);\n\n  useEffect(() => {\n    const handler = setTimeout(() => {\n      setDebouncedValue(value);\n    }, delay);\n\n    return () => {\n      clearTimeout(handler);\n    };\n  }, [value, delay]);\n\n  return debouncedValue;\n};\n\nconst InlineEditablePromptCard = ({\n  card,\n  projectId,\n  onUpdate,\n  onToggle,\n  isCurrentStep = false,\n  isExecuted = false,\n  isExecuting = false,\n  hideDeleteButton = true,\n}) => {\n  const [isEditing, setIsEditing] = useState(false);\n  const [editText, setEditText] = useState(card.prompt_text || '');\n  const [isSaving, setIsSaving] = useState(false);\n  const [lastSaved, setLastSaved] = useState(null);\n  const [hasUnsavedChanges, setHasUnsavedChanges] = useState(false);\n  const [validationErrors, setValidationErrors] = useState([]);\n  \n  const textareaRef = useRef(null);\n  const originalText = useRef(card.prompt_text || '');\n  \n  // 디바운스된 텍스트 (자동 저장용)\n  const debouncedText = useDebounce(editText, 2000);\n\n  // 카테고리 정보\n  const getCategoryInfo = (categoryId) => {\n    const categories = {\n      instruction: { \n        name: \"역할 및 목표\", \n        color: \"bg-blue-100/80 text-blue-700 border-blue-200/80\",\n        description: \"AI의 역할, 정체성, 핵심 목표를 명확히 정의합니다\"\n      },\n      knowledge: {\n        name: \"지식 베이스\",\n        color: \"bg-green-100/80 text-green-700 border-green-200/80\",\n        description: \"작업 수행에 필요한 핵심 지식과 원칙을 제공합니다\"\n      },\n      secondary: { \n        name: \"CoT (사고 과정)\", \n        color: \"bg-purple-100/80 text-purple-700 border-purple-200/80\",\n        description: \"단계별 추론 과정을 통해 사고의 투명성을 확보합니다\"\n      },\n      style_guide: {\n        name: \"스타일 가이드\",\n        color: \"bg-yellow-100/80 text-yellow-700 border-yellow-200/80\",\n        description: \"일관된 스타일과 형식을 유지하기 위한 가이드라인\"\n      },\n      validation: { \n        name: \"ReAct (추론+행동)\", \n        color: \"bg-orange-100/80 text-orange-700 border-orange-200/80\",\n        description: \"추론과 행동을 결합하여 더 정확한 결과를 도출합니다\"\n      },\n      enhancement: { \n        name: \"품질 검증\", \n        color: \"bg-indigo-100/80 text-indigo-700 border-indigo-200/80\",\n        description: \"최종 결과물의 품질을 검증하고 개선합니다\"\n      },\n    };\n    return categories[categoryId] || {\n      name: categoryId,\n      color: \"bg-gray-100/80 text-gray-700 border-gray-200/80\",\n      description: \"사용자 정의 프롬프트\"\n    };\n  };\n\n  const categoryInfo = getCategoryInfo(card.category);\n\n  // 프롬프트 검증\n  const validatePrompt = (text) => {\n    const errors = [];\n    \n    if (!text.trim()) {\n      errors.push('프롬프트 내용이 비어있습니다');\n    } else if (text.length < 10) {\n      errors.push('프롬프트가 너무 짧습니다 (최소 10자)');\n    } else if (text.length > 4000) {\n      errors.push('프롬프트가 너무 깁니다 (최대 4000자)');\n    }\n    \n    // CoT 패턴 체크\n    if (card.category === 'secondary' && text.trim() && !text.includes('단계')) {\n      errors.push('CoT 프롬프트에는 단계별 지침이 포함되어야 합니다');\n    }\n    \n    // ReAct 패턴 체크\n    if (card.category === 'validation' && text.trim()) {\n      const hasThought = text.toLowerCase().includes('thought');\n      const hasAction = text.toLowerCase().includes('action');\n      if (!hasThought || !hasAction) {\n        errors.push('ReAct 프롬프트에는 Thought와 Action이 포함되어야 합니다');\n      }\n    }\n    \n    return errors;\n  };\n\n  // 텍스트 변경 시 검증\n  useEffect(() => {\n    if (isEditing) {\n      const errors = validatePrompt(editText);\n      setValidationErrors(errors);\n      setHasUnsavedChanges(editText !== originalText.current);\n    }\n  }, [editText, isEditing, card.category]);\n\n  // 자동 저장\n  useEffect(() => {\n    if (isEditing && debouncedText !== originalText.current && debouncedText.trim()) {\n      if (validationErrors.length === 0) {\n        handleAutoSave();\n      }\n    }\n  }, [debouncedText]);\n\n  // 편집 모드 진입\n  const startEditing = () => {\n    setIsEditing(true);\n    setEditText(card.prompt_text || '');\n    originalText.current = card.prompt_text || '';\n    setTimeout(() => {\n      if (textareaRef.current) {\n        textareaRef.current.focus();\n        textareaRef.current.style.height = 'auto';\n        textareaRef.current.style.height = textareaRef.current.scrollHeight + 'px';\n      }\n    }, 0);\n  };\n\n  // 편집 모드 종료\n  const stopEditing = () => {\n    setIsEditing(false);\n    setEditText(card.prompt_text || '');\n    setValidationErrors([]);\n    setHasUnsavedChanges(false);\n  };\n\n  // 수동 저장\n  const handleSave = async () => {\n    if (validationErrors.length > 0) {\n      toast.error('프롬프트에 오류가 있습니다. 수정 후 다시 시도해주세요.');\n      return;\n    }\n\n    await savePrompt();\n  };\n\n  // 자동 저장\n  const handleAutoSave = async () => {\n    await savePrompt(true);\n  };\n\n  // 프롬프트 저장\n  const savePrompt = async (isAutoSave = false) => {\n    if (isSaving) return;\n    \n    setIsSaving(true);\n    \n    try {\n      const updatedCard = {\n        ...card,\n        prompt_text: editText.trim()\n      };\n\n      await promptCardAPI.updatePromptCard(projectId, card.promptId || card.id, updatedCard);\n      \n      // 상태 업데이트\n      originalText.current = editText.trim();\n      setHasUnsavedChanges(false);\n      setLastSaved(new Date());\n      \n      if (onUpdate) {\n        onUpdate(updatedCard);\n      }\n      \n      if (!isAutoSave) {\n        toast.success('프롬프트가 저장되었습니다');\n        setIsEditing(false);\n      } else {\n        toast.success('자동 저장 완료', { duration: 1000 });\n      }\n      \n    } catch (error) {\n      console.error('프롬프트 저장 실패:', error);\n      toast.error('저장에 실패했습니다. 다시 시도해주세요.');\n    } finally {\n      setIsSaving(false);\n    }\n  };\n\n  // 텍스트 영역 높이 자동 조절\n  const handleTextChange = (e) => {\n    setEditText(e.target.value);\n    \n    // 높이 자동 조절\n    if (textareaRef.current) {\n      textareaRef.current.style.height = 'auto';\n      textareaRef.current.style.height = textareaRef.current.scrollHeight + 'px';\n    }\n  };\n\n  // 토글 처리\n  const handleToggle = async () => {\n    try {\n      await onToggle(card.promptId || card.id, !card.enabled);\n    } catch (error) {\n      console.error(\"카드 토글 실패:\", error);\n    }\n  };\n\n  // ESC 키로 편집 취소\n  const handleKeyDown = (e) => {\n    if (e.key === 'Escape') {\n      stopEditing();\n    }\n  };\n\n  // 카드 스타일\n  const getCardStyles = () => {\n    let baseStyles = \"relative bg-white border-2 rounded-lg p-4 transition-all duration-200 group\";\n\n    if (isCurrentStep) {\n      baseStyles += \" ring-2 ring-blue-400 border-blue-300 bg-blue-50\";\n    } else if (isExecuted) {\n      baseStyles += \" ring-2 ring-green-400 border-green-300 bg-green-50\";\n    } else if (isEditing) {\n      baseStyles += \" ring-2 ring-purple-400 border-purple-300 bg-purple-50\";\n    } else if (card.enabled) {\n      baseStyles += \" border-gray-200 hover:border-gray-300 hover:shadow-md\";\n    } else {\n      baseStyles += \" border-gray-200 bg-gray-50 opacity-60\";\n    }\n\n    return baseStyles;\n  };\n\n  return (\n    <div className={getCardStyles()}>\n      {/* 실행 상태 표시 */}\n      {isExecuting && (\n        <div className=\"absolute -top-2 -right-2 z-10\">\n          <div className=\"flex items-center justify-center w-6 h-6 bg-blue-500 text-white rounded-full shadow-lg\">\n            <div className=\"animate-spin rounded-full h-3 w-3 border border-t-transparent border-white\"></div>\n          </div>\n        </div>\n      )}\n\n      {/* 저장 상태 표시 */}\n      {isSaving && (\n        <div className=\"absolute top-2 right-2 z-10\">\n          <div className=\"flex items-center gap-1 text-xs text-blue-600 bg-white px-2 py-1 rounded shadow-md\">\n            <ClockIcon className=\"h-3 w-3 animate-spin\" />\n            <span>저장 중...</span>\n          </div>\n        </div>\n      )}\n\n      {/* 카드 헤더 */}\n      <div className=\"flex items-start justify-between mb-3\">\n        <div className=\"flex items-center gap-2 flex-1\">\n          <div className={`inline-flex items-center px-3 py-1 rounded-full text-sm font-medium border ${categoryInfo.color}`}>\n            <DocumentTextIcon className=\"h-4 w-4 mr-1\" />\n            <span>{categoryInfo.name}</span>\n          </div>\n        </div>\n\n        {/* 액션 버튼들 */}\n        <div className=\"flex items-center gap-1\">\n          {/* 활성화/비활성화 토글 */}\n          <button\n            onClick={handleToggle}\n            className={`p-2 rounded-lg transition-colors ${\n              card.enabled\n                ? \"text-green-600 hover:bg-green-50\"\n                : \"text-gray-400 hover:bg-gray-100\"\n            }`}\n            title={card.enabled ? \"비활성화\" : \"활성화\"}\n          >\n            {card.enabled ? (\n              <EyeIcon className=\"h-4 w-4\" />\n            ) : (\n              <EyeSlashIcon className=\"h-4 w-4\" />\n            )}\n          </button>\n\n          {/* 편집/저장 버튼 */}\n          {!isEditing ? (\n            <button\n              onClick={startEditing}\n              className=\"p-2 text-gray-600 hover:bg-blue-50 hover:text-blue-600 rounded-lg transition-colors\"\n              title=\"편집\"\n            >\n              <PencilIcon className=\"h-4 w-4\" />\n            </button>\n          ) : (\n            <div className=\"flex items-center gap-1\">\n              <button\n                onClick={handleSave}\n                disabled={validationErrors.length > 0 || isSaving}\n                className={`p-2 rounded-lg transition-colors ${\n                  validationErrors.length > 0 || isSaving\n                    ? \"text-gray-400 cursor-not-allowed\"\n                    : \"text-green-600 hover:bg-green-50\"\n                }`}\n                title=\"저장\"\n              >\n                <CheckIcon className=\"h-4 w-4\" />\n              </button>\n              <button\n                onClick={stopEditing}\n                className=\"p-2 text-red-600 hover:bg-red-50 rounded-lg transition-colors\"\n                title=\"취소\"\n              >\n                <XMarkIcon className=\"h-4 w-4\" />\n              </button>\n            </div>\n          )}\n        </div>\n      </div>\n\n      {/* 프롬프트 설명 */}\n      <div className=\"text-sm text-gray-600 mb-3 leading-relaxed\">\n        {categoryInfo.description}\n      </div>\n\n      {/* 프롬프트 내용 */}\n      <div className=\"space-y-2\">\n        {!isEditing ? (\n          // 읽기 모드\n          <div \n            className=\"min-h-[100px] p-3 bg-gray-50 rounded-lg border cursor-pointer hover:bg-gray-100 transition-colors\"\n            onClick={startEditing}\n            title=\"클릭하여 편집\"\n          >\n            <div className=\"text-sm text-gray-800 whitespace-pre-wrap leading-relaxed\">\n              {card.prompt_text || (\n                <span className=\"text-gray-400 italic\">\n                  프롬프트 내용을 입력하려면 클릭하세요...\n                </span>\n              )}\n            </div>\n          </div>\n        ) : (\n          // 편집 모드\n          <div className=\"space-y-2\">\n            <textarea\n              ref={textareaRef}\n              value={editText}\n              onChange={handleTextChange}\n              onKeyDown={handleKeyDown}\n              className={`w-full min-h-[120px] p-3 border rounded-lg text-sm resize-none focus:outline-none focus:ring-2 ${\n                validationErrors.length > 0\n                  ? \"border-red-300 focus:ring-red-500 bg-red-50\"\n                  : \"border-gray-300 focus:ring-blue-500 bg-white\"\n              }`}\n              placeholder={`${categoryInfo.name} 프롬프트를 입력하세요...`}\n            />\n            \n            {/* 검증 오류 표시 */}\n            {validationErrors.length > 0 && (\n              <div className=\"space-y-1\">\n                {validationErrors.map((error, index) => (\n                  <div key={index} className=\"flex items-center gap-2 text-xs text-red-600\">\n                    <ExclamationTriangleIcon className=\"h-3 w-3\" />\n                    <span>{error}</span>\n                  </div>\n                ))}\n              </div>\n            )}\n            \n            {/* 편집 도움말 */}\n            <div className=\"flex items-center justify-between text-xs text-gray-500\">\n              <div className=\"flex items-center gap-4\">\n                <span>길이: {editText.length}/4000</span>\n                {hasUnsavedChanges && (\n                  <span className=\"text-orange-600\">● 저장되지 않은 변경사항</span>\n                )}\n              </div>\n              <span>ESC: 취소 | 2초 후 자동 저장</span>\n            </div>\n          </div>\n        )}\n      </div>\n\n      {/* 저장 시간 표시 */}\n      {lastSaved && (\n        <div className=\"mt-2 text-xs text-gray-500 text-right\">\n          마지막 저장: {lastSaved.toLocaleTimeString()}\n        </div>\n      )}\n\n      {/* 실행 완료 표시 */}\n      {isExecuted && (\n        <div className=\"mt-3 flex items-center text-green-600 text-sm bg-green-50 p-2 rounded-lg border border-green-200\">\n          <CheckIcon className=\"h-4 w-4 mr-2\" />\n          <span>실행 완료</span>\n        </div>\n      )}\n    </div>\n  );\n};\n\nexport default InlineEditablePromptCard;"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}