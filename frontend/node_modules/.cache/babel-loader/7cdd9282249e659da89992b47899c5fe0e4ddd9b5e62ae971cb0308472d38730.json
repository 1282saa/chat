{"ast":null,"code":"import{useState,useCallback}from\"react\";import{toast}from\"react-hot-toast\";import{generateAPI}from\"../services/api\";/**\n * Ï†úÎ™© ÏÉùÏÑ± Ïã§Ìñâ Î∞è Í≤∞Í≥º Ìè¥ÎßÅÏùÑ ÏúÑÌïú Ïª§Ïä§ÌÖÄ ÌõÖ\n * @param {string} projectId - ÌîÑÎ°úÏ†ùÌä∏ ID\n * @returns {Object} - Ï†úÎ™© ÏÉùÏÑ± Í¥ÄÎ†® ÏÉÅÌÉúÏôÄ Ìï®ÏàòÎì§\n */export const useOrchestration=projectId=>{const[isExecuting,setIsExecuting]=useState(false);const[currentExecution,setCurrentExecution]=useState(null);const[executionStatus,setExecutionStatus]=useState(null);/**\n   * Ï†úÎ™© ÏÉùÏÑ± Ïã§Ìñâ\n   * @param {string} content - ÏûÖÎ†• ÎÇ¥Ïö© (Í∏∞ÏÇ¨ ÌÖçÏä§Ìä∏)\n   * @param {Object} config - ÏÉùÏÑ± ÏÑ§Ï†ï\n   * @returns {Promise<Object>} - ÏÉùÏÑ± Í≤∞Í≥º\n   */const executeOrchestration=useCallback(async function(content){let config=arguments.length>1&&arguments[1]!==undefined?arguments[1]:{};if(!content.trim()){toast.error(\"Í∏∞ÏÇ¨ ÎÇ¥Ïö©ÏùÑ ÏûÖÎ†•Ìï¥Ï£ºÏÑ∏Ïöî\");return null;}try{setIsExecuting(true);setExecutionStatus(\"STARTING\");const userRequest=config.userRequest||\"\";console.log(\"üöÄ Ï†úÎ™© ÏÉùÏÑ± ÏöîÏ≤≠ ÏãúÏûë:\",{projectId,contentLength:content.length,userRequest,timestamp:new Date().toISOString()});const response=await generateAPI.generateTitle(projectId,content,userRequest);console.log(\"‚úÖ Ï†úÎ™© ÏÉùÏÑ± ÏôÑÎ£å:\",{mode:response.mode,message:response.message,timestamp:new Date().toISOString()});setIsExecuting(false);setExecutionStatus(\"COMPLETED\");return response;}catch(error){var _error$response,_error$response2,_error$response3,_error$response3$data;console.error(\"‚ùå Ï†úÎ™© ÏÉùÏÑ± Ïã§Ìå®:\",{error:error.message,code:error.code,status:(_error$response=error.response)===null||_error$response===void 0?void 0:_error$response.status,timestamp:new Date().toISOString()});setIsExecuting(false);setExecutionStatus(\"FAILED\");// ÌîÑÎ°¨ÌîÑÌä∏ Ïπ¥Îìú Í¥ÄÎ†® ÏóêÎü¨ Ï≤òÎ¶¨\nif(((_error$response2=error.response)===null||_error$response2===void 0?void 0:_error$response2.status)===400&&(_error$response3=error.response)!==null&&_error$response3!==void 0&&(_error$response3$data=_error$response3.data)!==null&&_error$response3$data!==void 0&&_error$response3$data.setup_required){toast.error(\"ÌîÑÎ°¨ÌîÑÌä∏ Ïπ¥ÎìúÎ•º Î®ºÏ†Ä ÏÑ§Ï†ïÌï¥Ï£ºÏÑ∏Ïöî!\");}else if(error.code===\"ECONNABORTED\"){toast.error(\"ÏöîÏ≤≠ ÏãúÍ∞ÑÏù¥ Ï¥àÍ≥ºÎêòÏóàÏäµÎãàÎã§. Îã§Ïãú ÏãúÎèÑÌï¥Ï£ºÏÑ∏Ïöî.\");}else{toast.error(\"Ï≤òÎ¶¨ Ï§ë Ïò§Î•òÍ∞Ä Î∞úÏÉùÌñàÏäµÎãàÎã§.\");}throw error;}},[projectId]);/**\n   * Ïã§Ìñâ ÏÉÅÌÉú Ï°∞Ìöå (Step Functions ÏÇ¨Ïö© Ïãú)\n   * @param {string} executionArn - Ïã§Ìñâ ARN\n   * @param {Function} onComplete - ÏôÑÎ£å Ïãú ÏΩúÎ∞±\n   * @param {Function} onError - ÏóêÎü¨ Ïãú ÏΩúÎ∞±\n   */const pollOrchestrationResult=useCallback(async(executionArn,onComplete,onError)=>{const poll=async()=>{try{const result=await generateAPI.getExecutionStatus(executionArn);setExecutionStatus(result.status);if(result.status===\"SUCCEEDED\"){setIsExecuting(false);setExecutionStatus(\"COMPLETED\");if(onComplete){onComplete(result);}}else if(result.status===\"FAILED\"){setIsExecuting(false);setExecutionStatus(\"FAILED\");if(onError){onError(new Error(\"Ï≤òÎ¶¨ Ïã§Ìå®\"));}}else if(result.status===\"RUNNING\"){// 3Ï¥à ÌõÑ Îã§Ïãú Ìè¥ÎßÅ\nsetTimeout(poll,3000);}}catch(error){console.error(\"Ïã§Ìñâ ÏÉÅÌÉú Ï°∞Ìöå Ïã§Ìå®:\",error);setIsExecuting(false);setExecutionStatus(\"FAILED\");if(onError){onError(error);}}};poll();},[projectId]);/**\n   * Ïò§ÏºÄÏä§Ìä∏Î†àÏù¥ÏÖò ÏÉÅÌÉú Ï¥àÍ∏∞Ìôî\n   */const resetOrchestration=useCallback(()=>{setIsExecuting(false);setCurrentExecution(null);setExecutionStatus(null);},[]);return{isExecuting,currentExecution,executionStatus,executeOrchestration,pollOrchestrationResult,resetOrchestration};};","map":{"version":3,"names":["useState","useCallback","toast","generateAPI","useOrchestration","projectId","isExecuting","setIsExecuting","currentExecution","setCurrentExecution","executionStatus","setExecutionStatus","executeOrchestration","content","config","arguments","length","undefined","trim","error","userRequest","console","log","contentLength","timestamp","Date","toISOString","response","generateTitle","mode","message","_error$response","_error$response2","_error$response3","_error$response3$data","code","status","data","setup_required","pollOrchestrationResult","executionArn","onComplete","onError","poll","result","getExecutionStatus","Error","setTimeout","resetOrchestration"],"sources":["/Users/yeong-gwang/Documents/work/·Ñâ·Ö•·Ñã·ÖÆ·ÜØ·ÑÄ·Öß·Üº·Ñå·Ö¶·Ñâ·Öµ·Ü´·ÑÜ·ÖÆ·Ü´/ai_·Ñå·Ö¶·ÑÜ·Ö©·Ü®·ÑÉ·Ö°·ÜØ·ÑÄ·Öµ/frontend/src/hooks/useOrchestration.js"],"sourcesContent":["import { useState, useCallback } from \"react\";\nimport { toast } from \"react-hot-toast\";\nimport { generateAPI } from \"../services/api\";\n\n/**\n * Ï†úÎ™© ÏÉùÏÑ± Ïã§Ìñâ Î∞è Í≤∞Í≥º Ìè¥ÎßÅÏùÑ ÏúÑÌïú Ïª§Ïä§ÌÖÄ ÌõÖ\n * @param {string} projectId - ÌîÑÎ°úÏ†ùÌä∏ ID\n * @returns {Object} - Ï†úÎ™© ÏÉùÏÑ± Í¥ÄÎ†® ÏÉÅÌÉúÏôÄ Ìï®ÏàòÎì§\n */\nexport const useOrchestration = (projectId) => {\n  const [isExecuting, setIsExecuting] = useState(false);\n  const [currentExecution, setCurrentExecution] = useState(null);\n  const [executionStatus, setExecutionStatus] = useState(null);\n\n  /**\n   * Ï†úÎ™© ÏÉùÏÑ± Ïã§Ìñâ\n   * @param {string} content - ÏûÖÎ†• ÎÇ¥Ïö© (Í∏∞ÏÇ¨ ÌÖçÏä§Ìä∏)\n   * @param {Object} config - ÏÉùÏÑ± ÏÑ§Ï†ï\n   * @returns {Promise<Object>} - ÏÉùÏÑ± Í≤∞Í≥º\n   */\n  const executeOrchestration = useCallback(\n    async (content, config = {}) => {\n      if (!content.trim()) {\n        toast.error(\"Í∏∞ÏÇ¨ ÎÇ¥Ïö©ÏùÑ ÏûÖÎ†•Ìï¥Ï£ºÏÑ∏Ïöî\");\n        return null;\n      }\n\n      try {\n        setIsExecuting(true);\n        setExecutionStatus(\"STARTING\");\n\n        const userRequest = config.userRequest || \"\";\n\n        console.log(\"üöÄ Ï†úÎ™© ÏÉùÏÑ± ÏöîÏ≤≠ ÏãúÏûë:\", {\n          projectId,\n          contentLength: content.length,\n          userRequest,\n          timestamp: new Date().toISOString(),\n        });\n\n        const response = await generateAPI.generateTitle(\n          projectId,\n          content,\n          userRequest\n        );\n\n        console.log(\"‚úÖ Ï†úÎ™© ÏÉùÏÑ± ÏôÑÎ£å:\", {\n          mode: response.mode,\n          message: response.message,\n          timestamp: new Date().toISOString(),\n        });\n\n        setIsExecuting(false);\n        setExecutionStatus(\"COMPLETED\");\n\n        return response;\n      } catch (error) {\n        console.error(\"‚ùå Ï†úÎ™© ÏÉùÏÑ± Ïã§Ìå®:\", {\n          error: error.message,\n          code: error.code,\n          status: error.response?.status,\n          timestamp: new Date().toISOString(),\n        });\n        setIsExecuting(false);\n        setExecutionStatus(\"FAILED\");\n\n        // ÌîÑÎ°¨ÌîÑÌä∏ Ïπ¥Îìú Í¥ÄÎ†® ÏóêÎü¨ Ï≤òÎ¶¨\n        if (\n          error.response?.status === 400 &&\n          error.response?.data?.setup_required\n        ) {\n          toast.error(\"ÌîÑÎ°¨ÌîÑÌä∏ Ïπ¥ÎìúÎ•º Î®ºÏ†Ä ÏÑ§Ï†ïÌï¥Ï£ºÏÑ∏Ïöî!\");\n        } else if (error.code === \"ECONNABORTED\") {\n          toast.error(\"ÏöîÏ≤≠ ÏãúÍ∞ÑÏù¥ Ï¥àÍ≥ºÎêòÏóàÏäµÎãàÎã§. Îã§Ïãú ÏãúÎèÑÌï¥Ï£ºÏÑ∏Ïöî.\");\n        } else {\n          toast.error(\"Ï≤òÎ¶¨ Ï§ë Ïò§Î•òÍ∞Ä Î∞úÏÉùÌñàÏäµÎãàÎã§.\");\n        }\n\n        throw error;\n      }\n    },\n    [projectId]\n  );\n\n  /**\n   * Ïã§Ìñâ ÏÉÅÌÉú Ï°∞Ìöå (Step Functions ÏÇ¨Ïö© Ïãú)\n   * @param {string} executionArn - Ïã§Ìñâ ARN\n   * @param {Function} onComplete - ÏôÑÎ£å Ïãú ÏΩúÎ∞±\n   * @param {Function} onError - ÏóêÎü¨ Ïãú ÏΩúÎ∞±\n   */\n  const pollOrchestrationResult = useCallback(\n    async (executionArn, onComplete, onError) => {\n      const poll = async () => {\n        try {\n          const result = await generateAPI.getExecutionStatus(executionArn);\n\n          setExecutionStatus(result.status);\n\n          if (result.status === \"SUCCEEDED\") {\n            setIsExecuting(false);\n            setExecutionStatus(\"COMPLETED\");\n\n            if (onComplete) {\n              onComplete(result);\n            }\n          } else if (result.status === \"FAILED\") {\n            setIsExecuting(false);\n            setExecutionStatus(\"FAILED\");\n\n            if (onError) {\n              onError(new Error(\"Ï≤òÎ¶¨ Ïã§Ìå®\"));\n            }\n          } else if (result.status === \"RUNNING\") {\n            // 3Ï¥à ÌõÑ Îã§Ïãú Ìè¥ÎßÅ\n            setTimeout(poll, 3000);\n          }\n        } catch (error) {\n          console.error(\"Ïã§Ìñâ ÏÉÅÌÉú Ï°∞Ìöå Ïã§Ìå®:\", error);\n          setIsExecuting(false);\n          setExecutionStatus(\"FAILED\");\n\n          if (onError) {\n            onError(error);\n          }\n        }\n      };\n\n      poll();\n    },\n    [projectId]\n  );\n\n  /**\n   * Ïò§ÏºÄÏä§Ìä∏Î†àÏù¥ÏÖò ÏÉÅÌÉú Ï¥àÍ∏∞Ìôî\n   */\n  const resetOrchestration = useCallback(() => {\n    setIsExecuting(false);\n    setCurrentExecution(null);\n    setExecutionStatus(null);\n  }, []);\n\n  return {\n    isExecuting,\n    currentExecution,\n    executionStatus,\n    executeOrchestration,\n    pollOrchestrationResult,\n    resetOrchestration,\n  };\n};\n"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}