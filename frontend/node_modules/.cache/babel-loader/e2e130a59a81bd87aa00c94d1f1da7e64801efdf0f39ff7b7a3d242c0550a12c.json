{"ast":null,"code":"import{useState,useCallback}from\"react\";import{toast}from\"react-hot-toast\";import{orchestrationAPI}from\"../services/api\";/**\n * 오케스트레이션 실행 및 결과 폴링을 위한 커스텀 훅\n * @param {string} projectId - 프로젝트 ID\n * @returns {Object} - 오케스트레이션 관련 상태와 함수들\n */export const useOrchestration=projectId=>{const[isExecuting,setIsExecuting]=useState(false);const[currentExecution,setCurrentExecution]=useState(null);const[executionStatus,setExecutionStatus]=useState(null);/**\n   * 오케스트레이션 실행\n   * @param {string} content - 입력 내용\n   * @param {Object} config - 오케스트레이션 설정\n   * @returns {Promise<string>} - 실행 ID\n   */const executeOrchestration=useCallback(async function(content){let config=arguments.length>1&&arguments[1]!==undefined?arguments[1]:{};if(!content.trim()){toast.error(\"내용을 입력해주세요\");return null;}try{setIsExecuting(true);setExecutionStatus(\"STARTING\");const defaultConfig={useAllSteps:true,enabledSteps:[],maxRetries:3,temperature:0.7,...config};const response=await orchestrationAPI.executeOrchestration(projectId,content,defaultConfig);setCurrentExecution(response.executionId);setExecutionStatus(\"RUNNING\");return response.executionId;}catch(error){console.error(\"오케스트레이션 실행 실패:\",error);setIsExecuting(false);setExecutionStatus(\"FAILED\");throw error;}},[projectId]);/**\n   * 오케스트레이션 결과 폴링\n   * @param {string} executionId - 실행 ID\n   * @param {Function} onComplete - 완료 시 콜백\n   * @param {Function} onError - 에러 시 콜백\n   */const pollOrchestrationResult=useCallback(async(executionId,onComplete,onError)=>{const poll=async()=>{try{const status=await orchestrationAPI.getOrchestrationStatus(projectId,executionId);setExecutionStatus(status.status);if(status.status===\"COMPLETED\"){const result=await orchestrationAPI.getOrchestrationResult(projectId,executionId);setIsExecuting(false);setExecutionStatus(\"COMPLETED\");if(onComplete){onComplete(result);}}else if(status.status===\"FAILED\"){setIsExecuting(false);setExecutionStatus(\"FAILED\");if(onError){onError(new Error(\"오케스트레이션 실패\"));}}else if(status.status===\"RUNNING\"){// 3초 후 다시 폴링\nsetTimeout(poll,3000);}}catch(error){console.error(\"결과 조회 실패:\",error);setIsExecuting(false);setExecutionStatus(\"FAILED\");if(onError){onError(error);}}};poll();},[projectId]);/**\n   * 오케스트레이션 상태 초기화\n   */const resetOrchestration=useCallback(()=>{setIsExecuting(false);setCurrentExecution(null);setExecutionStatus(null);},[]);return{isExecuting,currentExecution,executionStatus,executeOrchestration,pollOrchestrationResult,resetOrchestration};};","map":{"version":3,"names":["useState","useCallback","toast","orchestrationAPI","useOrchestration","projectId","isExecuting","setIsExecuting","currentExecution","setCurrentExecution","executionStatus","setExecutionStatus","executeOrchestration","content","config","arguments","length","undefined","trim","error","defaultConfig","useAllSteps","enabledSteps","maxRetries","temperature","response","executionId","console","pollOrchestrationResult","onComplete","onError","poll","status","getOrchestrationStatus","result","getOrchestrationResult","Error","setTimeout","resetOrchestration"],"sources":["/Users/yeong-gwang/Documents/work/서울경제신문/ai_제목달기/frontend/src/hooks/useOrchestration.js"],"sourcesContent":["import { useState, useCallback } from \"react\";\nimport { toast } from \"react-hot-toast\";\nimport { orchestrationAPI } from \"../services/api\";\n\n/**\n * 오케스트레이션 실행 및 결과 폴링을 위한 커스텀 훅\n * @param {string} projectId - 프로젝트 ID\n * @returns {Object} - 오케스트레이션 관련 상태와 함수들\n */\nexport const useOrchestration = (projectId) => {\n  const [isExecuting, setIsExecuting] = useState(false);\n  const [currentExecution, setCurrentExecution] = useState(null);\n  const [executionStatus, setExecutionStatus] = useState(null);\n\n  /**\n   * 오케스트레이션 실행\n   * @param {string} content - 입력 내용\n   * @param {Object} config - 오케스트레이션 설정\n   * @returns {Promise<string>} - 실행 ID\n   */\n  const executeOrchestration = useCallback(\n    async (content, config = {}) => {\n      if (!content.trim()) {\n        toast.error(\"내용을 입력해주세요\");\n        return null;\n      }\n\n      try {\n        setIsExecuting(true);\n        setExecutionStatus(\"STARTING\");\n\n        const defaultConfig = {\n          useAllSteps: true,\n          enabledSteps: [],\n          maxRetries: 3,\n          temperature: 0.7,\n          ...config,\n        };\n\n        const response = await orchestrationAPI.executeOrchestration(\n          projectId,\n          content,\n          defaultConfig\n        );\n\n        setCurrentExecution(response.executionId);\n        setExecutionStatus(\"RUNNING\");\n\n        return response.executionId;\n      } catch (error) {\n        console.error(\"오케스트레이션 실행 실패:\", error);\n        setIsExecuting(false);\n        setExecutionStatus(\"FAILED\");\n        throw error;\n      }\n    },\n    [projectId]\n  );\n\n  /**\n   * 오케스트레이션 결과 폴링\n   * @param {string} executionId - 실행 ID\n   * @param {Function} onComplete - 완료 시 콜백\n   * @param {Function} onError - 에러 시 콜백\n   */\n  const pollOrchestrationResult = useCallback(\n    async (executionId, onComplete, onError) => {\n      const poll = async () => {\n        try {\n          const status = await orchestrationAPI.getOrchestrationStatus(\n            projectId,\n            executionId\n          );\n\n          setExecutionStatus(status.status);\n\n          if (status.status === \"COMPLETED\") {\n            const result = await orchestrationAPI.getOrchestrationResult(\n              projectId,\n              executionId\n            );\n\n            setIsExecuting(false);\n            setExecutionStatus(\"COMPLETED\");\n\n            if (onComplete) {\n              onComplete(result);\n            }\n          } else if (status.status === \"FAILED\") {\n            setIsExecuting(false);\n            setExecutionStatus(\"FAILED\");\n\n            if (onError) {\n              onError(new Error(\"오케스트레이션 실패\"));\n            }\n          } else if (status.status === \"RUNNING\") {\n            // 3초 후 다시 폴링\n            setTimeout(poll, 3000);\n          }\n        } catch (error) {\n          console.error(\"결과 조회 실패:\", error);\n          setIsExecuting(false);\n          setExecutionStatus(\"FAILED\");\n\n          if (onError) {\n            onError(error);\n          }\n        }\n      };\n\n      poll();\n    },\n    [projectId]\n  );\n\n  /**\n   * 오케스트레이션 상태 초기화\n   */\n  const resetOrchestration = useCallback(() => {\n    setIsExecuting(false);\n    setCurrentExecution(null);\n    setExecutionStatus(null);\n  }, []);\n\n  return {\n    isExecuting,\n    currentExecution,\n    executionStatus,\n    executeOrchestration,\n    pollOrchestrationResult,\n    resetOrchestration,\n  };\n};\n"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}